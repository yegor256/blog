<!DOCTYPE html>
<html amp lang="en">
  <head>

    <meta charset="utf-8">
    <title>How to Use Nutch From Java, Not From the Command Line</title>
    <link rel="canonical" href="https://www.yegor256.com/2019/04/17/nutch-from-java.html">
    <link rel="icon" type="image/png" href="/favicon.ico">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "mainEntityOfPage":{
          "@type": "WebPage",
          "@id": "https://www.yegor256.com/2019/04/17/nutch-from-java.html"
        },
        "headline": "How to Use Nutch From Java, Not From the Command Line",
        "image": {
          "@type": "ImageObject",
          "url": "https://www.yegor256.com/images/face-1024x1024.jpg",
          "height": 1400,
          "width": 1400
        },
        "datePublished": "2019-04-17",
        "dateModified": "2019-04-17",
        "author": {
          "@type": "Person",
          "name": "Yegor Bugayenko"
        },
        "publisher": {
          "@type": "Organization",
          "name": "yegor256.com",
          "logo": {
            "@type": "ImageObject",
            "url": "https://www.yegor256.com/images/face-512x512.jpg",
            "width": 512,
            "height": 512
          }
        },
        "description": "Nutch is an open source framework for crawling
web content, however it is designed primarily to
be used from the command line; here I explain how
to use it from inside Java.
",
        "keywords": ["nutch", "nutch in java", "java nutch", "nutch without command line", "nutch apache"]
      }
    </script>
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style>
<noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500">
    <style amp-custom="amp-custom">
      @font-face {
        font-family: 'Cambria';
        src: url('https://www.yegor256.com/fonts/cambria/2EAA54_2_0.ttf');
      }
      body { font-family: 'Cambria', 'Times New Roman', serif; padding: .5em; font-size: 1.2em; }
      article { width: 600px; max-width: 100%; margin-left: auto; margin-right: auto; }
      pre, code { font-family: 'Source Code Pro', 'Courier New', monospace; font-size: .8em; }
      code { padding: 0 .3em; background-color: lightgray; }
      a, a:hover, a:visited { color: inherit; }
      .intro { color: red; font-size: .75em; }
      .photo { border-radius: 50%; }
      pre { overflow-x:scroll; }
    </style>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
  </head>
  <body>
    <article>
      <p class="intro">
        This is a mobile version, full one is
        <a href="https://www.yegor256.com/2019/04/17/nutch-from-java.html">here</a>.
      </p>
      <p>
        <amp-img src="/images/face-256x256.jpg" width="80" height="80" alt="Yegor Bugayenko" class="photo"></amp-img>
      </p>
      <p>Yegor Bugayenko<br>17 April 2019</p>
      <h1>How to Use Nutch From Java, Not From the Command Line</h1>
      

<p><a href="https://nutch.apache.org/">Apache Nutch</a>
is an open source framework written in Java. Its purpose
is to help us crawl a set of websites (or the entire Internet), fetch
the content, and prepare it for indexing by, say, Solr. A pretty useful
framework if you ask me, however it is designed to be used <del>only</del>
mostly from the command line. You download the archive, unzip it, and run
the binary file. It crawls and you get the data. However, I’ve got a project
where this crawling had to be embedded into my own Java app. I realized
that there is a complete absence of any documentation for that. Hence
this blog post. It explains how you can use Nutch from Java, not from
the command line.</p>



<p>I’ll be talking about Nutch 1.15. There is a later version 2+, but I didn’t
manage to make it work. If you know how, leave your comment below.</p>

<p>I’d recommend you read <a href="https://examples.javacodegeeks.com/enterprise-java/apache-hadoop/apache-hadoop-nutch-tutorial/">this tutorial</a>
first, to understand how Nutch works from the command line. Well,
it helped me anyway.</p>

<p>Now, let’s see how we can use Nutch without the command line.
First, you need these dependencies in your <code class="language-plaintext highlighter-rouge">pom.xml</code>
(Nutch uses <a href="https://hadoop.apache.org/">Apache Hadoop</a>, that’s why we need the
second dependency):</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;project&gt;</span>
  <span class="nt">&lt;dependencies&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>org.apache.nutch<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>nutch<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>1.15<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>org.apache.hadoop<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>hadoop-common<span class="nt">&lt;/artifactId&gt;</span>
      <span class="nt">&lt;version&gt;</span>2.7.2<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    [...]
  <span class="nt">&lt;/dependencies&gt;</span>
  [...]
<span class="nt">&lt;/project&gt;</span>
</code></pre></div></div>

<p>Next, this is your Java code, which does all the work:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Files</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Paths</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Collection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Collections</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Comparator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.stream.Collectors</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.commons.io.FileUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.hadoop.conf.Configuration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.nutch.crawl.CrawlDb</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.nutch.crawl.Generator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.nutch.crawl.Injector</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.nutch.fetcher.Fetcher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.nutch.parse.ParseSegment</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.nutch.tools.FileDumper</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">...</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="c1">// Create a default configuration object, which will read</span>
    <span class="c1">// the content of nutch-default.xml file from the classpath,</span>
    <span class="c1">// parse it and take its entire content as the default</span>
    <span class="c1">// configuration. Funny, but this interface is from Hadoop:</span>
    <span class="nc">Configuration</span> <span class="n">conf</span> <span class="o">=</span> <span class="nc">NutchConfiguration</span><span class="o">.</span><span class="na">create</span><span class="o">();</span>
    <span class="c1">// Now it's possible to reset some configuration parameters</span>
    <span class="c1">// by using this set() method. This one is mandatory, if you</span>
    <span class="c1">// don't set it the crawling won't work. The value is used</span>
    <span class="c1">// as User-Agent HTTP header.</span>
    <span class="n">conf</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"http.agent.name"</span><span class="o">,</span> <span class="s">"me, myself, and I"</span><span class="o">);</span>
    <span class="c1">// This one is also mandatory and we will discuss its</span>
    <span class="c1">// value below. You need to point Nutch to the directory</span>
    <span class="c1">// with compiled plugins and this collection is NOT in</span>
    <span class="c1">// its default JAR package, unfortunately.</span>
    <span class="n">conf</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"plugin.folders"</span><span class="o">,</span> <span class="nc">System</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"nutch.plugins.dir"</span><span class="o">));</span>
    <span class="c1">// First, we need to have a directory where everything will</span>
    <span class="c1">// happen. I assume you are familiar with Maven, so let's use</span>
    <span class="c1">// its default temporary directory "target":</span>
    <span class="nc">Path</span> <span class="n">home</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Path</span><span class="o">(</span><span class="s">"target"</span><span class="o">);</span>
    <span class="c1">// Next, we have to create a file with a list of URLs Nutch will</span>
    <span class="c1">// start crawling from:</span>
    <span class="nc">String</span><span class="o">[]</span> <span class="n">urls</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"https://www.zerocracy.com"</span> <span class="o">};</span>
    <span class="kd">final</span> <span class="nc">Path</span> <span class="n">targets</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Path</span><span class="o">(</span><span class="n">home</span><span class="o">,</span> <span class="s">"urls"</span><span class="o">);</span>
    <span class="nc">Files</span><span class="o">.</span><span class="na">createDirectory</span><span class="o">(</span><span class="nc">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">targets</span><span class="o">.</span><span class="na">toString</span><span class="o">()));</span>
    <span class="nc">Files</span><span class="o">.</span><span class="na">write</span><span class="o">(</span>
      <span class="nc">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">targets</span><span class="o">.</span><span class="na">toString</span><span class="o">(),</span> <span class="s">"list-of-urls.txt"</span><span class="o">),</span>
      <span class="nc">String</span><span class="o">.</span><span class="na">join</span><span class="o">(</span><span class="s">"\n"</span><span class="o">,</span> <span class="n">urls</span><span class="o">).</span><span class="na">getBytes</span><span class="o">()</span>
    <span class="o">);</span>
    <span class="c1">// Next, we have to point Nutch to the directory with the</span>
    <span class="c1">// text file and let it "inject" our URLs into its database:</span>
    <span class="k">new</span> <span class="nf">Injector</span><span class="o">(</span><span class="n">conf</span><span class="o">).</span><span class="na">inject</span><span class="o">(</span>
      <span class="k">new</span> <span class="nf">Path</span><span class="o">(</span><span class="n">home</span><span class="o">,</span> <span class="s">"crawldb"</span><span class="o">),</span> <span class="c1">// the directory with its database</span>
      <span class="k">new</span> <span class="nf">Path</span><span class="o">(</span><span class="n">home</span><span class="o">,</span> <span class="s">"urls"</span><span class="o">),</span> <span class="c1">// the directory with text files with URLs</span>
      <span class="kc">true</span><span class="o">,</span> <span class="kc">true</span> <span class="c1">// no idea what this is</span>
    <span class="o">);</span>
    <span class="c1">// Now, it's time to do a few cycles of fetching, parsing, and</span>
    <span class="c1">// updating. This is how Nutch works, in increments. Each increment</span>
    <span class="c1">// will bring new web pages to the database. The more increments</span>
    <span class="c1">// you run, the deeper Nutch will go into the Internet. Five here</span>
    <span class="c1">// is a very small number. If you really want to crawl deeper,</span>
    <span class="c1">// you will need hundreds of increments. I guess, anyway. I haven't tried it.</span>
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="o">;</span> <span class="o">++</span><span class="n">idx</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">this</span><span class="o">.</span><span class="na">cycle</span><span class="o">(</span><span class="n">home</span><span class="o">,</span> <span class="n">conf</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="c1">// Now it's time to dump what is fetched to a new directory,</span>
    <span class="c1">// which will contain HTML pages and all other files when</span>
    <span class="c1">// finished.</span>
    <span class="nc">Files</span><span class="o">.</span><span class="na">createDirectory</span><span class="o">(</span><span class="nc">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="k">new</span> <span class="nc">Path</span><span class="o">(</span><span class="n">home</span><span class="o">,</span> <span class="s">"dump"</span><span class="o">).</span><span class="na">toString</span><span class="o">()));</span>
    <span class="k">new</span> <span class="nf">FileDumper</span><span class="o">().</span><span class="na">dump</span><span class="o">(</span>
      <span class="k">new</span> <span class="nf">File</span><span class="o">(</span><span class="k">new</span> <span class="nc">Path</span><span class="o">(</span><span class="n">home</span><span class="o">,</span> <span class="s">"dump"</span><span class="o">).</span><span class="na">toString</span><span class="o">()),</span> <span class="c1">// where to dump</span>
      <span class="k">new</span> <span class="nf">File</span><span class="o">(</span><span class="k">new</span> <span class="nc">Path</span><span class="o">(</span><span class="n">home</span><span class="o">,</span> <span class="s">"segments"</span><span class="o">).</span><span class="na">toString</span><span class="o">()),</span>
      <span class="kc">null</span><span class="o">,</span> <span class="kc">true</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="kc">true</span>
    <span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">private</span> <span class="kt">void</span> <span class="nf">cycle</span><span class="o">(</span><span class="nc">Path</span> <span class="n">home</span><span class="o">,</span> <span class="nc">Configuration</span> <span class="n">conf</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// This is the directory with "segments". Each fetching cycle</span>
    <span class="c1">// will produce its own collection of files. Each collection</span>
    <span class="c1">// is called a segment.</span>
    <span class="kd">final</span> <span class="nc">Path</span> <span class="n">segments</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Path</span><span class="o">(</span><span class="n">home</span><span class="o">,</span> <span class="s">"segments"</span><span class="o">);</span>
    <span class="c1">// First, we generate a list of target URLs to fetch from:</span>
    <span class="k">new</span> <span class="nf">Generator</span><span class="o">(</span><span class="n">conf</span><span class="o">).</span><span class="na">generate</span><span class="o">(</span>
      <span class="k">new</span> <span class="nf">Path</span><span class="o">(</span><span class="n">home</span><span class="o">,</span> <span class="s">"crawldb"</span><span class="o">),</span>
      <span class="k">new</span> <span class="nf">Path</span><span class="o">(</span><span class="n">home</span><span class="o">,</span> <span class="s">"segments"</span><span class="o">),</span>
      <span class="mi">1</span><span class="o">,</span> <span class="mi">1000L</span><span class="o">,</span> <span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">()</span>
    <span class="o">);</span>
    <span class="c1">// Then, we get the path of the current segment:</span>
    <span class="kd">final</span> <span class="nc">Path</span> <span class="n">sgmt</span> <span class="o">=</span> <span class="nc">Batch</span><span class="o">.</span><span class="na">segment</span><span class="o">(</span><span class="n">segments</span><span class="o">);</span>
    <span class="c1">// Then, we fetch, parse and update:</span>
    <span class="k">new</span> <span class="nf">Fetcher</span><span class="o">(</span><span class="n">conf</span><span class="o">).</span><span class="na">fetch</span><span class="o">(</span><span class="n">sgmt</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
    <span class="k">new</span> <span class="nf">ParseSegment</span><span class="o">(</span><span class="n">conf</span><span class="o">).</span><span class="na">parse</span><span class="o">(</span><span class="n">sgmt</span><span class="o">);</span>
    <span class="k">new</span> <span class="nf">CrawlDb</span><span class="o">(</span><span class="n">conf</span><span class="o">).</span><span class="na">update</span><span class="o">(</span>
      <span class="k">new</span> <span class="nf">Path</span><span class="o">(</span><span class="n">home</span><span class="o">,</span> <span class="s">"crawldb"</span><span class="o">),</span>
      <span class="nc">Files</span><span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="nc">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">segments</span><span class="o">.</span><span class="na">toString</span><span class="o">()))</span>
          <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">p</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">Path</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">toString</span><span class="o">()))</span>
          <span class="o">.</span><span class="na">toArray</span><span class="o">(</span><span class="nc">Path</span><span class="o">[]::</span><span class="k">new</span><span class="o">),</span>
      <span class="kc">true</span><span class="o">,</span> <span class="kc">true</span>
    <span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="nc">Path</span> <span class="nf">segment</span><span class="o">(</span><span class="kd">final</span> <span class="nc">Path</span> <span class="n">dir</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
    <span class="c1">// Get the path of the most recent segment in the list,</span>
    <span class="c1">// sorted by the date/time of their creation.</span>
    <span class="kd">final</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Path</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="nc">Files</span><span class="o">.</span><span class="na">list</span><span class="o">(</span><span class="nc">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">dir</span><span class="o">.</span><span class="na">toString</span><span class="o">()))</span>
      <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">p</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">Path</span><span class="o">(</span><span class="n">p</span><span class="o">.</span><span class="na">toString</span><span class="o">()))</span>
      <span class="o">.</span><span class="na">sorted</span><span class="o">(</span><span class="nc">Comparator</span><span class="o">.</span><span class="na">comparing</span><span class="o">(</span><span class="nl">Path:</span><span class="o">:</span><span class="n">toString</span><span class="o">))</span>
      <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>
    <span class="k">return</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">list</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Pay attention that <code class="language-plaintext highlighter-rouge">Path</code> here is not the
<a href="https://docs.oracle.com/javase/8/docs/api/java/nio/file/Path.html"><code class="language-plaintext highlighter-rouge">Path</code></a> from JDK.
It’s the <a href="https://hadoop.apache.org/docs/r2.7.2/api/org/apache/hadoop/fs/Path.html"><code class="language-plaintext highlighter-rouge">Path</code></a> from Hadoop.
Don’t ask me why.</p>

<p>This seems to be a pretty straight-forward algorithm, however
there is one tricky part. Nutch, in order to work, needs a number
of plugins, which are standalone JAR packages, which it doesn’t include
in its default JAR. They exist in its
binary distribution and they
are pretty heavy (over 250MB in Nutch 1.15). Nutch expects you to download
the entire distribution, unpack, and run the binary <code class="language-plaintext highlighter-rouge">nutch</code> they provide,
which will work with the provided plugins.</p>

<p>What can we do, now that we are in Java, not in the command line? Here is what
I suggest:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;project&gt;</span>
  <span class="nt">&lt;build&gt;</span>
    <span class="nt">&lt;plugins&gt;</span>
      <span class="nt">&lt;plugin&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>com.googlecode.maven-download-plugin<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>download-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>1.4.1<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;executions&gt;</span>
          <span class="nt">&lt;execution&gt;</span>
            <span class="nt">&lt;id&gt;</span>download-nutch<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;phase&gt;</span>generate-resources<span class="nt">&lt;/phase&gt;</span>
            <span class="nt">&lt;goals&gt;</span>
              <span class="nt">&lt;goal&gt;</span>wget<span class="nt">&lt;/goal&gt;</span>
            <span class="nt">&lt;/goals&gt;</span>
            <span class="nt">&lt;configuration&gt;</span>
              <span class="nt">&lt;url&gt;</span>http://artfiles.org/apache.org/nutch/1.15/apache-nutch-1.15-bin.zip<span class="nt">&lt;/url&gt;</span>
              <span class="nt">&lt;unpack&gt;</span>true<span class="nt">&lt;/unpack&gt;</span>
              <span class="nt">&lt;outputDirectory&gt;</span>${project.build.directory}<span class="nt">&lt;/outputDirectory&gt;</span>
              <span class="nt">&lt;overwrite&gt;</span>false<span class="nt">&lt;/overwrite&gt;</span>
            <span class="nt">&lt;/configuration&gt;</span>
          <span class="nt">&lt;/execution&gt;</span>
        <span class="nt">&lt;/executions&gt;</span>
      <span class="nt">&lt;/plugin&gt;</span>
    <span class="nt">&lt;/plugins&gt;</span>
  <span class="nt">&lt;/build&gt;</span>
  [...]
<span class="nt">&lt;/project&gt;</span>
</code></pre></div></div>

<p>This Maven plugin will download the entire binary distribution of Nutch
and will unpack it to <code class="language-plaintext highlighter-rouge">target/apache-nutch-1.15</code>. The plugins will be
in <code class="language-plaintext highlighter-rouge">target/apache-nutch-1.15/plugins</code>. The only thing we still need
to do is to set the system property for the unit test:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;project&gt;</span>
  <span class="nt">&lt;build&gt;</span>
    <span class="nt">&lt;pluginManagement&gt;</span>
      <span class="nt">&lt;plugins&gt;</span>
        <span class="nt">&lt;plugin&gt;</span>
          <span class="nt">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="nt">&lt;/groupId&gt;</span>
          <span class="nt">&lt;artifactId&gt;</span>maven-surefire-plugin<span class="nt">&lt;/artifactId&gt;</span>
          <span class="nt">&lt;configuration&gt;</span>
            <span class="nt">&lt;systemPropertyVariables&gt;</span>
              <span class="nt">&lt;nutch.plugins.dir&gt;</span>${project.build.directory}/apache-nutch-1.15/plugins<span class="nt">&lt;/nutch.plugins.dir&gt;</span>
            <span class="nt">&lt;/systemPropertyVariables&gt;</span>
          <span class="nt">&lt;/configuration&gt;</span>
        <span class="nt">&lt;/plugin&gt;</span>
      <span class="nt">&lt;/plugins&gt;</span>
    <span class="nt">&lt;/pluginManagement&gt;</span>
    [...]
  <span class="nt">&lt;/build&gt;</span>
  [...]
<span class="nt">&lt;/project&gt;</span>
</code></pre></div></div>

<p>Actually, one more thing we have to do: copy the contents of the directory <code class="language-plaintext highlighter-rouge">conf</code>
from their binary distribution to our <code class="language-plaintext highlighter-rouge">src/main/resources</code> directory. There
are many files, including the most important <code class="language-plaintext highlighter-rouge">nutch-default.xml</code>. They all
have to be available on classpath, otherwise Nutch will complain in so
many places and won’t be able to load the <code class="language-plaintext highlighter-rouge">Configuration</code>.</p>

<p>You can see how it all works together in this
GitHub repository I created to illustrate the example:
<a href="https://github.com/yegor256/nutch-in-java">yegor256/nutch-in-java</a>.</p>

<p>If you have any questions or suggestions, feel free to submit a pull request
or comment here.</p>

    </article>
  </body>
</html>
