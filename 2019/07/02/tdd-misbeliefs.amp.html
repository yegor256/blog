<!doctypehtml><html amp lang="en"><meta charset="utf-8"><title>TDD Misbeliefs</title><link rel="canonical"href="https://www.yegor256.com/2019/07/02/tdd-misbeliefs.html"><link rel="icon"type="image/png"href="/favicon.ico"><meta name="viewport"content="width=device-width,minimum-scale=1,initial-scale=1"><script type="application/ld+json">{
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "mainEntityOfPage":{
          "@type": "WebPage",
          "@id": "https://www.yegor256.com/2019/07/02/tdd-misbeliefs.html"
        },
        "headline": "TDD Misbeliefs",
        "image": {
          "@type": "ImageObject",
          "url": "/images/2019/07/la-venus-a-la-fourrure.jpg",
          "height": 712,
          "width": 1692
        },
        "datePublished": "2019-07-02",
        "dateModified": "2019-07-02",
        "author": {
          "@type": "Person",
          "name": "Yegor Bugayenko"
        },
        "publisher": {
          "@type": "Organization",
          "name": "yegor256.com",
          "logo": {
            "@type": "ImageObject",
            "url": "https://www.yegor256.com/images/face-512x512.jpg",
            "width": 512,
            "height": 512
          }
        },
        "description": "Test-driven development is a very obvious and at the same time
very unclear territory in modern software development;
what is the truth?
",
        "keywords": ["tdd", "testing", "test driven development", "unit testing", "automated testing"]
      }</script><style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript><link rel="stylesheet"href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500"><style amp-custom="amp-custom">@font-face{font-family:Cambria;src:url(https://www.yegor256.com/fonts/cambria/2EAA54_2_0.ttf)}body{font-family:Cambria,'Times New Roman',serif;padding:.5em;font-size:1.2em}article{width:600px;max-width:100%;margin-left:auto;margin-right:auto}code,pre{font-family:'Source Code Pro','Courier New',monospace;font-size:.8em}code{padding:0 .3em;background-color:#d3d3d3}a,a:hover,a:visited{color:inherit}.intro{color:red;font-size:.75em}.photo{border-radius:50%}pre{overflow-x:scroll}</style><script async src="https://cdn.ampproject.org/v0.js"></script><article><p class="intro">This is a mobile version, full one is <a href="https://www.yegor256.com/2019/07/02/tdd-misbeliefs.html">here</a>.<p><amp-img src="/images/face-256x256.jpg"width="80"height="80"alt="Yegor Bugayenko"class="photo"></amp-img><p>Yegor Bugayenko<br>2 July 2019<h1>TDD Misbeliefs</h1><p>While I was working with a <a href="/2017/03/24/tdd-that-works.html">previous article</a> about Test-Driven Development (TDD) I read many blog posts and a few books on the subject and found out that I disagree with a few of them; even some that are pretty important. It seems that most software experts simply misunderstand how software development works. Maybe because they are not really programmers, but are instead book authors and conference speakers.</p><amp-img src="/images/2019/07/la-venus-a-la-fourrure.jpg"alt="La Vénus à la fourrure (2013) by Roman Polanski"height="712"width="1692"layout="responsive"></amp-img><p>Robert Martin (<a href="https://twitter.com/unclebobmartin">@unclebobmartin</a>) in <a href="http://blog.cleancoder.com/uncle-bob/2014/12/17/TheCyclesOfTDD.html">The Cycles Of TDD</a>:<blockquote><p>If the changes you make to the production code, pursuant to a test, make that test pass, but would not make other unwritten tests pass, then you are likely making the production code too specific.</blockquote><p><span class="red">I disagree</span>. This statement goes against the very philosophy of testing: “a passing test is a <em>weak</em> test.” Unfortunately, a traditional understanding of testing is quite the opposite: tests <em>must pass</em> to make us happy. Thus, if we keep thinking about how to make our future tests pass we will shoot ourselves in the foot: tests will pass and the code quality will go down. Instead, we must design our code in a way that makes it easy to break with the future tests. The code must help its tests to break it! Because a test that is easy to make “red” is a good test. A test that is always “green” is a useless test. Uncle Bob, I’m sure, is aware of that.<p>James Shore (<a href="https://twitter.com/jamesshore">@jamesshore</a>) in <a href="https://www.jamesshore.com/Blog/Red-Green-Refactor.html">Red-Green-Refactor</a> (Nov 2005):<blockquote><p>You’ll run through several cycles very quickly, then find yourself slowing down and spending more time on refactoring.</blockquote><p><span class="red">I disagree</span>. I have nothing against the first two steps: 1) the test is “red” because it doesn’t pass, and 2) the test is “green” when the code is fixed and passes. I disagree that refactoring is a responsibility of the person who fixes the test. If the code needs refactoring, it’s a <em>bug</em>, just like any other bug, either functional or design. It has to be reported, assigned and paid for. We must not do any code modifications, no matter how good our intentions are, if they are not required <em>and paid for</em>. Refactoring after fixing the test is a frivolous violation of management and coordination structure in a project.<p>Robert Martin (<a href="https://twitter.com/unclebobmartin">@unclebobmartin</a>) in <a href="https://8thlight.com/blog/uncle-bob/2014/04/30/When-tdd-does-not-work.html">When TDD doesn’t work</a> (April 2014):<blockquote><p>You don’t have to write tests for Test Doubles because the actual unit tests and the production code are the tests for those pieces of code.</blockquote><p><span class="red">I disagree</span>. Test Doubles (also known as <a href="/2014/09/23/built-in-fake-objects.html">fake objects</a>) are the tools that help us find our where the code is broken. If the tool is unreliable, how can we test our code against it? This reminds me of an old joke where a patient comes to the doctor and says “Help me doc, my body hurts anywhere I touch it with my finger!” The doctor answers “It’s just your finger—it’s broken!” A very similar situation occurs here: If we test our production objects with broken Test Doubles, they will all look broken.<p>David Heinemeier Hansson (<a href="https://twitter.com/dhh">@dhh</a>) in <a href="https://signalvnoise.com/posts/3159-testing-like-the-tsa">Testing like the TSA</a> (April 2012):<blockquote><p>Code-to-test ratios above 1:2 is a smell, above 1:3 is a stink.</blockquote><p><span class="red">I disagree</span>. I don’t know exactly what units of measurement were used to compare the “code” and the “test,” but I can only assume Lines-of-Code. I was curious and decided to calculate this ratio in a few projects of mine. First, I tried <a href="https://github.com/jcabi/jcabi-github">jcabi-github</a>, an immutable GitHub Java API client. The numbers were: 9.8K LoC in production classes, 6.2K in built-in fake classes, and 16.2K in test classes. Thus, the ratio was 9.8 to 22.4, which meant 1:2.3. Somewhere between a “smell” and a “stink,” according to David. Then I calculated the ratio for a few other projects of mine: <a href="https://github.com/jcabi/jcabi-http">jcabi-http</a> (1:1), <a href="https://github.com/yegor256/xembly">xembly</a> (1:0.92), <a href="https://github.com/yegor256/takes">takes</a> (1:0.91), and <a href="https://github.com/yegor256/rultor">rultor</a> (1:0.6). It seems that the higher the ratio the higher my <em>confidence</em> in the product’s quality. Thus, I don’t think that it’s a smell or a stink. Instead, in a yummy-scented product the amount of test code is a few times larger than its production counterpart.<p>Kent Beck (<a href="https://twitter.com/kentbeck">@kentbeck</a>) in <a href="http://stackoverflow.com/questions/153234/how-deep-are-your-unit-tests/153565#153565">How deep are your unit tests?</a> (Sep 2008):<blockquote><p>I get paid for code that works, not for tests.</blockquote><p><span class="red">I disagree</span>. Tests are not a separate product which either we are paid for or not. Tests are part of the code. An instrument of its development, maintenance and validation. Tests are similar to, say, file names. We don’t write our code naming all the files <code class="language-plaintext highlighter-rouge">1.java</code>, <code class="language-plaintext highlighter-rouge">2.java</code>, <code class="language-plaintext highlighter-rouge">234.java</code>, and then say: “Now you pay me so that I can rename them properly.” That would be weird, right? That’s how the statement “I’m not paid for writing tests” sounds to me: weird. Do we really have to be paid to name files correctly? We just do it, because it’s convenient for us. Because proper self-descriptive file names make our code more readable and maintainable. It’s impossible to imagine a modern maintainable code base without tests. I would actually suggest changing that phrase to: “I get paid for code that is tested, not just for code.”<blockquote class="twitter-tweet"data-lang="en"><p lang="en"dir="ltr">What do you do if a customer says: "I won't pay for unit tests?" <a href="https://twitter.com/hashtag/codeahead?src=hash&amp;ref_src=twsrc%5Etfw">#codeahead</a></p>— Yegor Bugayenko (@yegor256) <a href="https://twitter.com/yegor256/status/1150321038674354176?ref_src=twsrc%5Etfw">July 14, 2019</a></blockquote><p>I will keep updating this post. If you know a “good” article about TDD, please send it <a href="mailto:tdd@yegor256.com">my way</a>; maybe I’ll find something interesting to quote from it.</article>