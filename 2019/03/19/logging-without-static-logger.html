<!DOCTYPE html> <html xmlns="https://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="Traditionally in Java and many other languages we use static loggers, which are in essence global variables or singletons; there is a better way to log." /> <meta name="keywords" content="java logger, java static logger, logger static, ruby logger, static logger" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2019-03-19 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="Logging Without a Static Logger"/> <meta name="twitter:description" property="og:description" content="Traditionally in Java and many other languages we use static loggers, which are in essence global variables or singletons; there is a better way to log."/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2019/03/19/logging-without-static-logger.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?ffdde63ad39"/> <link rel="apple-touch-icon" href="/favicon.ico?ffdde63ad39"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?ffdde63ad39"/> <link rel="stylesheet" href="/css/icons.css?ffdde63ad39"/> <link rel="canonical" href="https://www.yegor256.com/2019/03/19/logging-without-static-logger.html" /> <title>Logging Without a Static Logger</title> <meta name='og:image' content='https://www.yegor256.com/images/2019/03/the-square.jpg'/><meta name='twitter:image' content='https://www.yegor256.com/images/2019/03/the-square.jpg'/><meta name='og:image:width' content='1900'/> <meta name='twitter:image:width' content='1900'/><meta name='og:image:height' content='1024'/> <meta name='twitter:image:height' content='1024'/><meta name='twitter:card' content='summary_large_image'/><meta name='twitter:image:alt' content='The Square (2017) by Ruben Östlund'/> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My Stack Overflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li ><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li ><a href="/contents.html" title="The contents of the entire blog">All&#160;393</a></li> <li ><a href="/teaching.html" title="My courses and lectures">Teaching</a></li> <li ><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li ><a href="/books.html" title="The books I wrote">Books</a></li> <li ><a href="/research.html" title="My research directions and progress">Research</a></li> <li ><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li ><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li ><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li ><a href="/paintings.html" title="My paintings for sale">Art</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке о политике в России, Украине и мире">Политика</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2019/03/19/logging-without-static-logger.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2019/03/19/logging-without-static-logger.html</code></p><h1 itemprop="name headline mainEntityOfPage">Logging Without a Static Logger</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2019-03-19T00:00:00+00:00"> 19 March 2019 </time> </li> <li class="desktop-only" itemprop="locationCreated">Moscow, Russia</li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="https://www.yegor256.com/2019/03/19/logging-without-static-logger.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><ul class="subline"> <li title="The page is translated by ChatGPT from English to a few languages"> Translated by <i class="icon icon-chatgpt notranslate" aria-hidden="true"></i> to </li> <li title="Click to see this page translated to Chinese"> <a href='https://www.yegor256.com/zh/2019/03/19/logging-without-static-logger.html'>中文</a> </li> <li title="Click to see this page translated to Russian"> <a href='https://www.yegor256.com/ru/2019/03/19/logging-without-static-logger.html'>русский</a> </li></ul><p class="unprintable"><a href='/tag/oop.html' class='tag notranslate'><img src='/images/icons/cactus.svg' alt='OOP'/>oop</a></p><nav class="buttons notranslate desktop-only"> <a href="https://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2019/03/19/logging-without-static-logger.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2019/03/19/logging-without-static-logger.html&amp;text=Logging+Without+a+Static+Logger" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2019/03/19/logging-without-static-logger.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="https://reddit.com/submit?url=https://www.yegor256.com/2019/03/19/logging-without-static-logger.html%3F2019-11&amp;title=Logging+Without+a+Static+Logger" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="https://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2019/03/19/logging-without-static-logger.html%3F2019-11&amp;t=Logging+Without+a+Static+Logger" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div ><p>How do you organize logging in your applications? I mean web applications or command line apps, or even mobile apps. I bet you have some global variable or a singleton, known as <code class="language-plaintext highlighter-rouge">Logger</code>, which has a few methods like <code class="language-plaintext highlighter-rouge">info()</code>, <code class="language-plaintext highlighter-rouge">error()</code>, and <code class="language-plaintext highlighter-rouge">debug()</code>. You configure it when the app starts, or it configures itself via something like <code class="language-plaintext highlighter-rouge">log4j.properties</code>, and logs everything to the console or a file, or even a database. I was doing exactly that, or <a href="/2014/05/23/avoid-java-static-logger.html">something very similar</a>, for many years, until I finally realized how wrong this approach was. In one of my recent Ruby applications I did it all differently, and since then I’m much happier than I was before.</p><figure class="jb_picture"><img itemprop="image" alt="The Square (2017) by Ruben Östlund" src="/images/2019/03/the-square.jpg" longdesc="#1b0abaf5" /><figcaption id="1b0abaf5">The Square (2017) by Ruben Östlund</figcaption></figure><p>Well, if your application is simple and has almost no unit or integration tests, you will be doing just fine with a static logger, which in essence is a global variable. However, as we <a href="/2018/07/03/global-variables.html">discussed before</a>, global variables are evil. What can go wrong if we use a static logger? Or, in other words, as one of my friends used to say, what exactly is the problem we are going to solve? Basically, there are two problems:</p><ul> <li><p>First, with a single global logger you will have a hard time writing a unit test to check whether your app is actually logging things correctly. Even if you intercept the log stream, there will be a lot of noise, coming from other threads and other tests. It’s not an unsolvable problem, but its solution adds complexity to your tests.</p></li> <li><p>Second, when you decide to show a selected part of the log to your end-user, you will have to do a lot of coding just in order to separate what belongs to the user and what does not, especially in a multi-threaded environment. You’re lucky if it’s Java and you have thread groups, but in Ruby, for example, there is no such thing and you will have to find some workaround.</p></li></ul><p>To overcome them both, in <a href="https://github.com/zold-io/zold">Zold</a>, a Ruby command line application, I decided to pass <code class="language-plaintext highlighter-rouge">log</code> as a variable to all classes that need any logging. In Ruby it’s easier than in Java, because they have <a href="https://stackoverflow.com/questions/35747905">optional</a> parameters. Look at <a href="https://github.com/zold-io/zold/blob/0.26.17/lib/zold/commands/list.rb">this class</a>, for example (it’s a simplified version, of course):</p><div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Zold::List</span>
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">wallets</span><span class="p">:,</span> <span class="ss">log: </span><span class="no">Log</span><span class="o">::</span><span class="no">NULL</span><span class="p">)</span>
    <span class="vi">@wallets</span> <span class="o">=</span> <span class="n">wallets</span>
    <span class="vi">@log</span> <span class="o">=</span> <span class="n">log</span>
  <span class="k">end</span>
  <span class="k">def</span> <span class="nf">run</span>
    <span class="vi">@wallets</span><span class="p">.</span><span class="nf">all</span><span class="p">.</span><span class="nf">sort</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="nb">id</span><span class="o">|</span>
      <span class="vi">@wallets</span><span class="p">.</span><span class="nf">acq</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">wallet</span><span class="o">|</span>
        <span class="vi">@log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s2">"</span><span class="si">#{</span><span class="nb">id</span><span class="si">}</span><span class="s2">: </span><span class="si">#{</span><span class="n">wallet</span><span class="p">.</span><span class="nf">balance</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div><p>This class is supposed to list all wallets in the current directory and print their balances to the log, which <em>in some cases</em> will be the console. However, when this class is called from a web application, the destination of the print is a temporary file, which is later rendered on the web page. In unit tests it can be something else, which has to capture everything that is sent to the log and then delivered to the unit test.</p><aside class="youtube"> <a href="https://www.youtube.com/watch?v=SoXV_scCMNY"><div class="box"> <img src="https://i.ytimg.com/vi/SoXV_scCMNY/mqdefault.jpg" alt="YouTube video #SoXV_scCMNY" /><div class="play"><i class="icon icon-play"></i></div></div></a><div>Logging, the Object-Oriented Way; 12 June 2019.</div></aside><p>As you see, the default value of the <code class="language-plaintext highlighter-rouge">log</code> is <code class="language-plaintext highlighter-rouge">Log::NULL</code>, which is the constant I had to define myself, as a default logger, which doesn’t log anything anywhere. By default, this class will log nothing. It will quietly check all the balances of all the wallets and print nothing. Well, it will print, but nobody will see that.</p><p>In a unit test I create an object with a few methods like <code class="language-plaintext highlighter-rouge">debug()</code>, <code class="language-plaintext highlighter-rouge">info()</code>, etc. and pass it to the instance of class <code class="language-plaintext highlighter-rouge">Zold::List</code>, which I’m testing. In other words, it’s a fake/mock version of the logger, which I use to capture everything that <code class="language-plaintext highlighter-rouge">Zold::List</code> sends out. Then I can check what’s there.</p><p>Am I saying obvious things here? If so, why do we <a href="/2014/05/23/avoid-java-static-logger.html">still have</a> static loggers everywhere in Java, Ruby, PHP, C#, etc? Anyway, I recommend you use an injectable logging dependency instead.</p><p>And yeah, by the way, I’m sure you noticed the change in the name. It’s not a <code class="language-plaintext highlighter-rouge">logger</code> anymore, it’s <code class="language-plaintext highlighter-rouge">log</code>. I’m sure you know <a href="/2015/03/09/objects-end-with-er.html">why</a>.</p><blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">How do you log a message from an object of class Book? <a href="https://twitter.com/hashtag/elegantobjects?src=hash&amp;ref_src=twsrc%5Etfw">#elegantobjects</a></p>&mdash; Yegor Bugayenko (@yegor256) <a href="https://twitter.com/yegor256/status/1122381490480930817?ref_src=twsrc%5Etfw">April 28, 2019</a></blockquote> <script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div></article></div><div class="wrapper" aria-hidden="true"> <related-posts /></div><div class="disqus" role="complementary" aria-hidden="true"><p class="disqus_hint" > Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2023</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="https://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge" /></a> &nbsp; <a href="https://github.com/yegor256/blog/stargazers"> <img src="//img.shields.io/github/stars/yegor256/blog.svg?style=flat-square" alt="GitHub stars" /></a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?ffdde63ad39"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html>
