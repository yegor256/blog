<!doctypehtml><html amp lang="en"><meta charset="utf-8"><title>Logging Without a Static Logger</title><link rel="canonical"href="https://www.yegor256.com/2019/03/19/logging-without-static-logger.html"><link rel="icon"type="image/png"href="/favicon.ico"><meta name="viewport"content="width=device-width,minimum-scale=1,initial-scale=1"><script type="application/ld+json">{
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "mainEntityOfPage":{
          "@type": "WebPage",
          "@id": "https://www.yegor256.com/2019/03/19/logging-without-static-logger.html"
        },
        "headline": "Logging Without a Static Logger",
        "image": {
          "@type": "ImageObject",
          "url": "/images/2019/03/the-square.jpg",
          "height": 1024,
          "width": 1900
        },
        "datePublished": "2019-03-19",
        "dateModified": "2019-03-19",
        "author": {
          "@type": "Person",
          "name": "Yegor Bugayenko"
        },
        "publisher": {
          "@type": "Organization",
          "name": "yegor256.com",
          "logo": {
            "@type": "ImageObject",
            "url": "https://www.yegor256.com/images/face-512x512.jpg",
            "width": 512,
            "height": 512
          }
        },
        "description": "Traditionally in Java and many other languages we
use static loggers, which are in essence global variables
or singletons; there is a better way to log.
",
        "keywords": ["static logger", "logger static", "java static logger", "java logger", "ruby logger"]
      }</script><style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript><link rel="stylesheet"href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500"><style amp-custom="amp-custom">@font-face{font-family:Cambria;src:url(https://www.yegor256.com/fonts/cambria/2EAA54_2_0.ttf)}body{font-family:Cambria,'Times New Roman',serif;padding:.5em;font-size:1.2em}article{width:600px;max-width:100%;margin-left:auto;margin-right:auto}code,pre{font-family:'Source Code Pro','Courier New',monospace;font-size:.8em}code{padding:0 .3em;background-color:#d3d3d3}a,a:hover,a:visited{color:inherit}.intro{color:red;font-size:.75em}.photo{border-radius:50%}pre{overflow-x:scroll}</style><script async src="https://cdn.ampproject.org/v0.js"></script><article><p class="intro">This is a mobile version, full one is <a href="https://www.yegor256.com/2019/03/19/logging-without-static-logger.html">here</a>.<p><amp-img src="/images/face-256x256.jpg"width="80"height="80"alt="Yegor Bugayenko"class="photo"></amp-img><p>Yegor Bugayenko<br>19 March 2019<h1>Logging Without a Static Logger</h1><p>How do you organize logging in your applications? I mean web applications or command line apps, or even mobile apps. I bet you have some global variable or a singleton, known as <code class="language-plaintext highlighter-rouge">Logger</code>, which has a few methods like <code class="language-plaintext highlighter-rouge">info()</code>, <code class="language-plaintext highlighter-rouge">error()</code>, and <code class="language-plaintext highlighter-rouge">debug()</code>. You configure it when the app starts, or it configures itself via something like <code class="language-plaintext highlighter-rouge">log4j.properties</code>, and logs everything to the console or a file, or even a database. I was doing exactly that, or <a href="/2014/05/23/avoid-java-static-logger.html">something very similar</a>, for many years, until I finally realized how wrong this approach was. In one of my recent Ruby applications I did it all differently, and since then I’m much happier than I was before.</p><amp-img src="/images/2019/03/the-square.jpg"alt="The Square (2017) by Ruben Östlund"height="1024"width="1900"layout="responsive"></amp-img><p>Well, if your application is simple and has almost no unit or integration tests, you will be doing just fine with a static logger, which in essence is a global variable. However, as we <a href="/2018/07/03/global-variables.html">discussed before</a>, global variables are evil. What can go wrong if we use a static logger? Or, in other words, as one of my friends used to say, what exactly is the problem we are going to solve? Basically, there are two problems:<ul><li><p>First, with a single global logger you will have a hard time writing a unit test to check whether your app is actually logging things correctly. Even if you intercept the log stream, there will be a lot of noise, coming from other threads and other tests. It’s not an unsolvable problem, but its solution adds complexity to your tests.<li><p>Second, when you decide to show a selected part of the log to your end-user, you will have to do a lot of coding just in order to separate what belongs to the user and what does not, especially in a multi-threaded environment. You’re lucky if it’s Java and you have thread groups, but in Ruby, for example, there is no such thing and you will have to find some workaround.</ul><p>To overcome them both, in <a href="https://github.com/zold-io/zold">Zold</a>, a Ruby command line application, I decided to pass <code class="language-plaintext highlighter-rouge">log</code> as a variable to all classes that need any logging. In Ruby it’s easier than in Java, because they have <a href="https://stackoverflow.com/questions/35747905">optional</a> parameters. Look at <a href="https://github.com/zold-io/zold/blob/0.26.17/lib/zold/commands/list.rb">this class</a>, for example (it’s a simplified version, of course):<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Zold::List</span>
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">wallets</span><span class="p">:,</span> <span class="ss">log: </span><span class="no">Log</span><span class="o">::</span><span class="no">NULL</span><span class="p">)</span>
    <span class="vi">@wallets</span> <span class="o">=</span> <span class="n">wallets</span>
    <span class="vi">@log</span> <span class="o">=</span> <span class="n">log</span>
  <span class="k">end</span>
  <span class="k">def</span> <span class="nf">run</span>
    <span class="vi">@wallets</span><span class="p">.</span><span class="nf">all</span><span class="p">.</span><span class="nf">sort</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="nb">id</span><span class="o">|</span>
      <span class="vi">@wallets</span><span class="p">.</span><span class="nf">acq</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">wallet</span><span class="o">|</span>
        <span class="vi">@log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s2">"</span><span class="si">#{</span><span class="nb">id</span><span class="si">}</span><span class="s2">: </span><span class="si">#{</span><span class="n">wallet</span><span class="p">.</span><span class="nf">balance</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div><p>This class is supposed to list all wallets in the current directory and print their balances to the log, which <em>in some cases</em> will be the console. However, when this class is called from a web application, the destination of the print is a temporary file, which is later rendered on the web page. In unit tests it can be something else, which has to capture everything that is sent to the log and then delivered to the unit test.<p>As you see, the default value of the <code class="language-plaintext highlighter-rouge">log</code> is <code class="language-plaintext highlighter-rouge">Log::NULL</code>, which is the constant I had to define myself, as a default logger, which doesn’t log anything anywhere. By default, this class will log nothing. It will quietly check all the balances of all the wallets and print nothing. Well, it will print, but nobody will see that.<p>In a unit test I create an object with a few methods like <code class="language-plaintext highlighter-rouge">debug()</code>, <code class="language-plaintext highlighter-rouge">info()</code>, etc. and pass it to the instance of class <code class="language-plaintext highlighter-rouge">Zold::List</code>, which I’m testing. In other words, it’s a fake/mock version of the logger, which I use to capture everything that <code class="language-plaintext highlighter-rouge">Zold::List</code> sends out. Then I can check what’s there.<p>Am I saying obvious things here? If so, why do we <a href="/2014/05/23/avoid-java-static-logger.html">still have</a> static loggers everywhere in Java, Ruby, PHP, C#, etc? Anyway, I recommend you use an injectable logging dependency instead.<p>And yeah, by the way, I’m sure you noticed the change in the name. It’s not a <code class="language-plaintext highlighter-rouge">logger</code> anymore, it’s <code class="language-plaintext highlighter-rouge">log</code>. I’m sure you know <a href="/2015/03/09/objects-end-with-er.html">why</a>.<blockquote class="twitter-tweet"data-lang="en"><p lang="en"dir="ltr">How do you log a message from an object of class Book? <a href="https://twitter.com/hashtag/elegantobjects?src=hash&amp;ref_src=twsrc%5Etfw">#elegantobjects</a></p>— Yegor Bugayenko (@yegor256) <a href="https://twitter.com/yegor256/status/1122381490480930817?ref_src=twsrc%5Etfw">April 28, 2019</a></blockquote></article>