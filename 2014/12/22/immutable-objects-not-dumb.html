<!DOCTYPE html> <html xmlns="https://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="Immutable objects are not the same as passive data structures without setters, despite a very common mis-belief." /> <meta name="keywords" content="immutable objects, immutable objects advantages, immutable objects are thread safe, immutable objects in java, immutable objects in java example" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2014-12-22 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="Immutable Objects Are Not Dumb"/> <meta name="twitter:description" property="og:description" content="Immutable objects are not the same as passive data structures without setters, despite a very common mis-belief."/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2014/12/22/immutable-objects-not-dumb.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?3be988b2c92"/> <link rel="apple-touch-icon" href="/favicon.ico?3be988b2c92"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?3be988b2c92"/> <link rel="stylesheet" href="/css/icons.css?3be988b2c92"/> <link rel="canonical" href="https://www.yegor256.com/2014/12/22/immutable-objects-not-dumb.html" /> <title>Immutable Objects Are Not Dumb</title> <meta name='og:image' content='https://www.yegor256.com/images/2014/12/usual-suspects-kobayashi.png'/><meta name='twitter:image' content='https://www.yegor256.com/images/2014/12/usual-suspects-kobayashi.png'/><meta name='twitter:card' content='summary'/><meta name='twitter:image:alt' content='The Usual Suspects (1995) by Bryan Singer'/> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/santa-hat.svg" alt="Santa hat" style="position:absolute;width:115px;left:-30px;top:-120px"/> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My Stack Overflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li ><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li ><a href="/contents.html" title="The contents of the entire blog">All&#160;395</a></li> <li ><a href="/teaching.html" title="My courses and lectures">Teaching</a></li> <li ><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li ><a href="/books.html" title="The books I wrote">Books</a></li> <li ><a href="/research.html" title="My research directions and progress">Research</a></li> <li ><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li ><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li ><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li ><a href="/paintings.html" title="My paintings for sale">Art</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке о политике в России, Украине и мире">Политика</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2014/12/22/immutable-objects-not-dumb.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2014/12/22/immutable-objects-not-dumb.html</code></p><h1 itemprop="name headline mainEntityOfPage">Immutable Objects Are Not Dumb</h1><aside class='book'><a href='https://amzn.to/2qFt4Tn'><img src='/images/books/elegant-objects/cover-eo1.png' class='book-cover' alt='book cover'/></a>Read more about this subject in <a href='https://amzn.to/2qFt4Tn'>Section&nbsp;2.6</a><br/> of my book<a href='https://amzn.to/2qFt4Tn'><img src='/images/books/amazon-buy-button.png' class='amazon-button' alt='Click to buy'/></a></aside><ul class="subline"> <li> <time itemprop="datePublished" datetime="2014-12-22T00:00:00+00:00"> 22 December 2014 </time> </li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="https://www.yegor256.com/2014/12/22/immutable-objects-not-dumb.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><ul class="subline"> <li title="The page is translated by ChatGPT from English to a few languages"> Translated by <i class="icon icon-chatgpt notranslate" aria-hidden="true"></i> to </li> <li title="Click to see this page translated to Chinese"> <a href='https://www.yegor256.com/zh/2014/12/22/immutable-objects-not-dumb.html'>中文</a> </li> <li title="Click to see this page translated to Russian"> <a href='https://www.yegor256.com/ru/2014/12/22/immutable-objects-not-dumb.html'>русский</a> </li></ul><p class="unprintable"><a href='/tag/oop.html' class='tag notranslate'><img src='/images/icons/cactus.svg' alt='OOP'/>oop</a></p><nav class="buttons notranslate desktop-only"> <a href="https://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2014/12/22/immutable-objects-not-dumb.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2014/12/22/immutable-objects-not-dumb.html&amp;text=Immutable+Objects+Are+Not+Dumb" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2014/12/22/immutable-objects-not-dumb.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="https://reddit.com/submit?url=https://www.yegor256.com/2014/12/22/immutable-objects-not-dumb.html%3F2014-51&amp;title=Immutable+Objects+Are+Not+Dumb" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="https://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2014/12/22/immutable-objects-not-dumb.html%3F2014-51&amp;t=Immutable+Objects+Are+Not+Dumb" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div ><p>After a few recent posts about immutability, including <a href="/2014/06/09/objects-should-be-immutable.html">Objects Should Be Immutable</a> and <a href="/2014/12/09/immutable-object-state-and-behavior.html">How an Immutable Object Can Have State and Behavior?</a>, I was surprised by the number of comments saying that I badly misunderstood the idea. Most of those comments stated that an immutable object must always behave the same way—that is what immutability is about. What kind of immutability is it, if a method returns different results each time we call it? This is not how well-known immutable classes behave. Take, for example, <code class="language-plaintext highlighter-rouge">String</code>, <code class="language-plaintext highlighter-rouge">BigInteger</code>, <code class="language-plaintext highlighter-rouge">Locale</code>, <code class="language-plaintext highlighter-rouge">URI</code>, <code class="language-plaintext highlighter-rouge">URL</code>, <code class="language-plaintext highlighter-rouge">Inet4Address</code>, <code class="language-plaintext highlighter-rouge">UUID</code>, or wrapper classes for primitives, like <code class="language-plaintext highlighter-rouge">Double</code> and <code class="language-plaintext highlighter-rouge">Integer</code>. Other comments argued against <a href="/2014/11/20/seven-virtues-of-good-object.html">the very definition</a> of an immutable object as a representative of a mutable real-world entity. How could an immutable object represent a mutable entity? Huh?</p><figure class="jb_picture"><img itemprop="image" alt="The Usual Suspects (1995) by Bryan Singer" src="/images/2014/12/usual-suspects-kobayashi.png" longdesc="#0f7b14d6" /><figcaption id="0f7b14d6">The Usual Suspects (1995) by Bryan Singer</figcaption></figure> <aside class="youtube"> <a href="https://www.youtube.com/watch?v=p7m7_iiqaHI"><div class="box"> <img src="https://i.ytimg.com/vi/p7m7_iiqaHI/mqdefault.jpg" alt="YouTube video #p7m7_iiqaHI" /><div class="play"><i class="icon icon-play"></i></div></div></a><div>How Much Immutability Is Enough?; 19 May 2016.</div></aside><p>I’m very surprised. This post is going to clarify the definition of an immutable <a href="/2016/07/14/who-is-object.html">object</a>. First, here is a quick answer. How can an immutable object represent a mutable entity? Look at an immutable class, <a href="http://docs.oracle.com/javase/7/docs/api/java/io/File.html"><code class="language-plaintext highlighter-rouge">File</code></a>, and its methods, for example <code class="language-plaintext highlighter-rouge">length()</code> and <code class="language-plaintext highlighter-rouge">delete()</code>. The class is immutable, according to Oracle documentation, and its methods may return different values each time we call them. An object of class <code class="language-plaintext highlighter-rouge">File</code>, being perfectly immutable, represents a mutable real-world entity, a file on disk.</p><figure class="badge"><a href="https://amzn.to/2c7sVS1"><img src="/images/2014/12/java-concurrency-in-practice.png" style="width:100px;max-width:100%;" alt="badge" /></a></figure><p>In <a href="/2014/06/09/objects-should-be-immutable.html">this post</a>, I said that “an object is immutable if its state can’t be modified after it is created.” This definition is not mine; it’s taken from <a href="https://amzn.to/2c7sVS1">Java Concurrency in Practice by Goetz et al.</a>, Section 3.4 (by the way, I highly recommend you read it). Now look at this class (I’m using <a href="https://http.jcabi.com">jcabi-http</a> to read and write over HTTP):</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Immutable</span>
<span class="kd">class</span> <span class="nc">Page</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="no">URI</span> <span class="n">uri</span><span class="o">;</span>
  <span class="nc">Page</span><span class="o">(</span><span class="no">URI</span> <span class="n">addr</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">uri</span> <span class="o">=</span> <span class="n">addr</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">load</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">JdkRequest</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">uri</span><span class="o">)</span>
      <span class="o">.</span><span class="na">fetch</span><span class="o">().</span><span class="na">body</span><span class="o">();</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">save</span><span class="o">(</span><span class="nc">String</span> <span class="n">content</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">new</span> <span class="nf">JdkRequest</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">uri</span><span class="o">)</span>
      <span class="o">.</span><span class="na">method</span><span class="o">(</span><span class="s">"PUT"</span><span class="o">)</span>
      <span class="o">.</span><span class="na">body</span><span class="o">().</span><span class="na">set</span><span class="o">(</span><span class="n">content</span><span class="o">).</span><span class="na">back</span><span class="o">()</span>
      <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><p>What is the “state” in this class? That’s right, <code class="language-plaintext highlighter-rouge">this.uri</code> is the state. It uniquely identifies every object of this class, and it is not modifiable. Thus, the class makes only immutable objects. And each object represents a mutable entity of the real world, a web page with a URI.</p><p>There is no contradiction in this situation. The class is perfectly immutable, while the web page it represents is mutable.</p><aside class="youtube"> <a href="https://www.youtube.com/watch?v=KwP7Ay9Z-hc"><div class="box"> <img src="https://i.ytimg.com/vi/KwP7Ay9Z-hc/mqdefault.jpg" alt="YouTube video #KwP7Ay9Z-hc" /><div class="play"><i class="icon icon-play"></i></div></div></a><div>Immutable Objects vs. Common Sense (webinar #2); 6 May 2015.</div></aside><p>Why do most programmers I have talked to believe that if an underlying entity is mutable, an object is mutable too? I think the answer is simple—they think that objects are data structures with methods. That’s why, from this point of view, an immutable object is a data structure that never changes.</p><p>This is where the fallacy is coming from—an object is <strong>not a data structure</strong>. It is a living organism representing a real-world entity inside the object’s living environment (a computer program). It does encapsulate some data, which helps to locate the entity in the real world. The encapsulated data is the <strong>coordinates</strong> of the entity being represented. In the case of <code class="language-plaintext highlighter-rouge">String</code> or <code class="language-plaintext highlighter-rouge">URL</code>, the coordinates are the same as the entity itself, but this is just an isolated incident, not a generic rule.</p><aside class="youtube"> <a href="https://www.youtube.com/watch?v=EnhRgXrHCC4"><div class="box"> <img src="https://i.ytimg.com/vi/EnhRgXrHCC4/mqdefault.jpg" alt="YouTube video #EnhRgXrHCC4" /><div class="play"><i class="icon icon-play"></i></div></div></a><div>How Immutability Helps in OOP (in Russian with English subtitles); 21 May 2016.</div></aside><p>An immutable object is not a data structure that doesn’t change, even though <code class="language-plaintext highlighter-rouge">String</code>, <code class="language-plaintext highlighter-rouge">BigInteger</code>, and <code class="language-plaintext highlighter-rouge">URL</code> look like one. An object is immutable if and only if it doesn’t change the coordinates of the real-world entity it represents. In the <code class="language-plaintext highlighter-rouge">Page</code> class above, this means that an object of the class, once instantiated, will never change <code class="language-plaintext highlighter-rouge">this.uri</code>. It will always point to the same web page, no matter what.</p><p>And the object doesn’t guarantee anything about the behavior of that web page. The page is a dynamic creature of a real world, living its own life. Our object can’t promise anything about the page. The only thing it promises is that it will always stay loyal to that page—it will never forget or change its coordinates.</p><p>Conceptually speaking, immutability means loyalty, that’s all.</p></div></article></div><div class="wrapper" aria-hidden="true"><div class="unprintable"> <hr/><p>If you like this article, you will definitely like these <strong>very relevant</strong> posts too:</p><p><a href='/2014/06/09/objects-should-be-immutable.html'><strong>Objects Should Be Immutable</strong></a><br/>The article gives arguments about why classes/objects in object-oriented programming have to be immutable, i.e. never modify their encapsulated state</p><p><a href='/2014/12/09/immutable-object-state-and-behavior.html'><strong>How an Immutable Object Can Have State and Behavior?</strong></a><br/>Object state and behavior are two very different things, and confusing the two often leads to incorrect design.</p><p><a href='/2016/09/07/gradients-of-immutability.html'><strong>Gradients of Immutability</strong></a><br/>There are a few levels and forms of immutability in object-oriented programming, all of which can be used when they seem appropriate.</p></div></div><div class="disqus" role="complementary" aria-hidden="true"><p class="disqus_hint" > Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2023</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="https://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge" /></a> &nbsp; <a href="https://github.com/yegor256/blog/stargazers"> <img src="//img.shields.io/github/stars/yegor256/blog.svg?style=flat-square" alt="GitHub stars" /></a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?3be988b2c92"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html>
