<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta charset="utf-8"/><meta name="description" content="Xembly is an imperative language for XML data and schema manipulations that makes XML building much easier and convenient"/><meta name="keywords" content="assembly for xml, xembly, xml, xml manipulation, xml modification, xpath, xsl"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="twitter:account_id" content="4503599630178231"/><meta name="blogcatalog" content="37407fab23a5d309f7bb5ef9fd22c6d5"/><link rel="shortcut icon" href="/favicon.ico?63eeb2e"><link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="http://www.yegor256.com/rss.xml"/><link rel="author" href="//plus.google.com/u/0/114792568016408327418?rel=author"/><link rel="stylesheet" href="/css/layout.css?63eeb2e"/><link rel="canonical" href="http://www.yegor256.com/2014/04/09/xembly-intro.html"/><title>Xembly, an Assembly for XML</title></head><body><div class="wrapper"> <header class="header"><div> <a href="/about-me.html"> <img src="/images/yegor-bugayenko.png" class="photo" alt="photo"/> </a></div> <nav role="navigation"><ul class="menu social"><li><a href="http://www.twitter.com/yegor256" title="follow me in Twitter"><i class="icon icon-twitter"></i></a></li><li><a href="/rss" title="RSS feed"><i class="icon icon-rss"></i></a></li><li><a href="https://github.com/yegor256" title="my Github profile"><i class="icon icon-github"></i></a></li><li><a href="http://stackoverflow.com/users/187141/yegor256" title="my StackOverflow profile"><i class="icon icon-stackoverflow"></i></a></li><li><a href="https://www.facebook.com/yegor.bugayenko" title="follow me in Facebook"><i class="icon icon-facebook"></i></a></li><li><a href="https://plus.google.com/+YegorBugayenko/posts" title="follow me in Google+"><i class="icon icon-googleplus"></i></a></li><li><a href="https://www.linkedin.com/in/yegor256" title="my LinkedIn profile"><i class="icon icon-linkedin"></i></a></li><li><a href="http://www.youtube.com/user/yegor256a" title="my Youtube video channel"><i class="icon icon-youtube"></i></a></li><li><a href="mailto:yegor@teamed.io" title="yegor@teamed.io"><i class="icon icon-mail"></i></a></li></ul><ul class="menu"><li> <a href="/best.html" title="best articles to read">12 best articles</a> (out of <a href="/contents.html" title="blog contents">68</a>) <a href="/" title="home page">home</a></li></ul> </nav><div id="search"> <input id="search-query" class="field field-text" name="q" placeholder="Search" autocomplete="off"/><div id="search-results" style="display:none"><div class="entries"></div></div></div> <script id="search-results-template" type="text/mustache">
          {{#entries}}
            <div>
              <a href="{{url}}">{{title}}</a>
            </div>
          {{/entries}}
        </script></header></div> <section itemscope itemtype="http://schema.org/BlogPosting"><div class="wrapper"><p> <time itemprop="datePublished" datetime="2014-04-09T00:00:00+00:00"> 9 April 2014 </time></p> <header><h1 itemprop="name">Xembly, an Assembly for XML</h1> </header><p><a href="/tag/xembly.html" class='tag'>xembly</a> <a href="/tag/xml.html" class='tag'>xml</a> <a href="/tag/xsl.html" class='tag'>xsl</a> <a href="/tag/xsd.html" class='tag'>xsd</a></p><div class="buttons"> <nav class="share" role="navigation"> <a href="http://www.facebook.com/sharer/sharer.php?u=http://www.yegor256.com/2014/04/09/xembly-intro.html" title="Share on Facebook" class="button"> <span class="count count-facebook">0</span> <i class="icon icon-facebook"></i> </a> <a href="https://twitter.com/share?url=http://www.yegor256.com/2014/04/09/xembly-intro.html&amp;text=Xembly%2C+an+Assembly+for+XML" title="Share on Twitter" class="button"> <span class="count count-twitter">0</span> <i class="icon icon-twitter"></i> </a> <a href="https://plus.google.com/share?url=http://www.yegor256.com/2014/04/09/xembly-intro.html" title="Share on Google+" class="button"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus"></i> </a> <a href="https://www.linkedin.com/cws/share?url=http://www.yegor256.com/2014/04/09/xembly-intro.html" title="Share on LinkedIn" class="button"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin"></i> </a> <a href="http://www.stumbleupon.com/submit?url=http://www.yegor256.com/2014/04/09/xembly-intro.html&amp;title=Xembly, an Assembly for XML" title="Share on StumbleUpon" class="button"> <span class="count count-stumbleupon">0</span> <i class="icon icon-stumbleupon"></i> </a> <a href="http://del.icio.us/post?url=http://www.yegor256.com/2014/04/09/xembly-intro.html&amp;title=Xembly, an Assembly for XML" title="Share on Delicious" class="button"> <span class="count count-delicious">0</span> <i class="icon icon-delicious"></i> </a> <a href="http://digg.com/submit?phase=2&amp;url=http://www.yegor256.com/2014/04/09/xembly-intro.html&amp;title=Xembly, an Assembly for XML" title="Share on Digg" class="button"> <span class="count count-digg">0</span> <i class="icon icon-digg"></i> </a> <a href="http://reddit.com/submit?url=http://www.yegor256.com/2014/04/09/xembly-intro.html&amp;title=Xembly, an Assembly for XML" title="Share on Reddit" class="button"> <span class="count count-reddit">0</span> <i class="icon icon-reddit"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=http://www.yegor256.com/2014/04/09/xembly-intro.html&amp;t=Xembly, an Assembly for XML" title="Share on Hacker News" class="button"> <i class="icon icon-hackernews"></i> </a> </nav></div> <main role="main"> <article class="main" role="article" itemprop="articleBody"> <figure class='badge'><a href='http://www.xembly.org'><img src='http://img.xembly.org/logo-256x256.png' style='width:64px' alt='badge'/></a></figure><p>I use XML in almost every one of my projects. And, despite all the fuss about JSON/YAML, I honestly believe that XML is one of the greatest languages ever invented. Also, I believe that the beauty of XML reveals itself when used in combination with related technologies.</p><p>For example, you can expose your data in XML and render it for the end-user using <a href="http://www.w3.org/Style/XSL/">XSL stylesheet</a>.</p><p>Another example would be when you validate the same data, before rendering, to ensure that the structure is correct. You can do this with the <a href="http://www.w3.org/TR/xmlschema11-1/">XSD</a> schema. Alternatively, you can pick specific data elements from the entire document by using <a href="http://www.w3.org/TR/xpath/">XPath</a> queries.</p><p>Essentially, these three technologies, XSL, XSD schema and XPath, are what makes XML so powerful.</p><p>However, there can be times when XML falls short. For instance, imagine you have an existing document that needs to be modified just slightly. For example, let's use the following:</p><div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;accounts&gt;</span>
  [...]
  <span class="nt">&lt;acc</span> <span class="na">id=</span><span class="s">'34'</span><span class="nt">&gt;</span>
    <span class="nt">&lt;name&gt;</span>Jeffrey<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;balance&gt;</span>305<span class="nt">&lt;/balance&gt;</span>
  <span class="nt">&lt;/acc&gt;</span>
  <span class="nt">&lt;acc</span> <span class="na">id=</span><span class="s">'35'</span><span class="nt">&gt;</span>
    <span class="nt">&lt;name&gt;</span>Walter<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;balance&gt;</span>50090<span class="nt">&lt;/balance&gt;</span>
  <span class="nt">&lt;/acc&gt;</span>
  [...]
<span class="nt">&lt;/accounts&gt;</span></code></pre></div><p>The above code represents a list of accounts. Each account has its own <code>id</code> and several child elements. In our example, we need to find the account belonging to <code>Jeffrey</code> and increase its balance by <code>500</code>. How would we do this?</p><p>Well, there are a few possible solutions:</p><ul><li>SAX-parse the document, change the balance and save the stream;</li><li>DOM-parse it, find the element with XPath, change the value and then print it;</li><li>apply a parametrized XSL stylesheet;</li><li>apply XQuery small script to make changes</li></ul><p>All of these methods have their own drawbacks. However, all of them have one particular problem in common — they are very verbose. With each of the above methods, you need at least a page of code to perform this rather simple operation. Furthermore, if the logic of the operation becomes more complex, the amount of needed code grows much faster than you may expect.</p><p>Simply put, XML lacks a tool for primitive data manipulations within a document. Perhaps, it is this shortcoming that makes XML unpopular with some.</p><p>Anyway, here is a tool I created a few month ago: <a href="http://www.xembly.org">Xembly</a>. It is an imperative language with a few simple directives and resembles <a href="http://en.wikipedia.org/wiki/Assembly_language">Assembly</a> in style. Thus, the name - Xembly. With Xembly, there are no loops, conditions or variables - just a sequence of directives with arguments.</p><p>Let's create a simple example. Say, for instance, we want to add a new account number <code>36</code> to our list document. The code would look like:</p><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-asm" data-lang="asm">1
2
3
4
5
6
7
8</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="nf">XPATH</span> <span class="err">'/</span><span class="no">accounts</span><span class="err">';</span>
<span class="nf">ADD</span> <span class="err">'</span><span class="no">account</span><span class="err">';</span>
<span class="nf">ATTR</span> <span class="err">'</span><span class="no">id</span><span class="err">'</span><span class="p">,</span> <span class="err">'</span><span class="mi">36</span><span class="err">';</span>
<span class="nf">ADD</span> <span class="err">'</span><span class="no">name</span><span class="err">';</span>
<span class="nf">SET</span> <span class="err">'</span><span class="no">Donny</span><span class="err">';</span>
<span class="nf">UP</span><span class="err">;</span>
<span class="nf">ADD</span> <span class="err">'</span><span class="no">balance</span><span class="err">';</span>
<span class="nf">SET</span> <span class="err">'</span><span class="mi">3400</span><span class="err">';</span></pre></div></td></tr></table><p>The above should be intuitively clear, but I'll explain just in case. First, the <code>XPATH</code> directive points us to the element found by the "/accounts" XPath query. This will be our root element. We assume here that it exists in the document. Therefore, if it is absent, our Xembly script will fail with a runtime exception.</p><p>Next, the <code>ADD</code> directive on line 2 creates a new XML element without any children or attributes. Then, the <code>ATTR</code> directive sets an attribute for this element. The code then adds the new child element <code>name</code> and sets its text value to <code>"Donny"</code> using the <code>SET</code> directive. Finally, we move our pointer back to <code>account</code> element using <code>UP</code>, add the <code>balance</code> child element and set its value to <code>"3400"</code>.</p><p>Our balance changing task can be expressed in Xembly with the following code:</p><div class="highlight"><pre><code class="language-asm" data-lang="asm"><span class="nf">XPATH</span> <span class="err">'/</span><span class="no">accounts</span><span class="err">/</span><span class="no">account</span><span class="err">[</span><span class="no">name</span><span class="err">="</span><span class="no">Jeffrey</span><span class="err">"]/</span><span class="no">balance</span><span class="err">';</span>
<span class="nf">XSET</span> <span class="err">'</span><span class="p">.</span> <span class="err">+</span> <span class="mi">500</span><span class="err">';</span></code></pre></div><p>The <code>XSET</code> directive sets the element text value, similar to <code>SET</code>, but calculates it beforehand using the provided XPath expression <code>. + 500</code>.</p><p>Xembly performs all manipulations through DOM. Consequently, Xembly can be implemented inside any language that has a built-in DOM implementation.</p><p>In the meantime, there is only one implementation of Xembly language — in Java. Here is how it works:</p><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><code class="language-java" data-lang="java">1
2
3
4
5
6
7</code></pre></div></td><td class="code"><div class="highlight"><pre><span class="n">Iterable</span><span class="o">&lt;</span><span class="n">Directive</span><span class="o">&gt;</span> <span class="n">directives</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Directives</span><span class="o">()</span>
  <span class="o">.</span><span class="na">xpath</span><span class="o">(</span><span class="s">"/accounts"</span><span class="o">)</span>
  <span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"account"</span><span class="o">)</span>
  <span class="o">.</span><span class="na">attr</span><span class="o">(</span><span class="s">"id"</span><span class="o">,</span> <span class="s">"36"</span><span class="o">)</span>
  <span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"name"</span><span class="o">).</span><span class="na">set</span><span class="o">(</span><span class="s">"Donny"</span><span class="o">).</span><span class="na">up</span><span class="o">()</span>
  <span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"balance"</span><span class="o">).</span><span class="na">set</span><span class="o">(</span><span class="s">"3400"</span><span class="o">);</span>
<span class="k">new</span> <span class="nf">Xembler</span><span class="o">(</span><span class="n">directives</span><span class="o">).</span><span class="na">apply</span><span class="o">(</span><span class="n">document</span><span class="o">);</span></pre></div></td></tr></table><p>In this snippet, I'm using a supplementary script builder, <code>Directives</code>, which enables generation of directives in a fluent way. Then, I use <code>Xembler</code> class, which is similar to "assembler", to apply all specified directives to the <code>document</code> object of class <code>org.w3c.dom.Document</code>.</p><p>Additionally, Xembly can be used to build XML documents from scratch and as a replacement for traditional DOM building. A quick example:</p><div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span>
  <span class="k">new</span> <span class="nf">Xembler</span><span class="o">(</span>
    <span class="k">new</span> <span class="nf">Directives</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="s">"html"</span><span class="o">)</span>
      <span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"head"</span><span class="o">)</span>
      <span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"title"</span><span class="o">)</span>
      <span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">"Hello, world!"</span><span class="o">)</span>
  <span class="o">).</span><span class="na">xml</span><span class="o">()</span>
<span class="o">);</span></code></pre></div><p>The above snippet produces the following output:</p><div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span>Hello, world!<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></div><p>For me, this appears to be more simple and compact.</p><p>As usual, your bug reports and suggestions are always welcomed. Please send to <a href="https://github.com/yegor256/xembly/issues">Github issues</a> :)</p></article><p> Discuss it at: <a href="http://www.reddit.com/r/java/comments/22wsng/xembly_an_assembly_for_xml_java_implementation/">reddit</a></p> </main><h2>Related Posts</h2><p>You may also find these posts interesting:</p><ul><li><a href="/2014/09/09/restful-web-sites.html">RESTful API and a Web Site in the Same URL</a></li><li><a href="/2014/04/28/xml-xpath-hamcrest-matchers.html">XML/XPath Matchers for Hamcrest</a></li><li><a href="/2014/04/24/java-xml-parsing-and-traversing.html">Java XML Parsing Made Easy</a></li></ul></div><div class="disqus" role="complementary"><div id="disqus_thread"></div> <noscript> Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript> <a href="http://disqus.com" class="dsq-brlink"> comments powered by <span class="logo-disqus">Disqus</span> </a></div><div class="wrapper"> <footer class="footer"><p> © <span itemprop="author">Yegor Bugayenko</span>, 2014</p> </footer></div></section><script src="//code.jquery.com/jquery-2.1.0.min.js"></script><script src="/js/search.min.js?63eeb2e"></script><script src="/js/all.js?63eeb2e"></script></body></html>