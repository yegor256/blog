<!DOCTYPE html>
<html amp lang="en">
  <head>

    <meta charset="utf-8">
    <title>Object-Oriented DynamoDB API</title>
    <link rel="canonical" href="http://www.yegor256.com/2014/04/14/jcabi-dynamo-java-api-of-aws-dynamodb.html">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "mainEntityOfPage":{
          "@type": "WebPage",
          "@id": "http://www.yegor256.com/2014/04/14/jcabi-dynamo-java-api-of-aws-dynamodb.html"
        },
        "headline": "Object-Oriented DynamoDB API",
        "image": {
          "@type": "ImageObject",
          "url": "http://www.yegor256.com/images/face-1400x1400.jpg",
          "height": 1400,
          "width": 1400
        },
        "datePublished": "2014-04-14",
        "dateModified": "2014-04-14",
        "author": {
          "@type": "Person",
          "name": "Yegor Bugayenko"
        },
        "publisher": {
          "@type": "Organization",
          "name": "yegor256.com",
          "logo": {
            "@type": "ImageObject",
            "url": "http://www.yegor256.com/images/face-512x512.jpg",
            "width": 512,
            "height": 512
          }
        },
        "description": "I created jcabi-dynamo a few months ago to make AWS SDK more object oriented;
the article explains why jcabi-dynamo is better than bare Amazon SDK
",
        "keywords": ["dynamodb", "dynamodb java", "java dynamodb example", "java dynamodb query", "java dynamodb client", "java dynamodb query example"]
      }
    </script>
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style>
<noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400,500">
    <style amp-custom="amp-custom">
      @font-face {
        font-family: 'Cambria';
        src: url('http://www.yegor256.com/fonts/cambria/2EAA54_2_0.ttf');
      }
      body { font-family: 'Cambria', 'Times New Roman', serif; padding: .5em; font-size: 1.2em; }
      article { width: 600px; max-width: 100%; margin-left: auto; margin-right: auto; }
      pre, code { font-family: 'Source Code Pro', 'Courier New', monospace; font-size: .8em; }
      code { padding: 0 .3em; background-color: lightgray; }
      a, a:hover, a:visited { color: inherit; }
      .intro { color: red; font-size: .75em; }
      .photo { border-radius: 50%; }
      pre { overflow-x:scroll; }
    </style>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
  </head>
  <body>
    <article>
      <p class="intro">
        This is a mobile version, full one is
        <a href="http://www.yegor256.com/2014/04/14/jcabi-dynamo-java-api-of-aws-dynamodb.html">here</a>.
      </p>
      <p>
        <amp-img src="/images/yegor-bugayenko-192x192.png" width="80" height="80" alt="Yegor Bugayenko" class="photo"></amp-img>
      </p>
      <p>Yegor Bugayenko<br>14 April 2014</p>
      <h1>Object-Oriented DynamoDB API</h1>
      

<p>I'm a big fan of cloud computing in general and of
<a href="http://aws.amazon.com/">Amazon Web Services</a> in particular. I honestly believe that in a
few years big providers will host all, or almost all, computing and storage
resources. When this is the case, we won't have to worry too much anymore about
downtime, backups and system administrators.
<a href="http://aws.amazon.com/dynamodb/">DynamoDB</a> is one of the steps towards this
future.</p>

<blockquote class="twitter-tweet" lang="en">
<p>This looks cool - jcabi-dynamo - a <a href="https://twitter.com/search?q=%23Java&amp;src=hash">#Java</a> Object layer atop the <a href="https://twitter.com/search?q=%23DynamoDB&amp;src=hash">#DynamoDB</a> SDK - <a href="http://t.co/khRFR2joKX">http://t.co/khRFR2joKX</a> <a href="https://twitter.com/search?q=%23aws&amp;src=hash">#aws</a></p>—Jeff Barr (@jeffbarr) <a href="https://twitter.com/jeffbarr/statuses/380813867971915777">September 19, 2013</a>
</blockquote>





<p>DynamoDB is a <a href="http://en.wikipedia.org/wiki/NoSQL">NoSQL</a> database accessible
through <a href="http://en.wikipedia.org/wiki/Representational_state_transfer">RESTful</a>
JSON API. Its design is relatively simple. There are tables, which basically
are collections of data structures, or in AWS terminology, "items."</p>

<p>Every item has a mandatory "hash," an optional "range" and a number of other
optional attributes. For instance, take the example table <code>depts</code>:</p>

<pre>+------+--------+---------------------------+
| dept | worker | Attributes                |
+------+--------+---------------------------+
| 205  | Jeff   | job="manager", sex="male" |
| 205  | Bob    | age=43, city="Chicago"    |
| 398  | Alice  | age=27, job="architect"   |
+------+--------+---------------------------+</pre>

<p>For Java, Amazon provides an
<a href="https://aws.amazon.com/documentation/sdkforjava/">SDK</a>, which mirrors all
RESTful calls to Java methods. The SDK works fine, but is designed in a pure
<a href="http://en.wikipedia.org/wiki/Procedural_programming">procedural</a> style.</p>

<p>Let's say we want to add a new item to the table above. RESTful call
<a href="http://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_PutItem.html"><code>putItem</code></a>
looks like (in essence):</p>

<pre>putItem:
  tableName: depts
  item:
    dept: 435
    worker: "William"
    job: "programmer"</pre>

<p>This is what the Amazon server needs to know in order to create a new item in
the table. This is how you're supposed to make this call through the AWS Java
SDK:</p>

<pre>PutItemRequest request = new PutItemRequest();
request.setTableName("depts");
Map&lt;String, AttributeValue&gt; attributes = new HashMap&lt;&gt;();
attributes.put("dept", new AttributeValue(435));
attributes.put("worker", new AttributeValue("William"));
attributes.put("job", new AttributeValue("programmer));
request.setItem(attributes);
AmazonDynamoDB aws = // instantiate it with credentials
try {
  aws.putItem(request);
} finally {
  aws.shutdown();
}</pre>

<p>The above script works fine, but there is one major drawback—it is not
object oriented. It is a perfect example of an imperative <a href="http://en.wikipedia.org/wiki/Procedural_programming">procedural
programming</a>.</p>

<p>To allow you to compare, let me show what I've done with
<a href="http://dynamo.jcabi.com">jcabi-dynamo</a>. Here is my code, which does exactly the
same thing, but in an
<a href="http://en.wikipedia.org/wiki/Object-oriented_programming">object-oriented</a> way:</p>

<pre>Region region = // instantiate it with credentials
Table table = region.table("depts");
Item item = table.put(
  new Attributes()
    .with("dept", 435)
    .with("worker", "William")
    .with("job", "programmer")
);</pre>

<p>My code is not only shorter, but it also employs
<a href="/2016/11/21/naked-data.html">encapsulation</a> and separates
responsibilities of classes.
<a href="http://dynamo.jcabi.com/apidocs-0.10/com/jcabi/dynamo/Table.html"><code>Table</code></a>
class (actually it is an interface internally implemented by a class)
encapsulates information about the table, while
<a href="http://dynamo.jcabi.com/apidocs-0.10/com/jcabi/dynamo/Item.html"><code>Item</code></a>
encapsulates item details.</p>

<p>We can pass an <code>item</code> as an argument to another method and all DynamoDB related
implementation details will be hidden from it. For example, somewhere later in
the code:</p>

<pre>void sayHello(Item item) {
  System.out.println("Hello, " + item.get("worker"));
}</pre>

<p>In this script, we don't know anything about DynamoDB or how to deal with its
RESTful API. We interact solely with an instance of
<a href="http://dynamo.jcabi.com/apidocs-0.10/com/jcabi/dynamo/Item.html"><code>Item</code></a> class.</p>

<p>By the way, all public entities in <a href="http://dynamo.jcabi.com">jcabi-dynamo</a> are
Java interfaces. Thanks to that, you can test and mock the library completely
(but I would recommend to use
<a href="/2014/05/01/dynamodb-local-maven-plugin.html">DynamoDB Local</a>
and create integration tests).</p>

<p>Let's consider a more complex example, which would take a page of code if we
were to use a bare AWS SDK. Let's say that we want to remove all workers from
our table who work as architects:</p>

<pre>Region region = // instantiate it with credentials
Iterator&lt;Item&gt; workers = region.table("depts").frame()
  .where("job", Condition.equalTo("architect"));
while (workers.hasNext()) {
  workers.remove();
}</pre>

<p><a href="http://dynamo.jcabi.com">jcabi-dynamo</a> has saved a lot of code lines in a few
of my projects. You can see it in action at
<a href="https://github.com/rultor/rultor/tree/rultor-0.2/rultor-users/src/main/java/com/rultor/users">rultor-users</a>.</p>

<p>The library ships as a JAR dependency in <a href="http://repo1.maven.org/maven2/com/jcabi/jcabi-dynamo">Maven
Central</a>
(get its latest versions from <a href="http://search.maven.org/">Maven Central</a>):</p>

<pre>&lt;dependency&gt;
  &lt;groupId&gt;com.jcabi&lt;/groupId&gt;
  &lt;artifactId&gt;jcabi-dynamo&lt;/artifactId&gt;
&lt;/dependency&gt;</pre>

    </article>
  </body>
</html>
