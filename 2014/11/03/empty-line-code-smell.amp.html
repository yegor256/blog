<!DOCTYPE html>
<html amp lang="en">
  <head>

    <meta charset="utf-8">
    <title>An Empty Line is a Code Smell</title>
    <link rel="canonical" href="http://www.yegor256.com/2014/11/03/empty-line-code-smell.html">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "mainEntityOfPage":{
          "@type": "WebPage",
          "@id": "http://www.yegor256.com/2014/11/03/empty-line-code-smell.html"
        },
        "headline": "An Empty Line is a Code Smell",
        "image": {
          "@type": "ImageObject",
          "url": "http://www.yegor256.com/images/face-1400x1400.jpg",
          "height": 1400,
          "width": 1400
        },
        "datePublished": "2014-11-03",
        "dateModified": "2014-11-03",
        "author": {
          "@type": "Person",
          "name": "Yegor Bugayenko"
        },
        "publisher": {
          "@type": "Organization",
          "name": "yegor256.com",
          "logo": {
            "@type": "ImageObject",
            "url": "http://www.yegor256.com/images/face-512x512.jpg",
            "width": 512,
            "height": 512
          }
        },
        "description": "An empty line inside your method body is an indicator
of a lack of cohesion in its design and a good motivator
for immediate refactoring.
",
        "keywords": ["empty line in method body", "empty line is evil", "empty line in function body", "empty line is bad", "avoid empty lines in method body"]
      }
    </script>
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style>
<noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <style amp-custom="amp-custom">
      body { padding: .5em; font-size: 1.2em; }
      article { width: 600px; max-width: 100%; margin-left: auto; margin-right: auto; }
      .intro { color: red; font-size: .75em; }
      .photo { border-radius: 50%; }
      pre { overflow-x:scroll; }
    </style>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
  </head>
  <body>
    <article>
      <p class="intro">
        This is a mobile version of the article,
        its original content can be found
        <a href="http://www.yegor256.com/2014/11/03/empty-line-code-smell.html">here</a>.
      </p>
      <p>
        <amp-img src="/images/yegor-bugayenko-192x192.png" width="80px" height="80px" alt="Yegor Bugayenko" class="photo"></amp-img>
      </p>
      <p>Yegor Bugayenko<br>3 November 2014</p>
      <h1>An Empty Line is a Code Smell</h1>
      <p>The subject may sound like a joke, but it is not. An empty line,
used as a separator of instructions in an object method, is a
<a href="https://en.wikipedia.org/wiki/Code_smell">code smell</a>.
Why? In short, because a method should <strong>not</strong> contain "parts." A method
should always <a href="https://en.wikipedia.org/wiki/Single_responsibility_principle">do one thing</a>
and its functional decomposition should be done by language constructs
(for example, new methods), and <strong>never</strong> by empty lines.</p>



<p>Look at this Java class (it does smell, doesn't it?):</p>

<pre>final class TextFile {
  private final File file;
  TextFile(File src) {
    this.file = src;
  }
  public int grep(Pattern regex) throws IOException {
    Collection&lt;String&gt; lines = new LinkedList&lt;&gt;();
    try (BufferedReader reader =
      new BufferedReader(new FileReader(this.file))) {
      while (true) {
        String line = reader.readLine();
        if (line == null) {
          break;
        }
        lines.add(line);
      }
    }

    int total = 0;
    for (String line : lines) {
      if (regex.matcher(line).matches()) {
        ++total;
      }
    }
    return total;
  }
}</pre>

<p>This method first loads the content of the file. Second, it
counts how many lines match the regular expression provided. So why does
method <code>grep</code> smell? Because it does two things instead of oneâ€”it loads and it greps.</p>

<p>If we make a rule, to avoid empty lines in method bodies, the method
will have to be refactored in order to preserve the "separation of concerns"
introduced by that empty line:</p>

<pre>final class TextFile {
  private final File file;
  TextFile(File src) {
    this.file = src;
  }
  public int grep(Pattern regex) throws IOException {
    return this.count(this.lines(), regex);
  }
  private int count(Iterable&lt;String&gt; lines, Pattern regex) {
    int total = 0;
    for (String line : lines) {
      if (regex.matcher(line).matches()) {
        ++total;
      }
    }
    return total;
  }
  private Iterable&lt;String&gt; lines() throws IOException {
    Collection&lt;String&gt; lines = new LinkedList&lt;&gt;();
    try (BufferedReader reader =
      new BufferedReader(new FileReader(this.file))) {
      while (true) {
        String line = reader.readLine();
        if (line == null) {
          break;
        }
        lines.add(line);
      }
      return lines;
    }
  }
}</pre>

<p>I believe it is obvious that this new class has methods that are
much more cohesive and readable. Now every method is doing exactly
one thing, and it's easy to understand which thing it is.</p>

<p>This idea about avoiding empty lines is also applicable to other languages,
not just Java/C++/Ruby, etc. For example, this CSS code is
definitely begging for refactoring:</p>

<pre>.container {
  width: 80%;
  margin-left: auto;
  margin-right: auto;

  font-size: 2em;
  font-weight: bold;
}</pre>

<p>The empty line here is telling us (screaming at us, actually) that this <code>.container</code>
class is too complex and has to be decomposed into two classes:</p>

<pre>.wide {
  width: 80%;
  margin-left: auto;
  margin-right: auto;
}
.important {
  font-size: 2em;
  font-weight: bold;
}</pre>

<p>Unfortunately, using empty lines to separate blocks of code is a very common habit.
Moreover, very often I see empty blocks of two or even three lines, which are all
playing this evil role of a separator of concerns.</p>

<p>Needless to say, a properly designed class must have just a few public
methods and a properly designed method must have up to ten instructions
(according to Bob Martin).
Empty lines inside methods encourage us to break this awesome rule and
turn them into multi-page poems.</p>

<p>Of course, it's easier to just click <code>enter</code> a few times and continue to
code right in the same method, instead of thinking and refactoring first.
This laziness will eventually lead to code that is hardly maintainable
at all.</p>

<p>To prevent this from happening in your projects, stop using empty
lines inside methods, completely. Ideally, prohibit them in your automated build.
In <a href="/2014/08/13/strict-code-quality-control.html">qulice.com</a>,
a static analysis tool we're using in all Java projects,
we created a custom Checkstyle check that prohibits empty lines in every
method.</p>

    </article>
  </body>
</html>
