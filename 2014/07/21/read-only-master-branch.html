<!doctypehtml><html xmlns="https://www.w3.org/1999/xhtml"lang="en-US"xml:lang="en-US"itemscope=""itemtype="http://schema.org/WebSite"><meta charset="utf-8"><meta name="description"content="Continuous integration doesn&apos;t work while programmers are able to commit into the master branch. This article explains why and proposes a solution."><meta name="keywords"content="broken builds, commits to master branch, continous delivery, continous deployment, continuous delivery preflight builds, continuous integration, continuous integration doesn&apos;t work"><meta name="viewport"content="width=device-width,minimum-scale=1,initial-scale=1"><meta name="google-site-verification"content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8"><meta name="author"content="Yegor Bugayenko"><meta name="article:published_time"content="2014-07-21 00:00:00 +0000"><meta name="yandex-verification"content="7d2a0afee14d72bc"><meta name="og:site_name"content="Yegor Bugayenko"><meta name="og:type"content="article"><meta name="og:locale"content="en_US"><meta name="twitter:account_id"content="4503599630178231"><meta name="twitter:creator"content="@yegor256"><meta name="twitter:site"content="@yegor256"><meta name="twitter:title"property="og:title"content="Master Branch Must Be Read-Only"><meta name="twitter:description"property="og:description"content="Continuous integration doesn&apos;t work while programmers are able to commit into the master branch. This article explains why and proposes a solution."><meta name="twitter:url"property="og:url"content="https://www.yegor256.com/2014/07/21/read-only-master-branch.html"><meta name="telegram:channel"content="AAAAAEJFMRzsRTRxM3ec6A"><link rel="search"type="application/opensearchdescription+xml"href="/opensearch.xml"title="yegor256"><link rel="icon"href="/favicon.ico?96f99ee"type="image/x-icon"><link rel="shortcut icon"href="/favicon.ico?96f99ee"><link rel="apple-touch-icon"href="/favicon.ico?96f99ee"><link rel="alternate"type="application/rss+xml"title="RSS for yegor256.com"href="https://www.yegor256.com/rss.xml"><link rel="stylesheet"href="/css/layout.css?96f99ee"><link rel="stylesheet"href="/css/icons.css?96f99ee"><link rel="canonical"href="https://www.yegor256.com/2014/07/21/read-only-master-branch.html"><title>Master Branch Must Be Read-Only</title><div class="wrapper"><aside class="header-toggle unprintable"id="header-toggle"title="Show the menu"onclick='$("#header").show(),$("#header-toggle").hide()'>&#9776;</aside><header class="header"id="header"><div class="face"><a href="/about-me.html#form"class="sub"title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html"style="position:relative"><img src="/images/face-256x256.jpg"class="photo"alt="Yegor Bugayenko"></a></div><nav><ul class="menu social notranslate"><li><a href="https://twitter.com/intent/follow?screen_name=yegor256"rel="nofollow"title="Follow me on Twitter"><i class="icon icon-twitter notranslate"aria-hidden="true"></i></a><li><a href="/rss.xml"rel="nofollow"title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://github.com/yegor256"rel="nofollow"title="My GitHub profile"><i class="icon icon-github notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="http://stackoverflow.com/users/187141/yegor256"rel="nofollow"title="My Stack Overflow profile"><i class="icon icon-stackoverflow notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://www.facebook.com/yegor256"rel="nofollow"title="Follow me on Facebook"><i class="icon icon-facebook notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://instagram.com/yegor256"rel="nofollow"title="Follow me on Instagram"><i class="icon icon-instagram notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://www.linkedin.com/in/yegor256"rel="nofollow"title="My LinkedIn profile"><i class="icon icon-linkedin notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://www.youtube.com/c/yegor256?sub_confirmation=1"rel="nofollow"title="My Youtube video channel"><i class="icon icon-youtube notranslate"aria-hidden="true"></i></a><li><a href="https://soundcloud.com/yegor256"rel="nofollow"title="My podcast"><i class="icon icon-podcast notranslate"aria-hidden="true"></i></a><li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721"rel="nofollow"title="My iTunes podcast"><i class="icon icon-itunes notranslate"aria-hidden="true"></i></a><li><a href="https://t.me/yegor256news"rel="nofollow"title="My Telegram public channel"><i class="icon icon-telegram notranslate"aria-hidden="true"></i></a><li><a href="mailto:blog@yegor256.com"rel="nofollow"title="Email me any time"><i class="icon icon-mail notranslate"aria-hidden="true"></i></a></ul><ul class="menu"><li><a href="/"title="Home page">Home</a><li><a href="/best.html"title="Best articles to read">12&#160;Best</a><li><a href="/contents.html"title="The contents of the entire blog">All&#160;481</a><li><a href="/teaching.html"title="My courses and lectures">Teaching</a><li><a href="/talks.html"title="Future and past conference talks">Talks</a><li><a href="/books.html"title="The books I wrote">Books</a><li><a href="/research.html"title="My research directions and progress">Research</a><li><a href="/pets.html"title="My loved pet projects">Pets</a><li><a href="/trainings.html"title="On-site trainings">Trainings</a><li><a href="https://www.iccq.ru"title="International Conference on Code Quality">ICCQ</a><li><a href="https://www.kaicode.org"title="Open Source Festival">KaiCode</a><li><a href="/testimonials.html"title="What some people say about me">Testimonials</a><li><a href="/shift-m.html"title="Audio podcast about project management">Shift-M</a><li><a href="/paintings.html"title="My paintings for sale">Art</a></ul></nav><div class="search"><form action="https://www.google.com/search"itemprop="potentialAction"itemscope=""itemtype="http://schema.org/SearchAction"><meta itemprop="target"content="https://www.google.com/search?q={q}"><input name="sitesearch"value="yegor256.com"type="hidden"> <input itemprop="query-input"id="search-query"class="field field-text"required="required"onfocus='$(".google").css("visibility","visible")'name="q"placeholder="Search..."autocomplete="off"> <input type="image"src="/images/google-search-icon.svg"class="google"title="Search via Google"alt="Search via Google"></form></div><div class="hot"><ul><li>Are you familiar with open source and have a decent GitHub portfolio of contributions? <strong>We need freelancers</strong>, working remotely and paid by result, for <a href="https://www.eolang.org">EO</a>, a new programming language. Join our Telegram group, we'll discuss: <a href="https://t.me/eolang_org">@eolang_org</a>.</ul></div></header></div><section itemscope=""itemtype="http://schema.org/BlogPosting"><div class="wrapper"><header><p class="printable"><img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2014/07/21/read-only-master-branch.html&amp;format=svg"style="width:125px;height:125px"alt="QR code"><p class="printable"><code itemprop="url">https://www.yegor256.com/140721.html</code><h1 itemprop="name headline mainEntityOfPage">Master Branch Must Be Read-Only</h1><aside class="book"><a href="https://amzn.to/2u9BbqF"><img src="/images/books/code-ahead/cover.png"class="book-cover"alt="book cover"></a>Read more about this subject in <a href="https://amzn.to/2u9BbqF">Section&nbsp;3</a><br>of my book <a href="https://amzn.to/2u9BbqF"><img src="/images/books/amazon-buy-button.png"class="amazon-button"alt="Click to buy"></a></aside><ul class="subline"><li><time itemprop="datePublished"datetime="2014-07-21T00:00:00+00:00">21 July 2014</time><li class="printable"itemscope=""itemprop="author"itemtype="http://schema.org/Person"><span itemprop="name">Yegor Bugayenko</span><li class="unprintable"><i class="icon icon-comments"></i> <a href="https://www.yegor256.com/2014/07/21/read-only-master-branch.html#disqus_thread"itemprop="discussionUrl">comments</a></ul><ul class="unprintable subline"><li title="The page is translated by ChatGPT from English to a few languages">Translated by <i class="icon icon-chatgpt notranslate"aria-hidden="true"></i> to<li title="Click to see this page translated to Chinese"><a href="https://www.yegor256.com/zh/2014/07/21/read-only-master-branch.html">中文</a><li title="Click to see this page translated to Russian"><a href="https://www.yegor256.com/ru/2014/07/21/read-only-master-branch.html">русский</a></ul><p class="unprintable"><a href="/tag/devops.html"class="tag notranslate">devops</a> <a href="/tag/rultor.html"class="tag notranslate"><img src="/images/icons/rultor-white.svg"alt="Rultor">rultor</a><nav class="buttons notranslate desktop-only"><a href="https://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2014/07/21/read-only-master-branch.html"title="Share on Facebook"class="button"rel="nofollow"><span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate"aria-hidden="true"></i> </a><a href="https://twitter.com/share?url=https://www.yegor256.com/2014/07/21/read-only-master-branch.html&amp;text=Master+Branch+Must+Be+Read-Only"title="Share on Twitter"class="button"rel="nofollow"><span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate"aria-hidden="true"></i> </a><a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2014/07/21/read-only-master-branch.html"title="Share on LinkedIn"class="button"rel="nofollow"><span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate"aria-hidden="true"></i> </a><a href="https://reddit.com/submit?url=https://www.yegor256.com/2014/07/21/read-only-master-branch.html%3F2014-29&amp;title=Master+Branch+Must+Be+Read-Only"title="Share on Reddit"class="button"rel="nofollow"><span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate"aria-hidden="true"></i> </a><a href="https://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2014/07/21/read-only-master-branch.html%3F2014-29&amp;t=Master+Branch+Must+Be+Read-Only"title="Share on Hacker News"class="button"rel="nofollow"><span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate"aria-hidden="true"></i> </a><a href="#"title="Cite it via BibTeX"class="button"onclick='return $("#bibtex").toggle(),!1'><i class="icon icon-tex notranslate"aria-hidden="true"></i></a></nav></header><article class="main"itemprop="articleBody"><div><div id="bibtex"style="display:none"><p>Please, cite this blog post via <a href="https://www.bibtex.org/">BibTeX</a> as such:<pre style="color:#053c5e">@misc&#123;bugayenko2014blog0721,
  author = &#123;Bugayenko, Yegor&#125;,
  title = &#123;&#123;Master Branch Must Be Read-Only&#125;&#125;,
  howpublished = &#123;\url&#123;https://www.yegor256.com/140721.html&#125;&#125;,
  year = &#123;2014&#125;,
  month = &#123;jul&#125;,
  note = &#123;[Online; accessed 05-10-2025]&#125;
&#125;</pre></div><p>Continuous integration is easy. Download Jenkins, install, create a job, click the button, and get a nice email saying that your build is broken (I assume your build is automated). Then, fix broken tests (I assume you have tests), and get a much better looking email saying that your build is clean.<p>Then, tweet about it, claiming that your team is using <a href="/2014/10/08/continuous-integration-is-dead.html">continuous integration</a>.<p>Then, in a few weeks, start filtering out Jenkins alerts, into their own folder, so that they don’t bother you anymore. Anyway, your team doesn’t have the time or desire to fix all unit tests every time someone breaks them.<p>After all, we all know that unit testing is not for a team working with deadlines, right?<p>Wrong. Continuous integration can and must work.<h2 id="what-is-continuous-integration">What is Continuous Integration?</h2><p>Nowadays, software development is done in teams. We develop in feature branches and isolate changes while they are in development. Then, we merge branches into <code class="language-plaintext highlighter-rouge">master</code>. After every merge, we test the entire product, executing all available unit and integration tests. This is called <a href="https://en.wikipedia.org/wiki/Continuous_integration">continuous integration</a> (aka “CI”).<aside class="youtube"><a href="https://www.youtube.com/watch?v=2a2nWELIk-Y"><div class="box"><img src="https://i.ytimg.com/vi/2a2nWELIk-Y/mqdefault.jpg"alt="YouTube video #2a2nWELIk-Y"><div class="play"><i class="icon icon-play"></i></div></div></a><div>Yegor Bugayenko | Kyiv DevOps, September, 2015; 6 October 2015.</div></aside><p>Sometimes, some tests fail. When this happens, we say that our “build is broken.” Such a failure is a positive side effect of quality control because it raises a red flag immediately after an error gets into <code class="language-plaintext highlighter-rouge">master</code>.<p>It is a well-known practice, when fixing that error becomes a top priority for its author and the entire team. The error should be fixed right after a red flag is raised by the <a href="/2014/10/08/continuous-integration-is-dead.html">continuous integration</a> server.<figure class="badge"><a href="https://amzn.to/2bQVmlb"><img src="/images/2014/07/continuous-delivery-book.png"style="width:100px;max-width:100%"alt="badge"></a></figure><p><a href="https://amzn.to/2bQVmlb">Continuous Delivery by Jez Humble et. al.</a> explains this approach perfectly in Chapter 7, pages 169–186.<p>There are a few good tools on the market, which automate DevOps procedures. Some of them are open source, you can download and install them on your own servers. For example: <a href="https://jenkins-ci.org/">Jenkins</a>, <a href="https://www.thoughtworks.com/products/go-continuous-delivery">Go</a>, and <a href="https://cruisecontrol.sourceforge.net/">CruiseControl</a>. Some of them are available as a service in cloud, such as: <a href="https://www.travis-ci.org">Travis</a>, <a href="https://www.shippable.com">Shippable</a>, Wercker, and <a href="/2014/10/05/ten-hosted-continuous-integration-services.html">many others</a>.<h2 id="why-continuous-integration-doesnt-work">Why Continuous Integration Doesn’t Work?</h2><p>CI is great, but the bigger the team (and the code base), the more often builds get broken. And, the longer it takes to fix them. I’ve seen many examples where a hard working team starts to ignore red flags, raised by Jenkins, after a few weeks or trying to keep up.<aside class="quote">Product owners do not understand the importance of a “clean build” and devs can’t buy time for fixing unit tests</aside><p>The team simply becomes incapable of fixing all errors in time. Mostly because the business has other priorities. Product owners do not understand the importance of a “clean build” and technical leaders can’t buy time for fixing unit tests. Moreover, the code that broke them was already in <code class="language-plaintext highlighter-rouge">master</code> and, in most cases, has been already deployed to production and delivered to end-users. What’s the urgency of fixing some tests if business value was already delivered?<aside class="youtube"><a href="https://www.youtube.com/watch?v=gL4XwP-EBOg"><div class="box"><img src="https://i.ytimg.com/vi/gL4XwP-EBOg/mqdefault.jpg"alt="YouTube video #gL4XwP-EBOg"><div class="play"><i class="icon icon-play"></i></div></div></a><div>Continuous Integration May Have Negative Effects; 20 April 2016.</div></aside><p>In the end, most development teams don’t take continuous integration alerts seriously. Jenkins or Travis are just fancy tools for them that play no role in the entire development and delivery pipeline. No matter what continuous integration server says, we still deliver new features to our end-users. We’ll fix our build later. And <a href="/2014/10/08/continuous-integration-is-dead.html">it’s only logical</a>.<h2 id="what-is-a-solution">What Is a Solution?</h2><p><a href="/pdf/2014/guard-article.pdf"class="em2"title="Prevent Conflicts in Distributed Agile PHP Projects"><i class="icon icon-pdf"></i></a><p>Four years ago, in 2010, I published an article in <a href="https://www.phparch.com/magazine/2010-2/august/">php|Architect</a> called “Prevent Conflicts in Distributed Agile PHP Projects.” In the article, a solution was proposed (full article in <a href="/pdf/2014/guard-article.pdf">PDF</a>) for Subversion and PHP.<p>Since that time, I used experimentally that approach in multiple <a href="/2015/12/22/why-dont-you-contribute-to-open-source.html">open source</a> projects and a few commercial ones with PHP, Java, Ruby and JavaScript, Git and Subversion. In all cases, my experience was only positive, and that’s why <a href="https://www.rultor.com">rultor.com</a> was born (later about that though).<p>So, the solution is simple—prohibit anyone from merging anything into <code class="language-plaintext highlighter-rouge">master</code> and create a script that anyone can call. The script will merge, test, and commit. The script will not make any exceptions. If any branch is breaking at even one unit test, the entire branch will be rejected.<p>In other words, we should raise that red flag <strong>before</strong> the code gets into <code class="language-plaintext highlighter-rouge">master</code>. We should put the blame for broken tests on the shoulders of its author.<p>Say, I’m developing a feature in my own branch. I finished the development and broke a few tests, accidentally. It happens, we all make mistakes. I can’t merge my changes into <code class="language-plaintext highlighter-rouge">master</code>. Git simply rejects my <code class="language-plaintext highlighter-rouge">push</code>, because I don’t have the appropriate permissions. All I can do is call a magic script, asking it to merge my branch. The script will try to merge, but before pushing into <code class="language-plaintext highlighter-rouge">master</code>, it will run all tests. And if any of them break, my branch will be rejected. My changes won’t be merged. Now it’s my responsibility—to fix them and call the script again.<p>In the beginning, this approach slows down the development, because everybody has to start writing cleaner code. At the end, though, this method pays off big time.<h2 id="pre-flight-builds">Pre-flight Builds</h2><p>Some CI servers offer pre-flight builds feature, which means testing branches before they get merged into <code class="language-plaintext highlighter-rouge">master</code>. Travis, for example, has this feature and it is very helpful. When you make a new commit to a branch, Travis immediately tries to build it, and reports in GitHub pull request, if there are problems.<aside class="youtube"><a href="https://www.youtube.com/watch?v=Ht0JI41kA4I"><div class="box"><img src="https://i.ytimg.com/vi/Ht0JI41kA4I/mqdefault.jpg"alt="YouTube video #Ht0JI41kA4I"><div class="play"><i class="icon icon-play"></i></div></div></a><div>Pre-flight Build Pitfalls; 10 May 2016.</div></aside><p>Pay attention, pre-flight builds don’t merge. They just check whether your individual branch is clean. After merge, it can easily break <code class="language-plaintext highlighter-rouge">master</code>. And, of course, this mechanism doesn’t guarantee that no collaborators can commit directly to <code class="language-plaintext highlighter-rouge">master</code>, breaking it accidentally. Pre-flight builds are a preventive measure, but do not solve the problem entirely.<h2 id="rultorcom">Rultor.com</h2><p>In order to start working as explained above, all you have to do is to revoke write permissions to <code class="language-plaintext highlighter-rouge">master</code> branch (or <code class="language-plaintext highlighter-rouge">/trunk</code>, in Subversion).<p>Unfortunately, this is <a href="http://stackoverflow.com/questions/10381672">not possible</a> in GitHub. The only solution is to work through forks and pull requests only. Simply remove everybody from the list of “collaborators” and they will have to submit changes through pull requests.<figure class="badge"><a href="https://www.rultor.com"><img src="https://doc.rultor.com/images/logo.svg"style="width:100px;max-width:100%"alt="badge"></a></figure><p>Then, start using <a href="https://www.rultor.com">Rultor.com</a>, which will help you to test, merge and push every pull request. Basically, Rultor is the script we were talking about above. It is available as a free cloud service.<p>ps. A short version of this article is also published at <a href="http://devops.com/blogs/continuous-integration-doesnt-work/">devops.com</a><blockquote class="twitter-tweet"data-lang="en"><p lang="en"dir="ltr">Are you allowed to PUSH to the master/develop/trunk of your Version Control System (VCS)? <a href="https://twitter.com/hashtag/devops?src=hash&amp;ref_src=twsrc%5Etfw">#devops</a></p>&mdash; Yegor Bugayenko (@yegor256) <a href="https://twitter.com/yegor256/status/1142730754167889920?ref_src=twsrc%5Etfw">June 23, 2019</a></blockquote><script async=""src="https://platform.twitter.com/widgets.js"charset="utf-8"></script></div></article></div><div class="disqus"role="complementary"aria-hidden="true"><p class="disqus_hint">Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.<div id="disqus_thread"class="disqus-thread"><a>&nbsp;</a></div><script>var disqus_config=function(){this.page.url=document.location.href.split("?")[0].split("#")[0],this.page.identifier=this.page.url};(()=>{var e=document,t=e.createElement("script");t.src="//yegor256.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript><div><p class="red">JavaScript is disabled in your browser, that's why you can't see comments under this post.</div></noscript></div><div class="wrapper"><footer class="footer"><p>&copy; <span itemscope=""itemprop="copyrightHolder"itemtype="http://schema.org/Person"><span itemprop="name">Yegor Bugayenko</span> </span>, 2014&ndash;<span itemprop="copyrightYear">2025</span></footer></div></section><div class="wrapper unprintable"style="text-align:center;margin-top:2em"><a href="https://www.sixnines.io/h/3ba1652f"><img src="https://www.sixnines.io/b/3ba1652f?style=flat"alt="sixnines availability badge"></a>&nbsp; <a href="https://github.com/yegor256/blog/stargazers"><img src="https://img.shields.io/github/stars/yegor256/blog.svg?style=flat-square"alt="GitHub stars"></a></div><script src="https://code.jquery.com/jquery-1.9.0.min.js"></script><script src="/js/all.js?96f99ee"></script><script type="application/ld+json">{ "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] }</script>