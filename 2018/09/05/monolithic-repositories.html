<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="While many, including Google, advocate for larger monolithic repositories, I strongly believe that the biggest repo should include fewer than 50K lines of code." /> <meta name="keywords" content="git monorepo, mono repo, mono stack repo, monolithic repository, monorepo" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2018-09-05 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="Monolithic Repos Are Evil"/> <meta name="twitter:description" property="og:description" content="While many, including Google, advocate for larger monolithic repositories, I strongly believe that the biggest repo should include fewer than 50K lines of code."/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2018/09/05/monolithic-repositories.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?6c62e4ddc32"/> <link rel="apple-touch-icon" href="/favicon.ico?6c62e4ddc32"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?6c62e4ddc32"/> <link rel="stylesheet" href="/css/icons.css?6c62e4ddc32"/> <link rel="canonical" href="https://www.yegor256.com/2018/09/05/monolithic-repositories.html" /> <title>Monolithic Repos Are Evil</title> <meta name='og:image' content='https://www.yegor256.com/images/2018/09/funny-games.jpg'/><meta name='twitter:image' content='https://www.yegor256.com/images/2018/09/funny-games.jpg'/><meta name='og:image:width' content='1270'/> <meta name='twitter:image:width' content='1270'/><meta name='og:image:height' content='687'/> <meta name='twitter:image:height' content='687'/><meta name='twitter:card' content='summary_large_image'/><meta name='twitter:image:alt' content='Funny Games (2007) by Michael Haneke'/> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My Stack Overflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li ><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li ><a href="/contents.html" title="The contents of the entire blog">All&#160;388</a></li> <li ><a href="/teaching.html" title="My courses and lectures">Teaching</a></li> <li ><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li ><a href="/books.html" title="The books I wrote">Books</a></li> <li ><a href="/research.html" title="My research directions and progress">Research</a></li> <li ><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li ><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li ><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li ><a href="/paintings.html" title="My paintings for sale">Art</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке о политике в России, Украине и мире">Политика</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2018/09/05/monolithic-repositories.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2018/09/05/monolithic-repositories.html</code></p><h1 itemprop="name headline mainEntityOfPage">Monolithic Repos Are Evil</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2018-09-05T00:00:00+00:00"> 5 September 2018 </time> </li> <li class="desktop-only" itemprop="locationCreated">Moscow, Russia</li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="https://www.yegor256.com/2018/09/05/monolithic-repositories.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><ul class="subline"> <li title="The page is translated by ChatGPT from English to a few languages"> Translated by <i class="icon icon-chatgpt notranslate" aria-hidden="true"></i> to </li> <li title="Click to see this page translated to Chinese"> <a href='https://www.yegor256.com/zh/2018/09/05/monolithic-repositories.html'>中文</a> </li> <li title="Click to see this page translated to Russian"> <a href='https://www.yegor256.com/ru/2018/09/05/monolithic-repositories.html'>русский</a> </li></ul><p class="unprintable"><a href='/tag/devops.html' class='tag notranslate'>devops</a></p><nav class="buttons notranslate desktop-only"> <a href="https://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2018/09/05/monolithic-repositories.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2018/09/05/monolithic-repositories.html&amp;text=Monolithic+Repos+Are+Evil" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2018/09/05/monolithic-repositories.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="https://reddit.com/submit?url=https://www.yegor256.com/2018/09/05/monolithic-repositories.html%3F2018-35&amp;title=Monolithic+Repos+Are+Evil" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="https://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2018/09/05/monolithic-repositories.html%3F2018-35&amp;t=Monolithic+Repos+Are+Evil" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div ><p>We all keep our code in <del>Git</del> <a href="https://en.wikipedia.org/wiki/Version_control">version control</a> repositories. The question is whether we should create a new repository for each new module or try to keep as much as possible in a single so called “monolithic” repo (or simply <a href="https://en.wikipedia.org/wiki/Monorepo">monorepo</a>). Market leaders, like <a href="https://code.fb.com/core-data/scaling-mercurial-at-facebook/">Facebook</a> and <a href="https://www.infoq.com/presentations/Development-at-Google">Google</a>, advocate the second approach. I believe they are wrong.</p><figure class="jb_picture"><img itemprop="image" alt="Funny Games (2007) by Michael Haneke" src="/images/2018/09/funny-games.jpg" longdesc="#9f6d574f" /><figcaption id="9f6d574f">Funny Games (2007) by Michael Haneke</figcaption></figure><p>Let’s use the following JavaScript function as an example. It downloads a JSON document from a <a href="http://www.zold.io">Zold</a> node (using <a href="https://jquery.com/">jQuery</a>) and places part of its content on the HTML page. Then it colors the data according to its value.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// main.js</span>
<span class="kd">function</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">$</span><span class="p">.</span><span class="nf">getJSON</span><span class="p">(</span><span class="dl">'</span><span class="s1">http://b1.zold.io/</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">json</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">$body</span> <span class="o">=</span> <span class="nf">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">body</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">$body</span><span class="p">.</span><span class="nf">text</span><span class="p">(</span><span class="nx">json</span><span class="p">.</span><span class="nx">nscore</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">color</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">red</span><span class="dl">'</span><span class="p">;</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">json</span><span class="p">.</span><span class="nx">nscore</span> <span class="o">&gt;</span> <span class="mi">500</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">color</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">green</span><span class="dl">'</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">$body</span><span class="p">.</span><span class="nf">css</span><span class="p">(</span><span class="dl">'</span><span class="s1">color</span><span class="dl">'</span><span class="p">,</span> <span class="nx">color</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">}</span>
</code></pre></div></div><p>Pretty obvious, isn’t it? Just a single <code class="language-plaintext highlighter-rouge">main.js</code> file which does everything we need. We simply add it to the HTML and it works:</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://code.jquery.com/jquery-3.3.1.min.js"</span><span class="nt">/&gt;</span>
    <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">main.js</span><span class="dl">"</span><span class="o">/&gt;</span>
  <span class="o">&lt;</span><span class="sr">/head</span><span class="err">&gt;
</span>  <span class="o">&lt;</span><span class="nx">body</span> <span class="nx">onload</span><span class="o">=</span><span class="dl">"</span><span class="s2">main();</span><span class="dl">"</span><span class="o">&gt;</span><span class="nx">loading</span><span class="p">...</span><span class="o">&lt;</span><span class="sr">/body</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/html</span><span class="err">&gt;
</span></code></pre></div></div><p>Now, let me refactor it. Let me break it into two pieces. The first piece will load the data and the second one will be a jQuery plugin to colorize HTML content according to the data it contains. This is how the plugin will look:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// colorize.js</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">fn</span><span class="p">.</span><span class="nx">colorize</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nf">parseFloat</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nf">text</span><span class="p">());</span>
  <span class="kd">var</span> <span class="nx">keys</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nf">keys</span><span class="p">(</span><span class="nx">colors</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="nf">function </span><span class="p">(</span><span class="nx">k</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nf">parseInt</span><span class="p">(</span><span class="nx">k</span><span class="p">);</span> <span class="p">})</span>
    <span class="p">.</span><span class="nf">sort</span><span class="p">(</span><span class="nf">function </span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="nx">b</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">a</span> <span class="o">-</span> <span class="nx">b</span><span class="p">;</span> <span class="p">})</span>
    <span class="p">.</span><span class="nf">reverse</span><span class="p">();</span>
  <span class="k">for </span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">keys</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">max</span> <span class="o">=</span> <span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">data</span> <span class="o">&gt;=</span> <span class="nx">max</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nf">addClass</span><span class="p">(</span><span class="nx">colors</span><span class="p">[</span><span class="nx">max</span><span class="p">]);</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nf">removeClass</span><span class="p">(</span><span class="nx">colors</span><span class="p">[</span><span class="nx">max</span><span class="p">]);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><p>The <code class="language-plaintext highlighter-rouge">main.js</code> will look like this:</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// main.js</span>
<span class="kd">function</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">$</span><span class="p">.</span><span class="nf">getJSON</span><span class="p">(</span><span class="dl">'</span><span class="s1">http://b1.zold.io/</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">json</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">body</span><span class="dl">'</span><span class="p">)</span>
      <span class="p">.</span><span class="nf">text</span><span class="p">(</span><span class="nx">json</span><span class="p">.</span><span class="nx">nscore</span><span class="p">)</span>
      <span class="p">.</span><span class="nf">colorize</span><span class="p">({</span> <span class="mi">500</span><span class="p">:</span> <span class="dl">'</span><span class="s1">green</span><span class="dl">'</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="dl">'</span><span class="s1">red</span><span class="dl">'</span> <span class="p">});</span>
  <span class="p">});</span>
<span class="p">}</span>
</code></pre></div></div><p>Now, instead of a single monolithic piece of code, we have two smaller pieces which have to be loaded together into the target HTML:</p><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://code.jquery.com/jquery-3.3.1.min.js"</span><span class="nt">/&gt;</span>
    <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">colorize.js</span><span class="dl">"</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">main.js</span><span class="dl">"</span><span class="o">/&gt;</span>
  <span class="o">&lt;</span><span class="sr">/head</span><span class="err">&gt;
</span>  <span class="o">&lt;</span><span class="nx">body</span> <span class="nx">onload</span><span class="o">=</span><span class="dl">"</span><span class="s2">main();</span><span class="dl">"</span><span class="o">&gt;</span><span class="nx">loading</span><span class="p">...</span><span class="o">&lt;</span><span class="sr">/body</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/html</span><span class="err">&gt;
</span></code></pre></div></div><p>Two pieces are better than one? It seems that <a href="https://ai.google/research/pubs/pub45424">Google</a>, <a href="https://blog.digitalocean.com/taming-your-go-dependencies/">Digital Ocean</a> and <a href="https://gregoryszorc.com/blog/2014/09/09/on-monolithic-repositories/">Mozilla</a> don’t think so.</p><p>I disagree.</p><p>To illustrate my point I extracted the JavaScript function into a new standalone <a href="https://github.com/yegor256/colorizejs">jQuery plugin</a>. Here is what I did:</p><ul> <li>Created a new GitHub repo <a href="https://github.com/yegor256/colorizejs">yegor256/colorizejs</a>;</li> <li>Read the <a href="https://learn.jquery.com/plugins/basic-plugin-creation/">instructions</a>;</li> <li>Did some research of jQuery plugins, studied a few examples;</li> <li>Found out that most of them used <a href="https://gulpjs.com/">Gulp</a>, which I’ve never heard of;</li> <li>Decided to use <a href="https://www.npmjs.com/">npm</a> for JavaScript packaging (what else, right?);</li> <li>Created <a href="https://github.com/yegor256/colorizejs/blob/master/package.json"><code class="language-plaintext highlighter-rouge">package.json</code></a> for npm;</li> <li>Renamed GitHub repo to <code class="language-plaintext highlighter-rouge">colorizejs</code> when I found out that npm package <a href="https://www.npmjs.com/package/colorize"><code class="language-plaintext highlighter-rouge">colorize</code></a> already exists;</li> <li>Configured <a href="https://github.com/yegor256/colorizejs/blob/master/.travis.yml"><code class="language-plaintext highlighter-rouge">.travis.yml</code></a> for <a href="https://travis-ci.org/">Travis</a>;</li> <li>Created a <a href="https://github.com/yegor256/colorizejs/blob/master/README.md">README.md</a> and explained how to use it and install it;</li> <li>Decided to use the MIT license and created <a href="https://github.com/yegor256/colorizejs/blob/master/LICENSE.txt">LICENSE.txt</a>;</li> <li>Configured <a href="https://github.com/yegor256/colorizejs/blob/master/.pdd">PDD</a> for <a href="/2017/04/05/pdd-in-action.html">puzzles</a> automated collection;</li> <li>Configured <a href="https://github.com/yegor256/colorizejs/blob/master/.rultor.yml"><code class="language-plaintext highlighter-rouge">.rultor.yml</code></a> for <a href="/2014/07/24/rultor-automated-merging.html">Rultor</a>;</li> <li>Tried to create a unit test and failed miserably (after a full hour of research), since I’ve had almost no experience in JS unit testing;</li> <li>Posted a <a href="https://stackoverflow.com/questions/51809750/">question</a> to Stack Overflow;</li> <li>The question was answered by a few people only after the bounty I offered;</li> <li><a href="https://github.com/brian-lives-outdoors">@brian-lives-outdoors</a>’s answer was the best and he even submitted a <a href="https://github.com/yegor256/colorizejs/pull/2">pull request</a> with a unit test, which I merged;</li> <li>Released the first version <a href="https://github.com/yegor256/colorizejs/tree/0.0.1">0.0.1</a> to <a href="https://www.npmjs.com/package/colorizejs">npmjs.com</a>;</li> <li>Modified the code to make it work both with classes and colors;</li> <li><a href="https://github.com/yegor256/colorizejs/issues/3">Implemented</a> and released the next version <a href="https://github.com/yegor256/colorizejs/tree/0.1.0">0.1.0</a>;</li> <li><a href="https://github.com/zold-io/zold.github.io/issues/81">Added it</a> to Zold front-end, tested it, and released it—check it out <a href="http://www.zold.io/health.html">here</a>.</li></ul><p>It took almost three weeks of waiting and four hours of work, just to move a small piece of JavaScript code to a new repository and release it separately. Was it worth it? Well, I think it was. But <del>many</del> most other blog post authors, who I managed to find, think that it would be better to keep everything in a single monolithic repo, mostly because it’s better for <em>productivity</em>. For example, <a href="https://danluu.com/monorepo/">Advantages of monorepos</a> by <a href="https://twitter.com/danluu">Dan Luu</a>, <a href="https://people.engr.ncsu.edu/ermurph3/papers/seip18.pdf">Advantages and Disadvantages of a Monolithic Repository</a> (a case study at Google) by Ciera Jaspan et al., and <a href="https://www.tomasvotruba.cz/blog/2017/01/31/how-monolithic-repository-in-open-source-saved-my-laziness/">How Monolithic Repository in Open Source saved my Laziness</a> by Tomas Votruba.</p><p>There are also a few good analyses of both approaches, for example <a href="https://www.dotconferences.com/2016/05/fabien-potencier-monolithic-repositories-vs-many-repositories">Monolithic repositories vs. Many repositories</a> speech by Fabien Potencier at dotScale 2016 and <a href="http://www.gigamonkeys.com/mono-vs-multi/">Repo Style Wars: Mono vs Multi</a> by Peter Seibel.</p><p>In a nutshell, they <a href="https://gomonorepo.org/">all claim</a> that productivity is higher with a monolithic repo because the amount of operations one has to do in order to make a change is smaller. Indeed, in a monorepo there will be a single branch, a single set of commits, a single pull request, a single merge, deploy and release. Also it will be easier to test, both manually and via unit testing. Continuous integration is easier to configure, and so on and so forth.</p><aside class="quote">A set of smaller components is better than a larger solid piece. </aside><p>All these “reasonable” arguments remind me of what I hear when preaching object decomposition and suggesting that multiple objects are better than a single large one. Imagine a large class of 3,000 lines of code, which does many things and they are all very tightly coupled. It’s “easy” to test it, to make changes, to deploy, to review, etc. Because everything stays in one file, right? We don’t need to jump from class to class in order to understand the design. We just look at one screen, scroll it up and down, and that’s it. Right? Totally wrong!</p><p>I guess I don’t need to explain why it’s wrong. We don’t design our software that way anymore. We know that tight coupling is a bad idea. We know that a set of smaller components is better than a larger solid piece.</p><aside class="youtube"> <a href="https://www.youtube.com/watch?v=zljJpADEf_E"><div class="box"> <img src="https://i.ytimg.com/vi/zljJpADEf_E/mqdefault.jpg" alt="YouTube video #zljJpADEf_E" /><div class="play"><i class="icon icon-play"></i></div></div></a><div>M6: Keeping all source code in a single monolithic repository is a terrible idea!; 3 January 2019.</div></aside><p>Why can’t we apply the same logic to repositories? I believe we can. Of course, just like in object-oriented programming, a fine-grained design requires more skills and time. Look at what I had to do with this small jQuery plugin. I’ve spent hours of coding and thinking. I even had to learn <a href="https://gulpjs.com/">Gulp</a> and <a href="https://jasmine.github.io/">Jasmine</a>, which I most probably will not use anymore. But the benefits we are getting from it are enormous. This is my short list of them:</p><ul> <li><p><strong>Encapsulation</strong>. Each repo encapsulates a single problem, hiding its details from everybody else. Thanks to that, the scope each repo has to deal with gets smaller. The smaller the scope, just like in OOP, the easier it is to maintain and modify. The easier to maintain, the cheaper the development. I guess Google guys don’t really worry about costs. On the contrary, they want their salaries to grow. A large unmaintainable monolithic repo is a perfect tool to make it happen.</p></li> <li><p><strong>Fast Builds</strong>. When a repo is small, the time its automated build takes is small. Look at the time Travis <a href="https://travis-ci.org/yegor256/colorizejs/builds/420726284">spends</a> for my jQuery plugin. It’s 51 seconds. It’s fast. We <a href="https://mortoray.com/2015/05/06/fast-build-turnaround-time-is-essential/">all know</a> that the faster the build, the better it is for productivity, since it’s easier to use the build as a tool for development.</p></li> <li><p><strong>Accurate Metrics</strong>. I don’t know whether you rely on metrics in your projects, but we at <a href="https://www.zerocracy.com">Zerocracy</a> do pay attention to numbers, like lines of code, <a href="/2014/11/14/hits-of-code.html">hits of code</a>, number of commits, classes, methods, cohesion, coupling, etc. It’s always a question whether the metrics are accurate. Calculating lines of code for a large repository doesn’t make any sense, since the number will include a lot of files from completely different parts of the application. Moreover there will be different languages and file formats. Say a repo has 200K lines of Java, 150K lines of XML, 50K lines of JavaScript, and 40K lines of Ruby. Can you say something specific about this repo? Is it large? Is it a Java repo? And, more importantly, can it be compared with other repositories? Not really. It’s just a big messy storage of files.</p></li></ul><aside class="quote">The preferred situation is one language or technology per repository. </aside><ul> <li><p><strong>Homogeneous Tasks</strong>. Smaller repositories tend to have smaller tech stacks, meaning that each of them uses just a few languages and frameworks, or (and this is the preferred situation)—one language or technology per repository. Thanks to this, the management of programmers becomes easier, since any ticket/problem can be assigned to anybody. It’s easier to make tasks similar in size and complexity. This obviously means better manageability of the project.</p></li> <li><p><strong>Single Coding Standard</strong>. It’s easier to standardize the coding style if the repo is small. When it’s large, various parts of the code base will have different styles and it will be almost impossible to put everybody on the same page. In other words, smaller repositories look more beautiful than larger ones.</p></li> <li><p><strong>Short Names</strong>. Each repository, inevitably, will have its own namespace. For example, in the JS repository I just created, I only have two files: <code class="language-plaintext highlighter-rouge">colorizejs.js</code> and <code class="language-plaintext highlighter-rouge">test-colorizejs.js</code>. I don’t really care about the naming inside them, since the namespace is very small. <del>I can even use global variables.</del> Shorter names and smaller namespaces mean better maintainability.</p></li> <li><p><strong>Simple Tests</strong>. The larger the code base, the more dependencies it has, which are difficult to mock and test. Very large code bases become fundamentally untestable since they require a lot of integration tests which are difficult to maintain. Smaller libraries, frameworks and modules are easier to keep at the level of simple and fast unit testing.</p></li></ul><p>Thus, I believe that the smaller the repositories and modules, the better. Ideally, I would say, the largest acceptable size for a code base is 50,000 lines of code. Everything that goes above this line is a perfect candidate for decomposition.</p><blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">What do you think is better, a bigger code repository with everything inside, or many smaller ones with their own builds, dependencies, issues, and pull requests?</p>&mdash; Yegor Bugayenko (@yegor256) <a href="https://twitter.com/yegor256/status/1053922638517731329?ref_src=twsrc%5Etfw">October 21, 2018</a></blockquote> <script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div></article></div><div class="wrapper" aria-hidden="true"> <related-posts /></div><div class="disqus" role="complementary" aria-hidden="true"><p class="disqus_hint" > Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2023</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="https://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge" /></a> &nbsp; <a href="https://github.com/yegor256/blog/stargazers"> <img src="//img.shields.io/github/stars/yegor256/blog.svg?style=flat-square" alt="GitHub stars" /></a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?6c62e4ddc32"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html>
