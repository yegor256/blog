<!DOCTYPE html> <html xmlns="https://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="Even though Java annotations are very popular and convenient, they are making Java code less object-oriented and more messy." /> <meta name="keywords" content="java annotations, java annotations example, java annotations list, java annotations runtime, java annotations tutorial" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2016-04-12 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="Java Annotations Are a Big Mistake"/> <meta name="twitter:description" property="og:description" content="Even though Java annotations are very popular and convenient, they are making Java code less object-oriented and more messy."/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2016/04/12/java-annotations-are-evil.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?30f327eba1b"/> <link rel="apple-touch-icon" href="/favicon.ico?30f327eba1b"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?30f327eba1b"/> <link rel="stylesheet" href="/css/icons.css?30f327eba1b"/> <link rel="canonical" href="https://www.yegor256.com/2016/04/12/java-annotations-are-evil.html" /> <title>Java Annotations Are a Big Mistake</title> <meta name='og:image' content='https://www.yegor256.com/images/2016/04/gomorrah.jpg'/><meta name='twitter:image' content='https://www.yegor256.com/images/2016/04/gomorrah.jpg'/><meta name='og:image:width' content='1280'/> <meta name='twitter:image:width' content='1280'/><meta name='og:image:height' content='852'/> <meta name='twitter:image:height' content='852'/><meta name='twitter:card' content='summary_large_image'/><meta name='twitter:image:alt' content='Gomorra (2008) by Matteo Garrone'/> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My Stack Overflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li ><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li ><a href="/contents.html" title="The contents of the entire blog">All&#160;471</a></li> <li ><a href="/teaching.html" title="My courses and lectures">Teaching</a></li> <li ><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li ><a href="/books.html" title="The books I wrote">Books</a></li> <li ><a href="/research.html" title="My research directions and progress">Research</a></li> <li ><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li ><a href="https://www.iccq.ru" title="International Conference on Code Quality">ICCQ</a></li> <li ><a href="https://www.kaicode.org" title="Open Source Festival">KaiCode</a></li> <li ><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li ><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li ><a href="/paintings.html" title="My paintings for sale">Art</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul> <li> If you have an open source repository designed right, there is a chance to win up to $4,096 at <a href="https://www.kaicode.org">KaiCode'25</a>, our 8th annual open source festival. <a href="https://docs.google.com/forms/d/1nUlL2xvL1OOy3LoVF-g7MfB-9yeG68XB2wXW4MAoWrY">Submit</a> your project now, it's free! </li> <li> Are you a Java developer? Ready to move to Moscow (Russia) and join my team for a full-time employment in Fortune-100 company? We are working with <a href="https://www.eolang.org">EO</a>, a new programming language. <a href="mailto:job@yegor256.com">Email me</a>, we'll discuss. </li></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2016/04/12/java-annotations-are-evil.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2016/04/12/java-annotations-are-evil.html</code></p><h1 itemprop="name headline mainEntityOfPage">Java Annotations Are a Big Mistake</h1><aside class='book'><a href='https://amzn.to/2pyceWc'><img src='/images/books/elegant-objects/cover-eo2.png' class='book-cover' alt='book cover'/></a>Read more about this subject in <a href='https://amzn.to/2pyceWc'>Section&nbsp;6.1</a><br/> of my book<a href='https://amzn.to/2pyceWc'><img src='/images/books/amazon-buy-button.png' class='amazon-button' alt='Click to buy'/></a></aside><ul class="subline"> <li> <time itemprop="datePublished" datetime="2016-04-12T00:00:00+00:00"> 12 April 2016 </time> </li> <li class="desktop-only" itemprop="locationCreated">Seattle, WA</li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="https://www.yegor256.com/2016/04/12/java-annotations-are-evil.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><ul class="subline"> <li title="The page is translated by ChatGPT from English to a few languages"> Translated by <i class="icon icon-chatgpt notranslate" aria-hidden="true"></i> to </li> <li title="Click to see this page translated to Chinese"> <a href='https://www.yegor256.com/zh/2016/04/12/java-annotations-are-evil.html'>中文</a> </li> <li title="Click to see this page translated to Russian"> <a href='https://www.yegor256.com/ru/2016/04/12/java-annotations-are-evil.html'>русский</a> </li></ul><p class="unprintable"><a href='/tag/java.html' class='tag notranslate'><img src='/images/icons/java-white.svg' alt='Java'/>java</a> <a href='/tag/oop.html' class='tag notranslate'><img src='/images/icons/cactus.svg' alt='OOP'/>oop</a></p><nav class="buttons notranslate desktop-only"> <a href="https://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2016/04/12/java-annotations-are-evil.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2016/04/12/java-annotations-are-evil.html&amp;text=Java+Annotations+Are+a+Big+Mistake" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2016/04/12/java-annotations-are-evil.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="https://reddit.com/submit?url=https://www.yegor256.com/2016/04/12/java-annotations-are-evil.html%3F2016-15&amp;title=Java+Annotations+Are+a+Big+Mistake" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="https://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2016/04/12/java-annotations-are-evil.html%3F2016-15&amp;t=Java+Annotations+Are+a+Big+Mistake" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> <a href="#" title="Cite it via BibTeX" class="button" onclick="$('#bibtex').toggle(); return false;"> <i class="icon icon-tex notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div ><div id="bibtex" style="display: none"><p>Please, cite this blog post via <a href="https://www.bibtex.org/">BibTeX</a> as such:</p><pre style="color:#053c5e;">@misc&#123;bugayenko2016blog0412,
  author = &#123;Bugayenko, Yegor&#125;,
  title = &#123;&#123;Java Annotations Are a Big Mistake&#125;&#125;,
  howpublished = &#123;\url&#123;https://www.yegor256.com/160412.html&#125;&#125;,
  year = &#123;2016&#125;,
  month = &#123;apr&#125;,
  note = &#123;[Online; accessed 31-01-2025]&#125;
&#125;</pre></div><p><a href="https://en.wikipedia.org/wiki/Java_annotation">Annotations</a> were introduced in Java 5, and we all got excited. Such a great instrument to make code shorter! No more Hibernate/Spring XML configuration files! Just annotations, right there in the code where we need them. No more <a href="https://en.wikipedia.org/wiki/Marker_interface_pattern">marker interfaces</a>, just a <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/annotation/Retention.html">runtime-retained</a> <a href="http://stackoverflow.com/questions/4296910/">reflection-discoverable</a> annotation! I was excited too. Moreover, I’ve made a few open source libraries which use annotations heavily. Take <a href="https://github.com/jcabi/jcabi-aspects">jcabi-aspects</a>, for example. However, I’m not excited any more. Moreover, I believe that annotations are a big mistake in Java design.</p><figure class="jb_picture"><img itemprop="image" alt="Gomorra (2008) by Matteo Garrone" src="/images/2016/04/gomorrah.jpg" longdesc="#8ef9c86b" /><figcaption id="8ef9c86b">Gomorra (2008) by Matteo Garrone</figcaption></figure> <aside class="youtube"> <a href="https://www.youtube.com/watch?v=g1ctRcW214w"><div class="box"> <img src="https://i.ytimg.com/vi/g1ctRcW214w/mqdefault.jpg" alt="YouTube video #g1ctRcW214w" /><div class="play"><i class="icon icon-play"></i></div></div></a><div>Java Annotations Are a Big Mistake (webinar #14); 4 May 2016.</div></aside><p>Long story short, there is one big problem with annotations—they encourage us to implement <a href="/2014/11/20/seven-virtues-of-good-object.html">object</a> functionality <em>outside</em> of an object, which is against the very principle of <a href="/2016/11/21/naked-data.html">encapsulation</a>. The object is not solid any more, since its behavior is not defined entirely by its own methods—some of its functionality stays elsewhere. Why is it bad? Let’s see in a few examples.</p><h2 id="inject"><code class="language-plaintext highlighter-rouge">@Inject</code></h2><p>Say we annotate a property with <code class="language-plaintext highlighter-rouge">@Inject</code>:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">javax.inject.Inject</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Books</span> <span class="o">{</span>
  <span class="nd">@Inject</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="no">DB</span> <span class="n">db</span><span class="o">;</span>
  <span class="c1">// some methods here, which use this.db</span>
<span class="o">}</span>
</code></pre></div></div><p>Then we have an injector that knows what to inject:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Injector</span> <span class="n">injector</span> <span class="o">=</span> <span class="nc">Guice</span><span class="o">.</span><span class="na">createInjector</span><span class="o">(</span>
  <span class="k">new</span> <span class="nf">AbstractModule</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">()</span> <span class="o">{</span>
      <span class="k">this</span><span class="o">.</span><span class="na">bind</span><span class="o">(</span><span class="no">DB</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">toInstance</span><span class="o">(</span>
        <span class="k">new</span> <span class="nf">Postgres</span><span class="o">(</span><span class="s">"jdbc:postgresql:5740/main"</span><span class="o">)</span>
      <span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">);</span>
</code></pre></div></div><p>Now we’re making an instance of class <code class="language-plaintext highlighter-rouge">Books</code> via the container:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Books</span> <span class="n">books</span> <span class="o">=</span> <span class="n">injector</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="nc">Books</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</code></pre></div></div><p>The class <code class="language-plaintext highlighter-rouge">Books</code> has no idea how and who will inject an instance of class <code class="language-plaintext highlighter-rouge">DB</code> into it. This will happen behind the scenes and outside of its control. The injection will do it. It may look convenient, but this attitude causes a lot of damage to the entire code base. The control is lost (not inverted, but lost!). The object is not in charge any more. It can’t be responsible for what’s happening to it.</p><p>Instead, here is how this should be done:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">Books</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="no">DB</span> <span class="n">db</span><span class="o">;</span>
  <span class="nc">Books</span><span class="o">(</span><span class="kd">final</span> <span class="no">DB</span> <span class="n">base</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">db</span> <span class="o">=</span> <span class="n">base</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="c1">// some methods here, which use this.db</span>
<span class="o">}</span>
</code></pre></div></div><aside class="youtube"> <a href="https://www.youtube.com/watch?v=oV6Utb5Jows"><div class="box"> <img src="https://i.ytimg.com/vi/oV6Utb5Jows/mqdefault.jpg" alt="YouTube video #oV6Utb5Jows" /><div class="play"><i class="icon icon-play"></i></div></div></a><div>Dependency Injection Container is a Bad Idea (webinar #9); 1 December 2015.</div></aside><p>This article explains why Dependency Injection containers are a wrong idea in the first place: <a href="/2014/10/03/di-containers-are-evil.html">Dependency Injection Containers are Code Polluters</a>. Annotations basically provoke us to make the containers and use them. We move functionality outside of our objects and put it into containers, or somewhere else. That’s because we don’t want to duplicate the same code over and over again, right? That’s correct, duplication is bad, but tearing an object apart is even worse. Way worse. The same is true about ORM (JPA/Hibernate), where annotations are being actively used. Check this post, it explains what is wrong about ORM: <a href="/2014/12/01/orm-offensive-anti-pattern.html">ORM Is an Offensive Anti-Pattern</a>. Annotations by themselves are not the key motivator, but they help us and encourage us by tearing objects apart and keeping parts in different places. They are containers, sessions, managers, controllers, etc.</p><h2 id="xmlelement"><code class="language-plaintext highlighter-rouge">@XmlElement</code></h2><p>This is how JAXB <a href="/2015/03/26/jaxb-vs-xembly.html">works</a>, when you want to convert your <a href="https://en.wikipedia.org/wiki/Plain_Old_Java_Object">POJO</a> to XML. First, you attach the <code class="language-plaintext highlighter-rouge">@XmlElement</code> annotation to the getter:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">javax.xml.bind.annotation.XmlElement</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.xml.bind.annotation.XmlRootElement</span><span class="o">;</span>
<span class="nd">@XmlRootElement</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Book</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>
  <span class="kd">public</span> <span class="nf">Book</span><span class="o">(</span><span class="kd">final</span> <span class="nc">String</span> <span class="n">title</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">title</span> <span class="o">=</span> <span class="n">title</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="nd">@XmlElement</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getTitle</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">title</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><p>Then, you create a marshaller and ask it to convert an instance of class <code class="language-plaintext highlighter-rouge">Book</code> into XML:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">final</span> <span class="nc">Book</span> <span class="n">book</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Book</span><span class="o">(</span><span class="s">"0132350882"</span><span class="o">,</span> <span class="s">"Clean Code"</span><span class="o">);</span>
<span class="kd">final</span> <span class="nc">JAXBContext</span> <span class="n">ctx</span> <span class="o">=</span> <span class="nc">JAXBContext</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="nc">Book</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="kd">final</span> <span class="nc">Marshaller</span> <span class="n">marshaller</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">createMarshaller</span><span class="o">();</span>
<span class="n">marshaller</span><span class="o">.</span><span class="na">marshal</span><span class="o">(</span><span class="n">book</span><span class="o">,</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">);</span>
</code></pre></div></div><aside class="youtube"> <a href="https://www.youtube.com/watch?v=cv23Z6xpwDw"><div class="box"> <img src="https://i.ytimg.com/vi/cv23Z6xpwDw/mqdefault.jpg" alt="YouTube video #cv23Z6xpwDw" /><div class="play"><i class="icon icon-play"></i></div></div></a><div>Java Annotations Are a Bad Idea; 20 June 2017.</div></aside><p>Who is creating the XML? Not the <code class="language-plaintext highlighter-rouge">book</code>. Someone else, outside of the class <code class="language-plaintext highlighter-rouge">Book</code>. This is very wrong. Instead, this is how this should have been done. First, the class that has no idea about XML:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">DefaultBook</span> <span class="kd">implements</span> <span class="nc">Book</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">title</span><span class="o">;</span>
  <span class="nc">DefaultBook</span><span class="o">(</span><span class="kd">final</span> <span class="nc">String</span> <span class="n">title</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">title</span> <span class="o">=</span> <span class="n">title</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getTitle</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">title</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><p>Then, the <a href="/2015/02/26/composable-decorators.html">decorator</a> that prints it to the XML:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">XmlBook</span> <span class="kd">implements</span> <span class="nc">Book</span><span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Book</span> <span class="n">origin</span><span class="o">;</span>
  <span class="nc">XmlBook</span><span class="o">(</span><span class="kd">final</span> <span class="nc">Book</span> <span class="n">book</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">origin</span> <span class="o">=</span> <span class="n">book</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getTitle</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">origin</span><span class="o">.</span><span class="na">getTitle</span><span class="o">();</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toXML</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span>
      <span class="s">"&lt;book&gt;&lt;title&gt;%s&lt;/title&gt;&lt;/book&gt;"</span><span class="o">,</span>
      <span class="k">this</span><span class="o">.</span><span class="na">getTitle</span><span class="o">()</span>
    <span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><p>Now, in order to <a href="/2016/04/05/printers-instead-of-getters.html">print</a> the book in XML we do the following:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span> <span class="n">xml</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">XmlBook</span><span class="o">(</span>
  <span class="k">new</span> <span class="nf">DefaultBook</span><span class="o">(</span><span class="s">"Elegant Objects"</span><span class="o">)</span>
<span class="o">).</span><span class="na">toXML</span><span class="o">();</span>
</code></pre></div></div><p>The XML printing functionality is inside <code class="language-plaintext highlighter-rouge">XmlBook</code>. If you don’t like the decorator idea, you can move the <code class="language-plaintext highlighter-rouge">toXML()</code> method to the <code class="language-plaintext highlighter-rouge">DefaultBook</code> class. It’s not important. What is important is that the functionality always stays where it belongs—inside the object. Only the object knows how to <a href="/2016/04/05/printers-instead-of-getters.html">print itself</a> to the XML. Nobody else!</p><h2 id="retryonfailure"><code class="language-plaintext highlighter-rouge">@RetryOnFailure</code></h2><p>Here is an example (from <a href="/2014/08/15/retry-java-method-on-exception.html">my own library</a>):</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">com.jcabi.aspects.RetryOnFailure</span><span class="o">;</span>
<span class="kd">class</span> <span class="nc">Foo</span> <span class="o">{</span>
  <span class="nd">@RetryOnFailure</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">load</span><span class="o">(</span><span class="no">URL</span> <span class="n">url</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">().</span><span class="na">getContent</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><p>After compilation, we run a so called <a href="/2014/06/01/aop-aspectj-java-method-logging.html">AOP weaver</a> that technically turns our code into something like this:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">Foo</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">load</span><span class="o">(</span><span class="no">URL</span> <span class="n">url</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">try</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">_Foo</span><span class="o">.</span><span class="na">load</span><span class="o">(</span><span class="n">url</span><span class="o">);</span>
      <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// ignore it</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="kd">class</span> <span class="nc">_Foo</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">load</span><span class="o">(</span><span class="no">URL</span> <span class="n">url</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">url</span><span class="o">.</span><span class="na">openConnection</span><span class="o">().</span><span class="na">getContent</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><p>I simplified the actual algorithm of retrying a method call on failure, but I’m sure you get the idea. <a href="https://www.eclipse.org/aspectj/">AspectJ</a>, the <a href="https://en.wikipedia.org/wiki/Aspect-oriented_programming">AOP</a> engine, uses <a href="https://aspects.jcabi.com/annotation-retryonfailure.html"><code class="language-plaintext highlighter-rouge">@RetryOnFailure</code></a> annotation as a signal, informing us that the class has to be wrapped into another one. This is happening behind the scenes. We don’t see that supplementary class, which implements the retrying algorithm. But the bytecode produced by the AspectJ weaver contains a modified version of class <code class="language-plaintext highlighter-rouge">Foo</code>.</p><aside class="youtube"> <a href="https://www.youtube.com/watch?v=WSgP85kr6eU"><div class="box"> <img src="https://i.ytimg.com/vi/WSgP85kr6eU/mqdefault.jpg" alt="YouTube video #WSgP85kr6eU" /><div class="play"><i class="icon icon-play"></i></div></div></a><div>Why Getters-and-Setters Is An Anti-Pattern? (webinar #4); 1 July 2015.</div></aside><p>That is exactly what is wrong with this approach—we don’t see and don’t control the instantiation of that supplementary object. Object composition, which is the most important process in object design, is hidden somewhere behind the scenes. You may say that we don’t need to see it since it’s supplementary. I disagree. We must see how our objects are composed. We may not care about how they work, but we must see the entire composition process.</p><p>A much better design would look like this (instead of annotations):</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Foo</span> <span class="n">foo</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FooThatRetries</span><span class="o">(</span><span class="k">new</span> <span class="nc">Foo</span><span class="o">());</span>
</code></pre></div></div><p>And then, the implementation of <code class="language-plaintext highlighter-rouge">FooThatRetries</code>:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">FooThatRetries</span> <span class="kd">implements</span> <span class="nc">Foo</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="nc">Foo</span> <span class="n">origin</span><span class="o">;</span>
  <span class="nc">FooThatRetries</span><span class="o">(</span><span class="nc">Foo</span> <span class="n">foo</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">origin</span> <span class="o">=</span> <span class="n">foo</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="nc">String</span> <span class="nf">load</span><span class="o">(</span><span class="no">URL</span> <span class="n">url</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">Retry</span><span class="o">().</span><span class="na">eval</span><span class="o">(</span>
      <span class="k">new</span> <span class="nc">Retry</span><span class="o">.</span><span class="na">Algorithm</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;()</span> <span class="o">{</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="nc">String</span> <span class="nf">eval</span><span class="o">()</span> <span class="o">{</span>
          <span class="k">return</span> <span class="nc">FooThatRetries</span><span class="o">.</span><span class="na">this</span><span class="o">.</span><span class="na">load</span><span class="o">(</span><span class="n">url</span><span class="o">);</span>
        <span class="o">}</span>
      <span class="o">}</span>
    <span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><p>And now, the implementation of <code class="language-plaintext highlighter-rouge">Retry</code>:</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">Retry</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="no">T</span> <span class="nf">eval</span><span class="o">(</span><span class="nc">Retry</span><span class="o">.</span><span class="na">Algorithm</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">algo</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">try</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">algo</span><span class="o">.</span><span class="na">eval</span><span class="o">();</span>
      <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// ignore it</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>
  <span class="kd">interface</span> <span class="nc">Algorithm</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="no">T</span> <span class="nf">eval</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><p>Is the code longer? Yes. Is it cleaner? A lot more. I regret that I didn’t understand it two years ago, when I started to work with <a href="https://github.com/jcabi/jcabi-aspects">jcabi-aspects</a>.</p><hr /><p>The bottom line is that annotations are bad. Don’t use them. What should be used instead? Object <a href="/2015/02/26/composable-decorators.html">composition</a>.</p><p>What could be worse than annotations? <a href="/2016/04/19/object-must-not-be-configurable.html">Configurations</a>. For example, XML configurations. Spring XML configuration mechanisms is a perfect example of terrible design. I’ve said it many times before. Let me repeat it again—Spring Framework is one of the worst software products in the Java world. If you can stay away from it, you will do yourself a big favor.</p><p>There should not be any “configurations” in <a href="/2016/08/15/what-is-wrong-object-oriented-programming.html">OOP</a>. We can’t configure our objects if they are real objects. We can only instantiate them. And the best method of instantiation is operator <code class="language-plaintext highlighter-rouge">new</code>. This operator is the key instrument for an OOP developer. Taking it away from us and giving us “configuration mechanisms” is an unforgivable <a href="/2015/11/24/imprisonment-for-irresponsible-coding.html">crime</a>.</p></div></article></div><script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script><div class="disqus" role="complementary" aria-hidden="true"><p class="disqus_hint" > Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0]; this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span>, 2014&ndash;<span itemprop="copyrightYear">2025</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="https://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge" /></a> &nbsp; <a href="https://github.com/yegor256/blog/stargazers"> <img src="//img.shields.io/github/stars/yegor256/blog.svg?style=flat-square" alt="GitHub stars" /></a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?30f327eba1b"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html>
