<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebPage"> <head> <script> (function(_,e,rr,s){_errs=[s];var c=_.onerror;_.onerror=function(){var a=arguments;_errs.push(a); c&&c.apply(this,a)};var b=function(){var c=e.createElement(rr),b=e.getElementsByTagName(rr)[0]; c.src="//beacon.errorception.com/"+s+".js";c.async=!0;b.parentNode.insertBefore(c,b)}; _.addEventListener?_.addEventListener("load",b,!1):_.attachEvent("onload",b)}) (window,document,"script","57c3846b0929bf2b09000494"); </script> <meta charset="utf-8"/> <meta itemprop="name" content="Why InputStream Design Is Wrong" /> <meta itemprop="author" content="Yegor Bugayenko" /> <meta itemprop="breadcrumb" content="http://www.yegor256.com" /> <meta itemprop="keywords" content="InputStream, InputStream java, method overloading, method overloading java, why InputStream is a class" /> <meta itemprop="description" content="Class InputStream in Java has three methods read(), this is what I think is very wrong. Not only in this class, but in general in OOP. " /> <meta name="description" content="Class InputStream in Java has three methods read(), this is what I think is very wrong. Not only in this class, but in general in OOP. " /> <meta name="keywords" content="InputStream, InputStream java, method overloading, method overloading java, why InputStream is a class" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta property="twitter:account_id" content="4503599630178231" /> <meta property="og:url" content="http://www.yegor256.com/2016/04/26/why-inputstream-design-is-wrong.html"/> <meta property="og:site_name" content="yegor256"/> <meta property="og:title" content="Why InputStream Design Is Wrong"/> <meta property="og:description" content="Class InputStream in Java has three methods read(), this is what I think is very wrong. Not only in this class, but in general in OOP. "/> <meta property="og:type" content="article" /> <meta property="og:locale" content="en_US" /> <meta property="fb:admins" content="10203747823006002"/> <meta name="twitter:site" content="www.yegor256.com"/> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:url" content="http://www.yegor256.com/2016/04/26/why-inputstream-design-is-wrong.html"/> <meta property="article:author" content="https://www.facebook.com/yegor256"/> <meta name="p:domain_verify" content="61f09f0ef5db665328827225a3fc11bd"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?f90e6b7"/> <link rel="apple-touch-icon" href="/favicon.ico?f90e6b7"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="http://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?f90e6b7"/> <link rel="stylesheet" href="/css/icons.css?f90e6b7"/> <link rel="canonical" href="http://www.yegor256.com/2016/04/26/why-inputstream-design-is-wrong.html" /> <link rel="amphtml" href="http://www.yegor256.com/2016/04/26/why-inputstream-design-is-wrong.amp.html" /> <title>Why InputStream Design Is Wrong - Yegor Bugayenko </title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="show head menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub"><span>subscribe</span></a> <a href="/about-me.html"> <img src="//cf.jare.io/?u=http://www.yegor256.com/images/yegor-bugayenko-192x192.png" class="photo" alt="photo of Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="follow me in Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss" title="RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a href="https://github.com/yegor256" rel="nofollow" title="my GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="my StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a href="https://www.facebook.com/yegor256" rel="nofollow" title="follow me in Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a href="https://instagram.com/yegor256" rel="nofollow" title="follow me in Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="my LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a href="https://www.youtube.com/c/yegor256" rel="nofollow" title="my Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a href="https://www.pinterest.com/yegor256/" rel="nofollow" title="my Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a href="https://angel.co/yegor256" rel="nofollow" title="my AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://gitter.im/yegor256/elegantobjects" rel="nofollow" title="Gitter chat"><i class="icon icon-gitter notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="Podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="Podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="blog@yegor256.com"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="home page">home</a></li> <li><a href="/best.html" title="best articles to read">12&#160;best</a></li> <li><a href="/contents.html" title="blog contents">all&#160;209</a></li> <li><a href="/webinars.html" title="webinars">webinars</a></li> <li><a href="/talks.html" title="talks">talks</a></li> <li><a href="/books.html" title="books">books</a></li> <li><a href="/papers.html" title="papers">papers</a></li> <li><a href="/pets.html" title="pets">pets</a></li> <li><a href="/award.html" title="software quality award">award</a></li> <li><a href="/testimonials.html" title="what people say about me">testimonials</a></li> <li><a href="http://ru.yegor256.com/" title="о политике" class="politics">о политике</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search"> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input type="text" id="search-query" class="field field-text" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search" autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="search via Google" alt="search via Google"/> </form></div><div class="hot"><ul> <li> I need help. I want to find sponsors for my <a href="/award.html">Software Quality Award</a>, but don't have time and connections to do that. Would you be interested to <strong>volunteer</strong> and help me? We need more money for the award, to better motivate programmers. Please, <a href="mailto:volunteer@yegor256.com">email</a>. </li></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div itemprop="image" itemscope="" itemtype="http://schema.org/ImageObject"> <meta itemprop="url" content="http://www.yegor256.com/images/yegor-bugayenko-192x192.png"/> <meta itemprop="height" content="192"/> <meta itemprop="width" content="192"/></div><div itemscope="" itemprop="publisher" itemtype="http://schema.org/Organization"> <meta itemprop="name" content="yegor256.com"/><div itemprop="logo" itemscope="" itemtype="http://schema.org/ImageObject"> <meta itemprop="url" content="http://www.yegor256.com/images/yegor-bugayenko-192x192.png"/> <meta itemprop="height" content="192"/> <meta itemprop="width" content="192"/></div></div><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=http://www.yegor256.com/2016/04/26/why-inputstream-design-is-wrong.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">http://www.yegor256.com/2016/04/26/why-inputstream-design-is-wrong.html</code></p><h1 itemprop="name headline mainEntityOfPage">Why InputStream Design Is Wrong</h1><aside class='book'><a href='http://goo.gl/W2WVMk'><img src='/images/books/elegant-objects/cover.png' class='book-cover'/></a>Read more about this subject in <a href='http://goo.gl/W2WVMk'>Section&nbsp;2.9</a><br/> of my book<a href='http://goo.gl/W2WVMk'><img src='/images/books/amazon-buy-button.png' class='amazon-button'/></a></aside><ul class="subline"> <li> <time itemprop="datePublished" datetime="2016-04-26T00:00:00+00:00"> 26 April 2016 </time> </li> <li class="desktop-only" itemprop="locationCreated">Washington, D.C.</li> <li class='unprintable desktop-only'><a href='https://github.com/yegor256/blog/commits/master/_posts/2016/apr/2016-04-26-why-inputstream-design-is-wrong.md'>modified</a> on <time itemprop='dateModified' datetime='2016-12-04T10:32:40+0200'>4 December 2016</time></li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="http://www.yegor256.com/2016/04/26/why-inputstream-design-is-wrong.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><p class="unprintable"><a href='/tag/java.html' class='tag notranslate'>java</a> <a href='/tag/oop.html' class='tag notranslate'><img src='/images/books/elegant-objects/cactus.svg' alt='OOP'/>oop</a></p><div class="buttons notranslate desktop-only"> <nav class="share"> <a href="http://www.facebook.com/sharer/sharer.php?u=http://www.yegor256.com/2016/04/26/why-inputstream-design-is-wrong.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=http://www.yegor256.com/2016/04/26/why-inputstream-design-is-wrong.html&amp;text=Why+InputStream+Design+Is+Wrong" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=http://www.yegor256.com/2016/04/26/why-inputstream-design-is-wrong.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=http://www.yegor256.com/2016/04/26/why-inputstream-design-is-wrong.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://www.stumbleupon.com/submit?url=http://www.yegor256.com/2016/04/26/why-inputstream-design-is-wrong.html&amp;title=Why+InputStream+Design+Is+Wrong" title="Share on StumbleUpon" class="button" rel="nofollow"> <span class="count count-stumbleupon">0</span> <i class="icon icon-stumbleupon notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=http://www.yegor256.com/2016/04/26/why-inputstream-design-is-wrong.html%3F2016-17&amp;title=Why+InputStream+Design+Is+Wrong" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=http://www.yegor256.com/2016/04/26/why-inputstream-design-is-wrong.html%3F2016-17&amp;t=Why+InputStream+Design+Is+Wrong" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav></div></header> <main> <article class="main" itemprop="articleBody"><p>It&#39;s not just about <code>InputSteam</code>, this class is a good example of a bad design. I&#39;m talking about three overloaded methods <code>read()</code>. I&#39;ve mentioned this problem in Section 2.9 of <a href="/elegant-objects.html">Elegant Objects</a>. In a few words, I strongly believe that interfaces must be &quot;functionality poor.&quot; <code>InputStream</code> should have been an interface in the first place and it should have had a single method <code>read(byte[])</code>. Then if its authors wanted to give us extra functionality, they should have created supplementary &quot;smart&quot; classes.</p><figure><img src='http://cf.jare.io/?u=http%3A%2F%2Fwww.yegor256.com%2Fimages%2F2016%2F04%2Fa-serious-man.jpg' style='width:600px;max-width:100%;' alt='A Serious Man (2009) by Coen Brothers'/><figcaption>A Serious Man (2009) by Coen Brothers</figcaption></figure><p>This is how it looks now:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">InputStream</span> <span class="o">{</span>
  <span class="kt">int</span> <span class="nf">read</span><span class="o">();</span>
  <span class="kt">int</span> <span class="nf">read</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">buffer</span><span class="o">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="o">,</span> <span class="kt">int</span> <span class="n">length</span><span class="o">);</span>
  <span class="kt">int</span> <span class="nf">read</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">buffer</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure><p>What&#39;s wrong? It&#39;s very convenient to have the ability to read a single byte, an array of bytes or even an array of bytes with a direct positioning into a specific place in the buffer!</p><p>However, we are still lacking a few methods: for reading the bytes and immediately saving into a file, converting to a text with a selected encoding, sending them by email and posting on Twitter. It would be great to have the features too, right in the poor <code>InputStream</code>. I hope the Oracle Java team is working on them now.</p><p>In the mean time, let&#39;s see what exactly is wrong with what these bright engineers designed for us already. Or maybe let me show how I would design <code>InputStream</code> and we&#39;ll compare:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">interface</span> <span class="nc">InputStream</span> <span class="o">{</span>
  <span class="kt">int</span> <span class="nf">read</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">buffer</span><span class="o">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="o">,</span> <span class="kt">int</span> <span class="n">length</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure><p>This is my design. The <code>InputStream</code> is responsible for reading bytes from the stream. There is one single method for this feature. Is it convenient for everybody? Does it read and post on Twitter? Not yet. Do we need that functionality? Of course we do, but it doesn&#39;t mean that we will add it to the interface. Instead, we will create supplementary &quot;smart&quot; class:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">interface</span> <span class="nc">InputStream</span> <span class="o">{</span>
  <span class="kt">int</span> <span class="nf">read</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">buffer</span><span class="o">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="o">,</span> <span class="kt">int</span> <span class="n">length</span><span class="o">);</span>
  <span class="kd">class</span> <span class="nc">Smart</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">InputStream</span> <span class="n">origin</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">Smart</span><span class="o">(</span><span class="n">InputStream</span> <span class="n">stream</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">this</span><span class="o">.</span><span class="na">origin</span> <span class="o">=</span> <span class="n">stream</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">read</span><span class="o">()</span> <span class="o">{</span>
      <span class="kd">final</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">buffer</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>
      <span class="kd">final</span> <span class="kt">int</span> <span class="n">read</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">origin</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">buffer</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">);</span>
      <span class="kd">final</span> <span class="kt">int</span> <span class="n">result</span><span class="o">;</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">read</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">result</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
      <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">buffer</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
      <span class="o">}</span>
      <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>Now, we want to read a single byte from the stream. Here is how:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">final</span> <span class="n">InputStream</span> <span class="n">input</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">FileInputStream</span><span class="o">(</span><span class="s">&quot;/tmp/a.txt&quot;</span><span class="o">);</span>
<span class="kd">final</span> <span class="kt">byte</span> <span class="n">b</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InputStream</span><span class="o">.</span><span class="na">Smart</span><span class="o">(</span><span class="n">input</span><span class="o">).</span><span class="na">read</span><span class="o">();</span></code></pre></figure><p>The functionality of reading a single byte is outside of <code>InputStream</code>, because this is not its business. The stream doesn&#39;t need to know how to manage the data after it is read. All the stream is <strong>responsible</strong> for is reading, not parsing or manipulating afterwards.</p><p>Interfaces must be small.</p><p>Obviously, method overloading in interfaces is a code smell. An interface with more than <strong>three methods</strong> is a good candidate for refactoring. If methods overload each other&mdash;it&#39;s serious trouble.</p><p>Interfaces must be small!</p><p>You may say that the creators of <code>InputStream</code> cared about performance, that&#39;s why allowed us to implement <code>read()</code> in three different forms. Then I have to ask again, why not create a method for reading and immediately post it on Twitter? That would be fantastically fast. Isn&#39;t it what we all want? A fast software which nobody has any desire to read or maintain.</p></article> </main> 
  <div class="unprintable">
    <h2>Related Posts</h2>
    <p>You may also find these posts interesting:</p>
    <ul>
      
        <li>
          <a href="/2016/08/15/what-is-wrong-object-oriented-programming.html" data-score="1.4825826218802485">What's Wrong With Object-Oriented Programming?</a>
        </li>
      
        <li>
          <a href="/2016/05/03/test-methods-must-share-nothing.html" data-score="0.47212368316542436">Test Methods Must Share Nothing</a>
        </li>
      
        <li>
          <a href="/2016/11/21/naked-data.html" data-score="0.4701432986099141">Encapsulation Covers Up Naked Data</a>
        </li>
      
        <li>
          <a href="/2016/06/21/how-to-hire-programmer.html" data-score="0.46129003504513405">How to Hire a Programmer</a>
        </li>
      
        <li>
          <a href="/2016/12/06/how-to-pay-programmers-less.html" data-score="0.4134055267132289">How to Pay Programmers Less</a>
        </li>
      
    </ul>
  </div>

</div><div class="disqus" role="complementary"><div id="disqus_thread" class="disqus-thread"></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0]; this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span>, 2014-<span itemprop="copyrightYear">2016</span></p></footer></div></section> <script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?f90e6b7"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> </body> </html>
