<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebPage"> <head> <script> (function(_,e,rr,s){_errs=[s];var c=_.onerror;_.onerror=function(){var a=arguments;_errs.push(a); c&&c.apply(this,a)};var b=function(){var c=e.createElement(rr),b=e.getElementsByTagName(rr)[0]; c.src="//beacon.errorception.com/"+s+".js";c.async=!0;b.parentNode.insertBefore(c,b)}; _.addEventListener?_.addEventListener("load",b,!1):_.attachEvent("onload",b)}) (window,document,"script","57c3846b0929bf2b09000494"); </script> <meta charset="utf-8"/> <meta itemprop="name" content="Defensive Programming via Validating Decorators" /> <meta itemprop="author" content="Yegor Bugayenko" /> <meta itemprop="breadcrumb" content="http://www.yegor256.com" /> <meta itemprop="keywords" content="check for null, defensive programming, startup failure stories, validate method arguments, validators in oop" /> <meta itemprop="description" content="Defensive programming is a good idea, but the way it gets implemented is, in most cases, very wrong; here is what I&apos;m suggesting instead. " /> <meta name="description" content="Defensive programming is a good idea, but the way it gets implemented is, in most cases, very wrong; here is what I&apos;m suggesting instead. " /> <meta name="keywords" content="check for null, defensive programming, startup failure stories, validate method arguments, validators in oop" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta property="twitter:account_id" content="4503599630178231" /> <meta property="og:url" content="http://www.yegor256.com/2016/01/26/defensive-programming.html"/> <meta property="og:site_name" content="yegor256"/> <meta property="og:title" content="Defensive Programming via Validating Decorators"/> <meta property="og:description" content="Defensive programming is a good idea, but the way it gets implemented is, in most cases, very wrong; here is what I&apos;m suggesting instead. "/> <meta property="og:type" content="article" /> <meta property="og:locale" content="en_US" /> <meta property="fb:admins" content="10203747823006002"/> <meta name="twitter:site" content="www.yegor256.com"/> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:url" content="http://www.yegor256.com/2016/01/26/defensive-programming.html"/> <meta property="article:author" content="https://www.facebook.com/yegor256"/> <meta name="p:domain_verify" content="61f09f0ef5db665328827225a3fc11bd"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?8154afd"/> <link rel="apple-touch-icon" href="/favicon.ico?8154afd"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="http://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?8154afd"/> <link rel="stylesheet" href="/css/icons.css?8154afd"/> <link rel="canonical" href="http://www.yegor256.com/2016/01/26/defensive-programming.html" /> <link rel="amphtml" href="http://www.yegor256.com/2016/01/26/defensive-programming.amp.html" /> <title>Defensive Programming via Validating Decorators - Yegor Bugayenko </title> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="show head menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub"><span>subscribe</span></a> <a href="/about-me.html"> <img src="//cf.jare.io/?u=http://www.yegor256.com/images/yegor-bugayenko-192x192.png" class="photo" alt="photo of Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="follow me in Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss" title="RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a href="https://github.com/yegor256" rel="nofollow" title="my GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="my StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a href="https://www.facebook.com/yegor256" rel="nofollow" title="follow me in Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a href="https://instagram.com/yegor256" rel="nofollow" title="follow me in Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="my LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a href="https://www.youtube.com/c/yegor256" rel="nofollow" title="my Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a href="https://www.pinterest.com/yegor256/" rel="nofollow" title="my Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a href="https://angel.co/yegor256" rel="nofollow" title="my AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://gitter.im/yegor256/elegantobjects" rel="nofollow" title="Gitter chat"><i class="icon icon-gitter notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="Podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="blog@yegor256.com"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="home page">home</a></li> <li><a href="/best.html" title="best articles to read">12&#160;best</a></li> <li><a href="/contents.html" title="blog contents">all&#160;203</a></li> <li><a href="/webinars.html" title="webinars">webinars</a></li> <li><a href="/talks.html" title="talks">talks</a></li> <li><a href="/books.html" title="books">books</a></li> <li><a href="/papers.html" title="papers">papers</a></li> <li><a href="/pets.html" title="pets">pets</a></li> <li><a href="/award.html" title="software quality award">award</a></li> <li><a href="/testimonials.html" title="what people say about me">testimonials</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search"> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input type="text" id="search-query" class="field field-text" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search" autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="search via Google" alt="search via Google"/> </form></div><div class="hot"><ul> <li> At <a href="/webinars.html">Webinar #19</a> we'll discuss the role of a <strong>project manager</strong> in a software project, join us on <b>November 2</b>, at 11am PST. </li> <li> Meet me at <a href="http://www.oredev.org/2016/speakers/yegor-bugayenko">Oredev</a> (Malm√∂/Nov-7), <a href="http://xpdays.com.ua/">XP Days</a> (Kiev/Nov-11), <a href="http://topconf.com/tallinn-2016/speaker/yegor-bugayenko/">TopConf</a> (Tallinn/Nov-16), <a href="http://devternity.com/#/11">DevTernity</a> (Riga/Dec-1), <a href="https://appdevtrends.com/ECG/live360events/Events/Orlando-2016/Information/AppDevTrends.aspx">AppDevTrends</a> (Orlando/Dec-7), and later <a href="/talks.html">somewhere else</a>. </li></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div itemprop="image" itemscope="" itemtype="http://schema.org/ImageObject"> <meta itemprop="url" content="http://www.yegor256.com/images/yegor-bugayenko-192x192.png"/> <meta itemprop="height" content="192"/> <meta itemprop="width" content="192"/></div><div itemscope="" itemprop="publisher" itemtype="http://schema.org/Organization"> <meta itemprop="name" content="yegor256.com"/><div itemprop="logo" itemscope="" itemtype="http://schema.org/ImageObject"> <meta itemprop="url" content="http://www.yegor256.com/images/yegor-bugayenko-192x192.png"/> <meta itemprop="height" content="192"/> <meta itemprop="width" content="192"/></div></div><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=http://www.yegor256.com/2016/01/26/defensive-programming.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">http://www.yegor256.com/2016/01/26/defensive-programming.html</code></p><h1 itemprop="name headline mainEntityOfPage">Defensive Programming via Validating Decorators</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2016-01-26T00:00:00+00:00"> 26 January 2016 </time> </li> <li class="desktop-only" itemprop="locationCreated">Palo Alto, CA</li> <li class='unprintable desktop-only'><a href='https://github.com/yegor256/blog/commits/master/_posts/2016/jan/2016-01-26-defensive-programming.md'>modified</a> on <time itemprop='dateModified' datetime='2016-05-08T18:09:56+0300'>8 May 2016</time></li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="http://www.yegor256.com/2016/01/26/defensive-programming.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><p class="unprintable"><a href='/tag/oop.html' class='tag notranslate'><img src='/images/books/elegant-objects/cactus.svg' alt='OOP'/>oop</a></p><div class="buttons notranslate desktop-only"> <nav class="share"> <a href="http://www.facebook.com/sharer/sharer.php?u=http://www.yegor256.com/2016/01/26/defensive-programming.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=http://www.yegor256.com/2016/01/26/defensive-programming.html&amp;text=Defensive+Programming+via+Validating+Decorators" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=http://www.yegor256.com/2016/01/26/defensive-programming.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=http://www.yegor256.com/2016/01/26/defensive-programming.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://www.stumbleupon.com/submit?url=http://www.yegor256.com/2016/01/26/defensive-programming.html&amp;title=Defensive+Programming+via+Validating+Decorators" title="Share on StumbleUpon" class="button" rel="nofollow"> <span class="count count-stumbleupon">0</span> <i class="icon icon-stumbleupon notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=http://www.yegor256.com/2016/01/26/defensive-programming.html%3F2016-04&amp;title=Defensive+Programming+via+Validating+Decorators" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=http://www.yegor256.com/2016/01/26/defensive-programming.html%3F2016-04&amp;t=Defensive+Programming+via+Validating+Decorators" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav></div></header> <main> <article class="main" itemprop="articleBody"><p>Do you check the input parameters of your methods for validity? I don&#39;t. I used to, but not anymore. I just let my methods crash with a null pointer and other exceptions when parameters are not valid. This may sound illogical, but only in the beginning. I&#39;m suggesting you use <strong>validating decorators</strong> instead.</p><figure><img src='http://cf.jare.io/?u=http%3A%2F%2Fwww.yegor256.com%2Fimages%2F2016%2F01%2Fshi-mian-mai-fu.jpg' style='width:600px;max-width:100%;' alt='Shi mian mai fu (2004) by Yimou Zhang'/><figcaption>Shi mian mai fu (2004) by Yimou Zhang</figcaption></figure><p>Let&#39;s take a look at this rather typical Java example:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">Report</span> <span class="o">{</span>
  <span class="kt">void</span> <span class="nf">export</span><span class="o">(</span><span class="n">File</span> <span class="n">file</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">file</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span>
        <span class="s">&quot;File is NULL; can&#39;t export.&quot;</span>
      <span class="o">);</span>
    <span class="o">}</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">file</span><span class="o">.</span><span class="na">exists</span><span class="o">())</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span>
        <span class="s">&quot;File already exists.&quot;</span>
      <span class="o">);</span>
    <span class="o">}</span>
    <span class="c1">// Export the report to the file</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>Pretty <a href="https://en.wikipedia.org/wiki/Defensive_programming">defensive</a>, right? If we remove these validations, the code will be much shorter, but it will crash with rather confusing messages if <code>NULL</code> is provided by the client. Moreover, if the file already exists, our <code>Report</code> will silently overwrite it. Pretty dangerous, right?</p><p>Yes, we must protect ourselves, and we must be defensive.</p><p>But not this way, not by bloating the class with validations that have nothing to do with its core functionality. Instead, we should use decorators to do the validation. Here is how. First, there must be an interface <code>Report</code>:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">interface</span> <span class="nc">Report</span> <span class="o">{</span>
  <span class="kt">void</span> <span class="nf">export</span><span class="o">(</span><span class="n">File</span> <span class="n">file</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure><p>Then, a class that implements the core functionality:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">DefaultReport</span> <span class="kd">implements</span> <span class="n">Report</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kt">void</span> <span class="nf">export</span><span class="o">(</span><span class="n">File</span> <span class="n">file</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Export the report to the file</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>And, finally, a number of decorators that will protect us:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">NoWriteOverReport</span> <span class="kd">implements</span> <span class="n">Report</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">Report</span> <span class="n">origin</span><span class="o">;</span>
  <span class="n">NoWriteOverReport</span><span class="o">(</span><span class="n">Report</span> <span class="n">rep</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">origin</span> <span class="o">=</span> <span class="n">rep</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="nd">@Override</span>
  <span class="kt">void</span> <span class="nf">export</span><span class="o">(</span><span class="n">File</span> <span class="n">file</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">file</span><span class="o">.</span><span class="na">exists</span><span class="o">())</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span>
        <span class="s">&quot;File already exists.&quot;</span>
      <span class="o">);</span>
    <span class="o">}</span>
    <span class="k">this</span><span class="o">.</span><span class="na">origin</span><span class="o">.</span><span class="na">export</span><span class="o">(</span><span class="n">file</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>Now, the client has the flexibility of composing a complex object from decorators that perform their specific tasks. The core object will do the reporting, while the decorators will validate parameters:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Report</span> <span class="n">report</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">NoNullReport</span><span class="o">(</span>
  <span class="k">new</span> <span class="nf">NoWriteOverReport</span><span class="o">(</span>
    <span class="k">new</span> <span class="nf">DefaultReport</span><span class="o">()</span>
  <span class="o">)</span>
<span class="o">);</span>
<span class="n">report</span><span class="o">.</span><span class="na">export</span><span class="o">(</span><span class="n">file</span><span class="o">);</span></code></pre></figure><p>What do we achieve with this approach? First and foremost: smaller objects. And smaller objects always mean higher <strong>maintainability</strong>. Our <code>DefaultReport</code> class will always remain small, no matter how many validations we may invent in the future. The more things we need to validate, the more validating decorators we will create. All of them will be small and cohesive. And we&#39;ll be able to put them together in different variations.</p><p>Besides that, this approach makes our code much more <strong>reusable</strong>, as classes perform very few operations and don&#39;t defend themselves by default. While being defensive is an important feature, we&#39;ll use validating decorators. But this will not always be the case. Sometimes validation is just too expensive in terms of time and memory, and we may want to work directly with objects that don&#39;t defend themselves.</p><p>I also decided not to use the Java Validation API anymore for the same reason. Its annotations make classes much more verbose and less cohesive. I&#39;m using validating decorators instead.</p></article> </main> 
  <div class="unprintable">
    <h2>Related Posts</h2>
    <p>You may also find these posts interesting:</p>
    <ul>
      
        <li>
          <a href="/2016/02/03/design-patterns-and-anti-patterns.html" data-score="1.9680427462490435">Design Patterns and Anti-Patterns, Love and Hate</a>
        </li>
      
        <li>
          <a href="/2016/08/15/what-is-wrong-object-oriented-programming.html" data-score="1.2294758850876788">What's Wrong With Object-Oriented Programming?</a>
        </li>
      
        <li>
          <a href="/2016/02/09/are-you-still-debugging.html" data-score="0.7680605043792645">Are You Still Debugging?</a>
        </li>
      
        <li>
          <a href="/2016/03/30/jare-instant-free-cdn.html" data-score="0.7592103554982068">Jare.io, an Instant and Free CDN</a>
        </li>
      
        <li>
          <a href="/2016/03/08/pimp-up-your-resume.html" data-score="0.7329083499655366">Pimp Up Your Resume</a>
        </li>
      
    </ul>
  </div>

</div><div class="disqus" role="complementary"><div id="disqus_thread" class="disqus-thread"></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0]; this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span>, 2014-<span itemprop="copyrightYear">2016</span></p></footer></div></section> <script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?8154afd"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> </body> </html>
