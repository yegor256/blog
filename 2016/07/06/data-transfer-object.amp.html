<!DOCTYPE html>
<html amp lang="en">
  <head>

    <meta charset="utf-8">
    <title>Data Transfer Object Is a Shame</title>
    <link rel="canonical" href="http://www.yegor256.com/2016/07/06/data-transfer-object.html">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "mainEntityOfPage":{
          "@type": "WebPage",
          "@id": "http://www.yegor256.com/2016/07/06/data-transfer-object.html"
        },
        "headline": "Data Transfer Object Is a Shame",
        "image": {
          "@type": "ImageObject",
          "url": "http://www.yegor256.com/images/face-1400x1400.jpg",
          "height": 1400,
          "width": 1400
        },
        "datePublished": "2016-07-06",
        "dateModified": "2016-07-06",
        "author": {
          "@type": "Person",
          "name": "Yegor Bugayenko"
        },
        "publisher": {
          "@type": "Organization",
          "name": "yegor256.com",
          "logo": {
            "@type": "ImageObject",
            "url": "http://www.yegor256.com/images/face-512x512.jpg",
            "width": 512,
            "height": 512
          }
        },
        "description": "DTO is a very popular design pattern, but it is
actually an anti-pattern in object-oriented programming
that has no right to exist.
",
        "keywords": ["DTO", "data transfer object", "DTO design pattern", "ORM DTO", "DTO in java"]
      }
    </script>
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style>
<noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <style amp-custom="amp-custom">
      body { padding: .5em; font-size: 1.2em; }
      article { width: 600px; max-width: 100%; margin-left: auto; margin-right: auto; }
      .intro { color: red; font-size: .75em; }
      .photo { border-radius: 50%; }
      pre { overflow-x:scroll; }
    </style>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
  </head>
  <body>
    <article>
      <p class="intro">
        This is a mobile version of the article,
        its original content can be found
        <a href="http://www.yegor256.com/2016/07/06/data-transfer-object.html">here</a>.
      </p>
      <p>
        <amp-img src="/images/yegor-bugayenko-192x192.png" width="80px" height="80px" alt="Yegor Bugayenko" class="photo"></amp-img>
      </p>
      <p>Yegor Bugayenko<br>6 July 2016</p>
      <h1>Data Transfer Object Is a Shame</h1>
      <p><a href="https://en.wikipedia.org/wiki/Data_transfer_object">DTO</a>,
as far as I understand it, is a cornerstone of the ORM design pattern,
which I <a href="/2014/12/01/orm-offensive-anti-pattern.html">simply "adore."</a>
But let's skip to the point: DTO is just a shame, and the man who invented
it is just wrong. There is no excuse for what he has done.</p>



<amp-img src="/images/2016/07/before-the-devil-knows-you-are-dead.jpg" alt="Before the Devil Knows You're Dead (2007) by Sidney Lumet" height="655" width="1200" layout="responsive"></amp-img>

<p>By the way, his name, to my knowledge, was
<a href="http://martinfowler.com/bliki/LocalDTO.html">Martin Fowler</a>. Maybe he
was not the sole inventor of DTO, but he made it legal and recommended
its use. With all due respect, he was just wrong.</p>



<p>The key idea of object-oriented programming is to hide data
behind objects. This idea has a name:
<a href="/2016/11/21/naked-data.html">encapsulation</a>.
In OOP, data
must not be visible. <a href="/2014/11/20/seven-virtues-of-good-object.html">Objects</a>
must only have access to the data they
encapsulate and never to the data encapsulated by other objects. There
can be no arguing about this principleâ€”it is what
<a href="/2016/08/15/what-is-wrong-object-oriented-programming.html">OOP</a> is all about.</p>

<p>However, DTO runs completely against that principle.</p>

<p>Let's see a practical example. Say that this is a service that fetches
a JSON document from some RESTful API and returns a DTO, which we can then
store in the database:</p>

<pre>Book book = api.loadBookById(123);
database.saveNewBook(book);</pre>

<p>I guess this is what will happen inside the <code>loadBookById()</code> method:</p>

<pre>Book loadBookById(int id) {
  JsonObject json = /* Load it from RESTful API */
  Book book = new Book();
  book.setISBN(json.getString("isbn"));
  book.setTitle(json.getString("title"));
  book.setAuthor(json.getString("author"));
  return book;
}</pre>

<p>Am I right? I bet I am. It already looks disgusting to me. Anyway, let's
continue. This is what will most likely happen in the <code>saveNewBook()</code> method
(I'm using pure JDBC):</p>

<pre>void saveNewBook(Book book) {
  Statement stmt = connection.prepareStatement(
    "INSERT INTO book VALUES (?, ?, ?)"
  );
  stmt.setString(1, book.getISBN());
  stmt.setString(2, book.getTitle());
  stmt.setString(3, book.getAuthor());
  stmt.execute();
}</pre>

<p>This <code>Book</code> is a classic example of a data transfer object design pattern.
All it does is transfer
data between two pieces of code, two procedures. The object <code>book</code> is pretty
dumb. All it knows how to do is ... nothing. It doesn't do anything. It is
actually not an object at all but rather a passive and anemic data structure.</p>

<p>What is the right design? There are a few. For example, this one looks
good to me:</p>

<pre>Book book = api.bookById(123);
book.save(database);</pre>

<p>This is what happens in <code>bookById()</code>:</p>

<pre>Book bookById(int id) {
  return new JsonBook(
    /* RESTful API access point */
  );
}</pre>

<p>This is what happens in <code>Book.save()</code>:</p>

<pre>void save(Database db) {
  JsonObject json = /* Load it from RESTful API */
  db.createBook(
    json.getString("isbn"),
    json.getString("title"),
    json.getString("author")
  );
}</pre>

<p>What happens if there are many more parameters of the book in JSON that won't
fit nicely as parameters into a single <code>createBook()</code> method? How about this:</p>

<pre>void save(Database db) {
  db.create()
    .withISBN(json.getString("isbn"))
    .withTitle(json.getString("title"))
    .withAuthor(json.getString("author"))
    .deploy();
}</pre>

<p>There are many other options. But the main point is that the data
<strong>never</strong> escapes the object <code>book</code>. Once the object is instantiated, the
data is not visible or accessible by anyone else. We may only
ask our object to save itself or to
<a href="/2016/04/05/printers-instead-of-getters.html">print</a>
itself to some media, but we
will never <a href="/2014/09/16/getters-and-setters-are-evil.html">get</a>
any data from it.</p>

<p>The very idea of DTO is wrong because it turns object-oriented code
into procedural code. We have procedures that manipulate data, and DTO is just
a box for that data. Don't think that way, and don't do that.</p>

<p>PS. There are a few another names of DTO:
<a href="https://en.wikipedia.org/wiki/Business_object">business objects</a>,
domain objects (not in <a href="https://en.wikipedia.org/wiki/Domain-driven_design">DDD</a>),
<a href="https://docs.oracle.com/cd/A97335_02/apps.102/bc4j/developing_bc_projects/bc_awhatisaneo.htm">entity objects</a>,
<a href="https://en.wikipedia.org/wiki/JavaBeans">JavaBeans</a>.</p>

    </article>
  </body>
</html>
