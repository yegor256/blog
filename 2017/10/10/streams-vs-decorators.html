<!doctypehtml><html xmlns="https://www.w3.org/1999/xhtml"lang="en-US"xml:lang="en-US"itemscope=""itemtype="http://schema.org/WebSite"><meta charset="utf-8"><meta name="description"content="Streams from Java 8 help us manipulate collections, but they ruin the idea of objects; decorators, on the other hand, do the same but in an object-oriented way."><meta name="keywords"content="decorators vs streams, guava vs streams, java streams, streams, streams API"><meta name="viewport"content="width=device-width,minimum-scale=1,initial-scale=1"><meta name="google-site-verification"content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8"><meta name="author"content="Yegor Bugayenko"><meta name="article:published_time"content="2017-10-10 00:00:00 +0000"><meta name="yandex-verification"content="7d2a0afee14d72bc"><meta name="og:site_name"content="Yegor Bugayenko"><meta name="og:type"content="article"><meta name="og:locale"content="en_US"><meta name="twitter:account_id"content="4503599630178231"><meta name="twitter:creator"content="@yegor256"><meta name="twitter:site"content="@yegor256"><meta name="twitter:title"property="og:title"content="Streams vs. Decorators"><meta name="twitter:description"property="og:description"content="Streams from Java 8 help us manipulate collections, but they ruin the idea of objects; decorators, on the other hand, do the same but in an object-oriented way."><meta name="twitter:url"property="og:url"content="https://www.yegor256.com/2017/10/10/streams-vs-decorators.html"><meta name="telegram:channel"content="AAAAAEJFMRzsRTRxM3ec6A"><link rel="search"type="application/opensearchdescription+xml"href="/opensearch.xml"title="yegor256"><link rel="icon"href="/favicon.ico?fa1fce7"type="image/x-icon"><link rel="shortcut icon"href="/favicon.ico?fa1fce7"><link rel="apple-touch-icon"href="/favicon.ico?fa1fce7"><link rel="alternate"type="application/rss+xml"title="RSS for yegor256.com"href="https://www.yegor256.com/rss.xml"><link rel="stylesheet"href="/css/layout.css?fa1fce7"><link rel="stylesheet"href="/css/icons.css?fa1fce7"><link rel="canonical"href="https://www.yegor256.com/2017/10/10/streams-vs-decorators.html"><title>Streams vs. Decorators</title><meta name="og:image"content="https://www.yegor256.com/images/2017/10/la-haine.jpg"><meta name="twitter:image"content="https://www.yegor256.com/images/2017/10/la-haine.jpg"><meta name="og:image:width"content="1280"><meta name="twitter:image:width"content="1280"><meta name="og:image:height"content="694"><meta name="twitter:image:height"content="694"><meta name="twitter:card"content="summary_large_image"><meta name="twitter:image:alt"content="La Haine (1995) by Mathieu Kassovitz"><div class="wrapper"><aside class="header-toggle unprintable"id="header-toggle"title="Show the menu"onclick='$("#header").show(),$("#header-toggle").hide()'>&#9776;</aside><header class="header"id="header"><div class="face"><a href="/about-me.html#form"class="sub"title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html"style="position:relative"><img src="/images/face-256x256.jpg"class="photo"alt="Yegor Bugayenko"></a></div><nav><ul class="menu social notranslate"><li><a href="https://twitter.com/intent/follow?screen_name=yegor256"rel="nofollow"title="Follow me on Twitter"><i class="icon icon-twitter notranslate"aria-hidden="true"></i></a><li><a href="/rss.xml"rel="nofollow"title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://github.com/yegor256"rel="nofollow"title="My GitHub profile"><i class="icon icon-github notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="http://stackoverflow.com/users/187141/yegor256"rel="nofollow"title="My Stack Overflow profile"><i class="icon icon-stackoverflow notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://www.facebook.com/yegor256"rel="nofollow"title="Follow me on Facebook"><i class="icon icon-facebook notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://instagram.com/yegor256"rel="nofollow"title="Follow me on Instagram"><i class="icon icon-instagram notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://www.linkedin.com/in/yegor256"rel="nofollow"title="My LinkedIn profile"><i class="icon icon-linkedin notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://www.youtube.com/c/yegor256?sub_confirmation=1"rel="nofollow"title="My Youtube video channel"><i class="icon icon-youtube notranslate"aria-hidden="true"></i></a><li><a href="https://soundcloud.com/yegor256"rel="nofollow"title="My podcast"><i class="icon icon-podcast notranslate"aria-hidden="true"></i></a><li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721"rel="nofollow"title="My iTunes podcast"><i class="icon icon-itunes notranslate"aria-hidden="true"></i></a><li><a href="https://t.me/yegor256news"rel="nofollow"title="My Telegram public channel"><i class="icon icon-telegram notranslate"aria-hidden="true"></i></a><li><a href="mailto:blog@yegor256.com"rel="nofollow"title="Email me any time"><i class="icon icon-mail notranslate"aria-hidden="true"></i></a></ul><ul class="menu"><li><a href="/"title="Home page">Home</a><li><a href="/best.html"title="Best articles to read">12&#160;Best</a><li><a href="/contents.html"title="The contents of the entire blog">All&#160;477</a><li><a href="/teaching.html"title="My courses and lectures">Teaching</a><li><a href="/talks.html"title="Future and past conference talks">Talks</a><li><a href="/books.html"title="The books I wrote">Books</a><li><a href="/research.html"title="My research directions and progress">Research</a><li><a href="/pets.html"title="My loved pet projects">Pets</a><li><a href="https://www.iccq.ru"title="International Conference on Code Quality">ICCQ</a><li><a href="https://www.kaicode.org"title="Open Source Festival">KaiCode</a><li><a href="/testimonials.html"title="What some people say about me">Testimonials</a><li><a href="/shift-m.html"title="Audio podcast about project management">Shift-M</a><li><a href="/paintings.html"title="My paintings for sale">Art</a></ul></nav><div class="search"><form action="https://www.google.com/search"itemprop="potentialAction"itemscope=""itemtype="http://schema.org/SearchAction"><meta itemprop="target"content="https://www.google.com/search?q={q}"><input name="sitesearch"value="yegor256.com"type="hidden"> <input itemprop="query-input"id="search-query"class="field field-text"required="required"onfocus='$(".google").css("visibility","visible")'name="q"placeholder="Search..."autocomplete="off"> <input type="image"src="/images/google-search-icon.svg"class="google"title="Search via Google"alt="Search via Google"></form></div><div class="hot"><ul><li>If you have an open source repository designed right, there is a chance to win up to $4,096 at <a href="https://www.kaicode.org">KaiCode'25</a>, our 8th annual open source festival. <a href="https://docs.google.com/forms/d/1nUlL2xvL1OOy3LoVF-g7MfB-9yeG68XB2wXW4MAoWrY">Submit</a> your project now, it's free!<li>Are you a Java developer? Ready to move to Moscow (Russia) and join my team for a full-time employment in Fortune-100 company? We are working with <a href="https://www.eolang.org">EO</a>, a new programming language. <a href="mailto:job@yegor256.com">Email me</a>, we'll discuss.</ul></div></header></div><section itemscope=""itemtype="http://schema.org/BlogPosting"><div class="wrapper"><header><p class="printable"><img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2017/10/10/streams-vs-decorators.html&amp;format=svg"style="width:125px;height:125px"alt="QR code"><p class="printable"><code itemprop="url">https://www.yegor256.com/171010.html</code><h1 itemprop="name headline mainEntityOfPage">Streams vs. Decorators</h1><ul class="subline"><li><time itemprop="datePublished"datetime="2017-10-10T00:00:00+00:00">10 October 2017</time><li class="desktop-only"itemprop="locationCreated">Odessa, Ukraine<li class="printable"itemscope=""itemprop="author"itemtype="http://schema.org/Person"><span itemprop="name">Yegor Bugayenko</span><li class="unprintable"><i class="icon icon-comments"></i> <a href="https://www.yegor256.com/2017/10/10/streams-vs-decorators.html#disqus_thread"itemprop="discussionUrl">comments</a></ul><ul class="unprintable subline"><li title="The page is translated by ChatGPT from English to a few languages">Translated by <i class="icon icon-chatgpt notranslate"aria-hidden="true"></i> to<li title="Click to see this page translated to Chinese"><a href="https://www.yegor256.com/zh/2017/10/10/streams-vs-decorators.html">中文</a><li title="Click to see this page translated to Russian"><a href="https://www.yegor256.com/ru/2017/10/10/streams-vs-decorators.html">русский</a></ul><ul class="subline"><li>Discussed at:<li><a href="https://dzone.com/articles/streams-vs-decorators">dzone</a></ul><p class="unprintable"><a href="/tag/java.html"class="tag notranslate"><img src="/images/icons/java-white.svg"alt="Java">java</a><nav class="buttons notranslate desktop-only"><a href="https://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2017/10/10/streams-vs-decorators.html"title="Share on Facebook"class="button"rel="nofollow"><span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate"aria-hidden="true"></i> </a><a href="https://twitter.com/share?url=https://www.yegor256.com/2017/10/10/streams-vs-decorators.html&amp;text=Streams+vs.+Decorators"title="Share on Twitter"class="button"rel="nofollow"><span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate"aria-hidden="true"></i> </a><a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2017/10/10/streams-vs-decorators.html"title="Share on LinkedIn"class="button"rel="nofollow"><span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate"aria-hidden="true"></i> </a><a href="https://reddit.com/submit?url=https://www.yegor256.com/2017/10/10/streams-vs-decorators.html%3F2017-41&amp;title=Streams+vs.+Decorators"title="Share on Reddit"class="button"rel="nofollow"><span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate"aria-hidden="true"></i> </a><a href="https://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2017/10/10/streams-vs-decorators.html%3F2017-41&amp;t=Streams+vs.+Decorators"title="Share on Hacker News"class="button"rel="nofollow"><span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate"aria-hidden="true"></i> </a><a href="#"title="Cite it via BibTeX"class="button"onclick='return $("#bibtex").toggle(),!1'><i class="icon icon-tex notranslate"aria-hidden="true"></i></a></nav></header><article class="main"itemprop="articleBody"><div><div id="bibtex"style="display:none"><p>Please, cite this blog post via <a href="https://www.bibtex.org/">BibTeX</a> as such:<pre style="color:#053c5e">@misc&#123;bugayenko2017blog1010,
  author = &#123;Bugayenko, Yegor&#125;,
  title = &#123;&#123;Streams vs. Decorators&#125;&#125;,
  howpublished = &#123;\url&#123;https://www.yegor256.com/171010.html&#125;&#125;,
  year = &#123;2017&#125;,
  month = &#123;oct&#125;,
  note = &#123;[Online; accessed 01-06-2025]&#125;
&#125;</pre></div><p>The <a href="https://www.oracle.com/technetwork/articles/java/ma14-java-se-8-streams-2177646.html">Streams API</a> was introduced in Java 8, together with <a href="http://openjdk.java.net/projects/lambda/">lambda expressions</a>, just a few years ago. I, as a disciplined Java adept, tried to use this new feature in a few of my projects, for example <a href="https://github.com/yegor256/jare/blob/0.11/src/main/java/io/jare/dynamo/DyUser.java#L85-L88">here</a> and <a href="https://github.com/yegor256/wring/blob/0.17.2/src/main/java/io/wring/dynamo/DyEvents.java#L95-L98">here</a>. I didn’t really like it and went back to good old decorators. Moreover, I created <a href="https://www.cactoos.org">Cactoos</a>, a library of decorators, to replace <a href="https://github.com/google/guava">Guava</a>, which is not so good in so many places.<figure class="jb_picture"><img itemprop="image"alt="La Haine (1995) by Mathieu Kassovitz"src="/images/2017/10/la-haine.jpg"longdesc="#f2d417e0"><figcaption id="f2d417e0">La Haine (1995) by Mathieu Kassovitz</figcaption></figure><p>Here is a primitive example. Let’s say we have a collection of measurements coming in from some data source, they are all numbers between zero and one:<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Iterable</span><span class="o">&lt;</span><span class="nc">Double</span><span class="o">&gt;</span> <span class="n">probes</span><span class="o">;</span>
</code></pre></div></div><p>Now, we need to show only the first 10 of them, ignoring zeros and ones, and re-scaling them to <code class="language-plaintext highlighter-rouge">(0..100)</code>. Sounds like an easy task, right? There are three ways to do it: procedural, object-oriented, and the Java 8 way. Let’s start with the procedural way:<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
<span class="k">for</span> <span class="o">(</span><span class="nc">Double</span> <span class="n">probe</span> <span class="o">:</span> <span class="n">probes</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">probe</span> <span class="o">==</span> <span class="mf">0.0d</span> <span class="o">||</span> <span class="n">probe</span> <span class="o">==</span> <span class="mf">1.0d</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">continue</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="k">if</span> <span class="o">(++</span><span class="n">pos</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">break</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span>
    <span class="s">"Probe #%d: %f"</span><span class="o">,</span> <span class="n">pos</span><span class="o">,</span> <span class="n">probe</span> <span class="o">*</span> <span class="mf">100.0d</span>
  <span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div><p>Why is this a procedural way? Because it’s imperative. Why is it imperative? Because it’s procedural. Nah, I’m kidding.<p>It’s imperative because we’re giving instructions to the computer about what data to put where and how to iterate through it. We’re not declaring the result, but imperatively building it. It works, but it’s not really scalable. We can’t take part of this algorithm and apply it to another use case. We can’t really modify it easily, for example to take numbers from two sources instead of one, etc. It’s procedural. Enough said. Don’t do it this way.<p>Now, Java 8 gives us the <a href="https://www.oracle.com/technetwork/articles/java/ma14-java-se-8-streams-2177646.html">Streams API</a>, which is supposed to offer a functional way to do the same. Let’s try to use it.<p>First, we need to create an instance of <a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html"><code class="language-plaintext highlighter-rouge">Stream</code></a>, which <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Iterable.html"><code class="language-plaintext highlighter-rouge">Iterable</code></a> <a href="https://stackoverflow.com/questions/23114015/">doesn’t</a> let us obtain directly. Then we use the stream API to do the job:<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">StreamSupport</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">probes</span><span class="o">.</span><span class="na">spliterator</span><span class="o">(),</span> <span class="kc">false</span><span class="o">)</span>
  <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">p</span> <span class="o">-&gt;</span> <span class="n">p</span> <span class="o">==</span> <span class="mf">0.0d</span> <span class="o">||</span> <span class="n">p</span> <span class="o">==</span> <span class="mf">1.0d</span><span class="o">)</span>
  <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">10L</span><span class="o">)</span>
  <span class="o">.</span><span class="na">forEach</span><span class="o">(</span>
    <span class="n">probe</span> <span class="o">-&gt;</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span>
      <span class="s">"Probe #%d: %f"</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">probe</span> <span class="o">*</span> <span class="mf">100.0d</span>
    <span class="o">)</span>
  <span class="o">);</span>
</code></pre></div></div><p>This will work, but will say <code class="language-plaintext highlighter-rouge">Probe #0</code> for all probes, because <code class="language-plaintext highlighter-rouge">forEach()</code> doesn’t work with indexes. There is no such thing as <code class="language-plaintext highlighter-rouge">forEachWithIndex()</code> in the <a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html"><code class="language-plaintext highlighter-rouge">Stream</code></a> interface as of Java 8 (and Java 9 <a href="http://download.java.net/java/jdk9/docs/api/java/util/stream/Stream.html">too</a>). Here is a <a href="https://stackoverflow.com/a/18552071/187141">workaround</a> with an atomic counter:<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">AtomicInteger</span> <span class="n">index</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AtomicInteger</span><span class="o">();</span>
<span class="nc">StreamSupport</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">probes</span><span class="o">.</span><span class="na">spliterator</span><span class="o">(),</span> <span class="kc">false</span><span class="o">)</span>
  <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">probe</span> <span class="o">-&gt;</span> <span class="n">probe</span> <span class="o">!=</span> <span class="mf">0.0d</span> <span class="o">&amp;&amp;</span> <span class="n">probe</span> <span class="o">!=</span> <span class="mf">1.0d</span><span class="o">)</span>
  <span class="o">.</span><span class="na">limit</span><span class="o">(</span><span class="mi">10L</span><span class="o">)</span>
  <span class="o">.</span><span class="na">forEach</span><span class="o">(</span>
    <span class="n">probe</span> <span class="o">-&gt;</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span>
      <span class="s">"Probe #%d: %f"</span><span class="o">,</span>
      <span class="n">index</span><span class="o">.</span><span class="na">getAndIncrement</span><span class="o">(),</span>
      <span class="n">probe</span> <span class="o">*</span> <span class="mf">100.0d</span>
    <span class="o">)</span>
  <span class="o">);</span>
</code></pre></div></div><p>“What’s wrong with that?” you may ask. First, see how easily we got into trouble when we didn’t find the right method in the <code class="language-plaintext highlighter-rouge">Stream</code> interface. We immediately fell off the “streaming” paradigm and got back to the good old procedural global variable (the counter). Second, we don’t really see what’s going on inside those <code class="language-plaintext highlighter-rouge">filter()</code>, <code class="language-plaintext highlighter-rouge">limit()</code>, and <code class="language-plaintext highlighter-rouge">forEach()</code> methods. How exactly do they work? The documentation says that this approach is “declarative” and each method in the <code class="language-plaintext highlighter-rouge">Stream</code> interface returns an instance of some class. What classes are they? We have no idea by just looking at this code.<aside class="quote">The biggest issue with this streaming API is the very interface Stream, it’s huge!</aside><p>These two problems are connected. The biggest issue with this streaming API is the very interface <code class="language-plaintext highlighter-rouge">Stream</code>—it’s huge. At the time of writing there are 43 methods. Forty three, in a single interface! This is against each and every <a href="/2014/11/20/seven-virtues-of-good-object.html">principle</a> of object-oriented programming, starting with <a href="/2017/03/28/solid.html">SOLID</a> and then up to more serious ones.<p>What is the object-oriented way to implement the same algorithm? Here is how I would do it with <a href="https://www.cactoos.org">Cactoos</a>, which is just a collection of <del>primitive</del> simple Java classes:<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">new</span> <span class="nc">And</span><span class="o">(</span>
  <span class="k">new</span> <span class="nc">Mapped</span><span class="o">&lt;</span><span class="nc">Double</span><span class="o">,</span> <span class="nc">Scalar</span><span class="o">&lt;</span><span class="nc">Boolean</span><span class="o">&gt;&gt;(</span>
    <span class="k">new</span> <span class="nc">Limited</span><span class="o">&lt;</span><span class="nc">Double</span><span class="o">&gt;(</span>
      <span class="k">new</span> <span class="nc">Filtered</span><span class="o">&lt;</span><span class="nc">Double</span><span class="o">&gt;(</span>
        <span class="n">probes</span><span class="o">,</span>
        <span class="n">probe</span> <span class="o">-&gt;</span> <span class="n">probe</span> <span class="o">!=</span> <span class="mf">0.0d</span> <span class="o">&amp;&amp;</span> <span class="n">probe</span> <span class="o">!=</span> <span class="mf">1.0d</span>
      <span class="o">),</span>
      <span class="mi">10</span>
    <span class="o">),</span>
    <span class="n">probe</span> <span class="o">-&gt;</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span>
        <span class="s">"Probe #%d: %f"</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">probe</span> <span class="o">*</span> <span class="mf">100.0d</span>
      <span class="o">);</span>
      <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>
  <span class="o">)</span>
<span class="o">).</span><span class="na">value</span><span class="o">();</span>
</code></pre></div></div><p>Let’s see what’s going on here. First, <a href="http://static.javadoc.io/org.cactoos/cactoos/0.16/org/cactoos/iterable/Filtered.html"><code class="language-plaintext highlighter-rouge">Filtered</code></a> decorates our iterable <code class="language-plaintext highlighter-rouge">probes</code> to take certain items out of it. Notice that <code class="language-plaintext highlighter-rouge">Filtered</code> implements <code class="language-plaintext highlighter-rouge">Iterable</code>. Then <a href="http://static.javadoc.io/org.cactoos/cactoos/0.16/org/cactoos/iterable/Limited.html"><code class="language-plaintext highlighter-rouge">Limited</code></a>, also being an <code class="language-plaintext highlighter-rouge">Iterable</code>, takes only the first ten items out. Then <a href="http://static.javadoc.io/org.cactoos/cactoos/0.16/org/cactoos/iterable/Mapped.html"><code class="language-plaintext highlighter-rouge">Mapped</code></a> converts each probe into an instance of <a href="http://static.javadoc.io/org.cactoos/cactoos/0.16/org/cactoos/Scalar.html"><code class="language-plaintext highlighter-rouge">Scalar&lt;Boolean&gt;</code></a>, which does the line printing.<p>Finally, the instance of <code class="language-plaintext highlighter-rouge">And</code> goes through the list of “scalars” and ask each of them to return <code class="language-plaintext highlighter-rouge">boolean</code>. They print the line and return <code class="language-plaintext highlighter-rouge">true</code>. Since it’s <code class="language-plaintext highlighter-rouge">true</code>, <code class="language-plaintext highlighter-rouge">And</code> makes the next attempt with the next scalar. Finally, its method <code class="language-plaintext highlighter-rouge">value()</code> returns <code class="language-plaintext highlighter-rouge">true</code>.<p>But wait, there are no indexes. Let’s add them. In order to do that we just use another class, called <code class="language-plaintext highlighter-rouge">AndWithIndex</code>:<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">new</span> <span class="nc">AndWithIndex</span><span class="o">(</span>
  <span class="k">new</span> <span class="nc">Mapped</span><span class="o">&lt;</span><span class="nc">Double</span><span class="o">,</span> <span class="nc">Func</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">Boolean</span><span class="o">&gt;&gt;(</span>
    <span class="k">new</span> <span class="nc">Limited</span><span class="o">&lt;</span><span class="nc">Double</span><span class="o">&gt;(</span>
      <span class="k">new</span> <span class="nc">Filtered</span><span class="o">&lt;</span><span class="nc">Double</span><span class="o">&gt;(</span>
        <span class="n">probes</span><span class="o">,</span>
        <span class="n">probe</span> <span class="o">-&gt;</span> <span class="n">probe</span> <span class="o">!=</span> <span class="mf">0.0d</span> <span class="o">&amp;&amp;</span> <span class="n">probe</span> <span class="o">!=</span> <span class="mf">1.0d</span>
      <span class="o">),</span>
      <span class="mi">10</span>
    <span class="o">),</span>
    <span class="n">probe</span> <span class="o">-&gt;</span> <span class="n">index</span> <span class="o">-&gt;</span> <span class="o">{</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span>
        <span class="s">"Probe #%d: %f"</span><span class="o">,</span> <span class="n">index</span><span class="o">,</span> <span class="n">probe</span> <span class="o">*</span> <span class="mf">100.0d</span>
      <span class="o">);</span>
      <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>
  <span class="o">)</span>
<span class="o">).</span><span class="na">value</span><span class="o">();</span>
</code></pre></div></div><p>Instead of <code class="language-plaintext highlighter-rouge">Scalar&lt;Boolean&gt;</code> we now map our probes to <a href="http://static.javadoc.io/org.cactoos/cactoos/0.16/org/cactoos/Func.html"><code class="language-plaintext highlighter-rouge">Func&lt;Integer, Boolean&gt;</code></a> to let them accept the index.<p>The beauty of this approach is that all classes and interfaces are small and that’s why they’re very composable. To make an iterable of probes limited we decorate it with <code class="language-plaintext highlighter-rouge">Limited</code>; to make it filtered we decorate it with <code class="language-plaintext highlighter-rouge">Filtered</code>; to do something else we create a new decorator and use it. We’re not stuck to one single interface like <code class="language-plaintext highlighter-rouge">Stream</code>.<p>The bottom line is that decorators are an object-oriented instrument to modify the behavior of collections, while streams is something else which I can’t even find the name for.<p>P.S. By the way, this is how the same algorithm can be implemented with the help of Guava’s <a href="https://google.github.io/guava/releases/21.0/api/docs/com/google/common/collect/Iterables.html"><code class="language-plaintext highlighter-rouge">Iterables</code></a>:<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Iterable</span><span class="o">&lt;</span><span class="nc">Double</span><span class="o">&gt;</span> <span class="n">ready</span> <span class="o">=</span> <span class="nc">Iterables</span><span class="o">.</span><span class="na">limit</span><span class="o">(</span>
  <span class="nc">Iterables</span><span class="o">.</span><span class="na">filter</span><span class="o">(</span>
    <span class="n">probes</span><span class="o">,</span>
    <span class="n">probe</span> <span class="o">-&gt;</span> <span class="n">probe</span> <span class="o">!=</span> <span class="mf">0.0d</span> <span class="o">&amp;&amp;</span> <span class="n">probe</span> <span class="o">!=</span> <span class="mf">1.0d</span>
  <span class="o">),</span>
  <span class="mi">10</span>
<span class="o">);</span>
<span class="kt">int</span> <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
<span class="k">for</span> <span class="o">(</span><span class="nc">Double</span> <span class="n">probe</span> <span class="o">:</span> <span class="n">probes</span><span class="o">)</span> <span class="o">{</span>
  <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span>
    <span class="s">"Probe #%d: %f"</span><span class="o">,</span> <span class="n">pos</span><span class="o">++,</span> <span class="n">probe</span> <span class="o">*</span> <span class="mf">100.0d</span>
  <span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div><p>This is some weird combination of object-oriented and functional styles.</div></article></div><div class="disqus"role="complementary"aria-hidden="true"><p class="disqus_hint">Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.<div id="disqus_thread"class="disqus-thread"><a>&nbsp;</a></div><script>var disqus_config=function(){this.page.url=document.location.href.split("?")[0].split("#")[0],this.page.identifier=this.page.url};(()=>{var e=document,t=e.createElement("script");t.src="//yegor256.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript><div><p class="red">JavaScript is disabled in your browser, that's why you can't see comments under this post.</div></noscript></div><div class="wrapper"><footer class="footer"><p>&copy; <span itemscope=""itemprop="copyrightHolder"itemtype="http://schema.org/Person"><span itemprop="name">Yegor Bugayenko</span> </span>, 2014&ndash;<span itemprop="copyrightYear">2025</span></footer></div></section><div class="wrapper unprintable"style="text-align:center;margin-top:2em"><a href="https://www.sixnines.io/h/3ba1652f"><img src="https://www.sixnines.io/b/3ba1652f?style=flat"alt="sixnines availability badge"></a>&nbsp; <a href="https://github.com/yegor256/blog/stargazers"><img src="https:https://img.shields.io/github/stars/yegor256/blog.svg?style=flat-square"alt="GitHub stars"></a></div><script src="https://code.jquery.com/jquery-1.9.0.min.js"></script><script src="/js/all.js?fa1fce7"></script><script type="application/ld+json">{ "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] }</script>