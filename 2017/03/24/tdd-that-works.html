<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" content="Test-driven development is a brilliant idea...if it works; in reality, it doesn't work the way most software books explain it." /> <meta name="keywords" content="automated testing, tdd, tdd doesn't work, tdd works, test-driven development" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2017-03-24 00:00:00 +0000"> <meta name="og:site_name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="The TDD That Works for Me"/> <meta name="twitter:description" property="og:description" content="Test-driven development is a brilliant idea...if it works; in reality, it doesn't work the way most software books explain it."/> <meta name="twitter:url" property="og:url" content="https://www.yegor256.com/2017/03/24/tdd-that-works.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?cf04cec28ae"/> <link rel="apple-touch-icon" href="/favicon.ico?cf04cec28ae"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="https://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?cf04cec28ae"/> <link rel="stylesheet" href="/css/icons.css?cf04cec28ae"/> <link rel="canonical" href="https://www.yegor256.com/2017/03/24/tdd-that-works.html" /> <title>The TDD That Works for Me </title> <meta name='og:image' content='https://www.yegor256.com/images/2017/03/la-grande-bellezza.jpg'/><meta name='twitter:image' content='https://www.yegor256.com/images/2017/03/la-grande-bellezza.jpg'/><meta name='og:image:width' content='1917'/> <meta name='twitter:image:width' content='1917'/><meta name='og:image:height' content='812'/> <meta name='twitter:image:height' content='812'/><meta name='twitter:card' content='summary_large_image'/><meta name='twitter:image:alt' content='La grande bellezza (2013) by Paolo Sorrentino'/> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" rel="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/yegor256news" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li ><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li ><a href="/contents.html" title="The contents of the entire blog">All&#160;362</a></li> <li ><a href="/webinars.html" title="My webinars">Webinars</a></li> <li ><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li ><a href="/books.html" title="The books I wrote">Books</a></li> <li ><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li ><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li ><a href="/award.html" title="Software quality award">Award</a></li> <li ><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li ><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li ><a href="/paintings.html" title="My paintings for sale">Art</a></li> <li><a href="https://ru.yegor256.com/" title="Немного на русском языке о политике в России, Украине и мире">Политика</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2017/03/24/tdd-that-works.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">https://www.yegor256.com/2017/03/24/tdd-that-works.html</code></p><h1 itemprop="name headline mainEntityOfPage">The TDD That Works for Me</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2017-03-24T00:00:00+00:00"> 24 March 2017 </time> </li> <li class="desktop-only" itemprop="locationCreated">Frankfurt, Germany</li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="http://www.yegor256.com/2017/03/24/tdd-that-works.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><p class="unprintable"><a href='/tag/tdd.html' class='tag notranslate'>tdd</a> <a href='/tag/testing.html' class='tag notranslate'>testing</a></p><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2017/03/24/tdd-that-works.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=https://www.yegor256.com/2017/03/24/tdd-that-works.html&amp;text=The+TDD+That+Works+for+Me" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2017/03/24/tdd-that-works.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=https://www.yegor256.com/2017/03/24/tdd-that-works.html%3F2017-12&amp;title=The+TDD+That+Works+for+Me" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2017/03/24/tdd-that-works.html%3F2017-12&amp;t=The+TDD+That+Works+for+Me" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <article class="main" itemprop="articleBody"><div ><p><a href="https://en.wikipedia.org/wiki/Test-driven_development">Test-driven development</a> (a.k.a. TDD) was <a href="https://www.quora.com/Why-does-Kent-Beck-refer-to-the-rediscovery-of-test-driven-development">rediscovered</a> by <a href="https://en.wikipedia.org/wiki/Kent_Beck">Kent Beck</a> and explained in <a href="http://amzn.to/2mTuxCs">his famous book</a> in 2002. In 2014, David Heinemeier Hansson (the creator of Ruby on Rails) said that TDD <a href="http://david.heinemeierhansson.com/2014/tdd-is-dead-long-live-testing.html">is dead</a> and only <a href="http://david.heinemeierhansson.com/2014/test-induced-design-damage.html">harms architecture</a>. <a href="https://en.wikipedia.org/wiki/Robert_Cecil_Martin">Robert Martin</a> (the inventor of the <a href="/2017/03/28/solid.html">SOLID principles</a>) <a href="https://8thlight.com/blog/uncle-bob/2014/04/25/MonogamousTDD.html">disagreed</a> and <a href="https://8thlight.com/blog/uncle-bob/2014/04/30/When-tdd-does-not-work.html">explained</a> that TDD may not work only in certain cases. A few days later, he even <a href="https://8thlight.com/blog/uncle-bob/2014/05/02/ProfessionalismAndTDD.html">compared</a> the importance of TDD with the importance of hand-washing for medicine, and added that “it would not surprise me if, one day, TDD had the force of law behind it.” Two years later, now just a few months ago, he wrote <a href="http://blog.cleancoder.com/uncle-bob/2017/03/03/TDD-Harms-Architecture.html">more</a> about it, and <a href="http://blog.cleancoder.com/uncle-bob/2017/03/06/TestingLikeTheTSA.html">more</a>, and <a href="http://blog.cleancoder.com/uncle-bob/2016/11/10/TDD-Doesnt-work.html">more</a>. This subject seems to be hot. Of course, I have my own take on it; let me share.</p><figure class="jb_picture"><img itemprop="image" alt="La grande bellezza (2013) by Paolo Sorrentino" src="/images/2017/03/la-grande-bellezza.jpg" longdesc="#91c781a0" /><figcaption id="91c781a0">La grande bellezza (2013) by Paolo Sorrentino</figcaption></figure><p>In theory, TDD means “writing tests first and code next.” In practice, according to <a href="https://www.zerocracy.com">my experience</a> while working with more than 250 developers over the last four years, it means writing tests when we’re in a good mood and have nothing else to do. And this is only logical, if we understand TDD literally, by <a href="https://en.wikipedia.org/wiki/Kent_Beck">the book</a>.</p><aside class="quote">I have never done TDD by the book: tests first and code next. </aside><p>Writing a test for a class without having that class in front of you is <em>difficult</em>. I would even say impossible, if we are talking about real code, not calculator examples. It’s also very <em>inefficient</em>, because tests by definition are much more rigid than the code they validate—creating them first will cause many re-do cycles until the design is stabilized.</p><p>I’ve personally <a href="https://github.com/yegor256">written</a> almost 300,000 lines of code in Java, Ruby, PHP, and JavaScript over the last four years, and I have never done TDD by the book: “write a test, make it run, make it right.” Ever.</p><h2 id="code-deploy-break-test-fix">Code, Deploy, Break, Test, Fix</h2><p>Even though I’m a huge fan of automated testing (unit or integration) and totally <a href="https://8thlight.com/blog/uncle-bob/2014/05/02/ProfessionalismAndTDD.html">agree</a> with Uncle Bob: Those who don’t write tests must be put <a href="/2015/11/24/imprisonment-for-irresponsible-coding.html">in jail</a>, I just have my own interpretation of TDD. This is how it looks:</p><figure class="unprintable"><object data="/images/2017/03/cdbtf.svg" type="image/svg+xml" itemprop="image" style="width:600px;max-width:100%;" alt="The figure"></object></figure><ul> <li><p>First, I write <strong>code</strong> without any tests. A lot of code. I implement the functionality and create the design. Dozens of classes. Of course, the build is automated, the deployment pipeline is configured, and I can test the product myself in a sandbox. I make sure “<a href="https://blog.codinghorror.com/the-works-on-my-machine-certification-program/">it works on my machine</a>.”</p></li> <li><p>Then, I <strong>deploy</strong> it to production. Yes, it goes to my “users” without any tests because it works for me. They are either real users if it’s something open source or one of my <a href="/pets.html">pet projects</a>, or manual testers if it’s a money project.</p></li> <li><p>Then, they <strong>break</strong> it. They either test it or they use it; it doesn’t matter. They just find problems and report bugs. As many as they can.</p></li> <li><p>Right after some bugs are reported, I pick the most critical of them and…voilà!…I create an automated <strong>test</strong>. The bug is a message to me that my tests are weak; I have to fix them first. A new test will prove that the code is broken. Or maybe I fix an existing one. This is where I go “tests first.” I don’t touch the production code until I manage to break my build and prove the problem’s existence with a new test. Then, I do <code class="highlighter-rouge">git commit.</code></p></li> <li><p>Finally, it’s time to <strong>fix</strong> the problem. I make changes to the production code in order to make sure the build is green again. Then, I do <code class="highlighter-rouge">git commit</code> and <code class="highlighter-rouge">git push.</code> And I go back to the “deploy” step; the updated product goes to my users.</p></li></ul><p>Once in a while, I have to make serious modifications to the product, like to introduce a new feature or perform a massive refactoring. In this case, I go back to the first step and do it without tests.</p><h2 id="the-reasoning-behind">The Reasoning Behind</h2><p>The justification behind this no-tests-upfront approach is simple: We don’t need to test until it’s broken, mostly because we understand that it’s technically not possible to test everything or to fix all bugs. We have to fix only what’s visible and intolerable by the business. If the business doesn’t care or our users/testers don’t see our bugs—we must not <em>waste</em> project resources on fixing them.</p><aside class="quote">I only create tests later when my users express the need for them by reporting bugs. </aside><p>On the other hand, when the business or our users/testers are complaining, we have to be very strict with ourselves; our testing system is weak and must be fixed first. We can’t just fix the production code and deploy, because in this case, we may make this mistake again after some refactoring, and our tests won’t catch it. The user will find the bug again, and the business will pay us again to fix it. That will be the <em>waste</em> of resources.</p><p>As you can see, it’s all money-driven. First, don’t fix anything if nobody pays for it. Second, fix it once and for all if they actually paid. It’s as simple as that.</p><h2 id="the-dynamics">The Dynamics</h2><p>Thanks to this test-and-fix-only-when-broken approach, the balance between production code and test code is not the same over the entire project lifecycle. When the project starts, there are almost no tests. Then, the number of tests grows together with the number of bugs. Eventually, the situation stabilizes, and we can move the product from beta version to the first release.</p><p>I created a simple <a href="https://github.com/yegor256/tdx">command line tool</a> in order to demonstrate the statistics from a few projects of mine, to prove my point. Take a look at these graphs:</p><p><a href="https://github.com/yegor256/takes">yegor256/takes</a> (Web framework, Java):</p><figure class="unprintable"><object data="/images/2017/03/cdbtf-takes.svg" type="image/svg+xml" itemprop="image" style="width:600px;max-width:100%;" alt="The figure"></object></figure><p><a href="https://github.com/yegor256/xembly">yegor256/xembly</a> (XML builder, Java):</p><figure class="unprintable"><object data="/images/2017/03/cdbtf-xembly.svg" type="image/svg+xml" itemprop="image" style="width:600px;max-width:100%;" alt="The figure"></object></figure><p><a href="https://github.com/jcabi/jcabi-aspects">jcabi/jcabi-aspects</a> (AOP library, Java):</p><figure class="unprintable"><object data="/images/2017/03/cdbtf-jcabi-aspects.svg" type="image/svg+xml" itemprop="image" style="width:600px;max-width:100%;" alt="The figure"></object></figure><p><a href="https://github.com/yegor256/s3auth">yegor256/s3auth</a> (S3 gateway, Java):</p><figure class="unprintable"><object data="/images/2017/03/cdbtf-s3auth.svg" type="image/svg+xml" itemprop="image" style="width:600px;max-width:100%;" alt="The figure"></object></figure><p>First commercial project:</p><figure class="unprintable"><object data="/images/2017/03/cdbtf-xockets-layer.svg" type="image/svg+xml" itemprop="image" style="width:600px;max-width:100%;" alt="The figure"></object></figure><p>Second commercial project:</p><figure class="unprintable"><object data="/images/2017/03/cdbtf-xockets-hadoop-transport.svg" type="image/svg+xml" itemprop="image" style="width:600px;max-width:100%;" alt="The figure"></object></figure><p>In each graph, there are two parts. The first one on the top demonstrates the dynamics of production <a href="/2014/11/14/hits-of-code.html">Hits-of-Code</a> (green line), test-related HoC (red line), and the number of issues reported to GitHub (orange line).</p><p>The bottom part shows how big the test-related HoC portion is relative to all project activity. In other words, it shows how much <em>effort</em> the project invested into automated tests, compared with the total effort.</p><p>This is what I want you to pay attention to: The shape of the curve is almost the same in every project. It looks very similar to a <a href="https://en.wikipedia.org/wiki/Learning_curve">learning curve</a>, where we start to learn fast and then slow down over time:</p><figure class="unprintable"><img src="/images/2017/03/cdbtf-graph.png" itemprop="image" style="width:450px;max-width:100%;" alt="The figure" /></figure><p>This perfectly illustrates what I just described above. I don’t need tests at the beginning of the project; I create them later when my users express the need for them by reporting bugs. This dynamic looks only logical to me.</p><p>You can also analyze your project using <a href="https://github.com/yegor256/tdx">my tool</a> and see the graph. It would be interesting to learn what kind of curve you will get.</p><blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">When do you write unit tests? <a href="https://twitter.com/hashtag/testing?src=hash&amp;ref_src=twsrc%5Etfw">#testing</a></p>&mdash; Yegor Bugayenko (@yegor256) <a href="https://twitter.com/yegor256/status/1094483307130060803?ref_src=twsrc%5Etfw">February 10, 2019</a></blockquote> <script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div></article></div><div class="wrapper"> <related-posts /></div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a>&nbsp;</a></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0].replace('https://', 'http://'); this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2021</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="https://www.sixnines.io/h/3ba1652f"> <img src="//www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge" /></a> &nbsp; <a href="https://github.com/yegor256/blog/stargazers"> <img src="//img.shields.io/github/stars/yegor256/blog.svg?style=flat-square" alt="GitHub stars" /></a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?cf04cec28ae"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html>
