<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US" itemscope="" itemtype="http://schema.org/WebSite"> <head> <meta charset="utf-8"/> <meta name="description" itemprop="description" content="Static factory methods are supposed to be a convenient replacement of object constructors; however, I disagree with this idea and explain why. " /> <meta name="keywords" itemprop="keywords" content="constructor or factory, constructors, factories vs constructiors, factory method, factory methods" /> <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/> <meta name="google-site-verification" content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8" /> <meta name="author" content="Yegor Bugayenko"> <meta name="article:published_time" content="2017-11-14 00:00:00 +0000"> <meta name="og:site_name" itemprop="name" content="Yegor Bugayenko"/> <meta name="og:type" content="article" /> <meta name="og:locale" content="en_US" /> <meta name="twitter:account_id" content="4503599630178231" /> <meta name="twitter:creator" content="@yegor256"/> <meta name="twitter:site" content="@yegor256"/> <meta name="twitter:title" property="og:title" content="Constructors or Static Factory Methods?"/> <meta name="twitter:description" property="og:description" content="Static factory methods are supposed to be a convenient replacement of object constructors; however, I disagree with this idea and explain why. "/> <meta name="twitter:url" property="og:url" content="http://www.yegor256.com/2017/11/14/static-factory-methods.html"/> <meta name="telegram:channel" content="AAAAAEJFMRzsRTRxM3ec6A"/> <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="yegor256" /> <link rel="shortcut icon" href="/favicon.ico?5cdc8885e85"/> <link rel="apple-touch-icon" href="/favicon.ico?5cdc8885e85"/> <link rel="alternate" type="application/rss+xml" title="RSS for yegor256.com" href="http://www.yegor256.com/rss.xml"/> <link rel="stylesheet" href="/css/layout.css?5cdc8885e85"/> <link rel="stylesheet" href="/css/icons.css?5cdc8885e85"/> <link rel="canonical" href="http://www.yegor256.com/2017/11/14/static-factory-methods.html" itemprop="url" /> <link rel="amphtml" href="http://www.yegor256.com/2017/11/14/static-factory-methods.amp.html" /> <title>Constructors or Static Factory Methods? </title> <meta name='og:image' content='http://www.yegor256.com/images/2017/11/extract.jpg'/><meta name='twitter:image' content='http://www.yegor256.com/images/2017/11/extract.jpg'/><meta name='og:image:width' content='1280'/> <meta name='twitter:image:width' content='1280'/><meta name='og:image:height' content='688'/> <meta name='twitter:image:height' content='688'/><meta name='twitter:card' content='summary_large_image'/><meta name='twitter:image:alt' content='Extract (2009) by Mike Judge'/> </head> <body><div class="wrapper"> <aside class="header-toggle unprintable" id="header-toggle" title="Show the menu" onclick="$('#header').show();$('#header-toggle').hide();">&#9776;</aside> <header class="header" id="header"><div class="face"> <a href="/about-me.html#form" class="sub" title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html" style="position:relative;"> <img src="//cf.jare.io/?u=http://www.yegor256.com/images/face-256x256.jpg" class="photo" alt="Yegor Bugayenko"/> </a></div><nav><ul class="menu social notranslate"> <li><a href="https://twitter.com/intent/follow?screen_name=yegor256" rel="nofollow" title="Follow me on Twitter"><i class="icon icon-twitter notranslate" aria-hidden="true"></i></a></li> <li><a href="/rss.xml" re="nofollow" title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://github.com/yegor256" rel="nofollow" title="My GitHub profile"><i class="icon icon-github notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="http://stackoverflow.com/users/187141/yegor256" rel="nofollow" title="My StackOverflow profile"><i class="icon icon-stackoverflow notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.facebook.com/yegor256" rel="nofollow" title="Follow me on Facebook"><i class="icon icon-facebook notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://instagram.com/yegor256" rel="nofollow" title="Follow me on Instagram"><i class="icon icon-instagram notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.linkedin.com/in/yegor256" rel="nofollow" title="My LinkedIn profile"><i class="icon icon-linkedin notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.youtube.com/c/yegor256?sub_confirmation=1" rel="nofollow" title="My Youtube video channel"><i class="icon icon-youtube notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://www.pinterest.com/yegor256/" rel="nofollow" title="My Pinterest boards"><i class="icon icon-pinterest notranslate" aria-hidden="true"></i></a></li> <li><a itemprop="sameAs" href="https://angel.co/yegor256" rel="nofollow" title="My AngelList profile"><i class="icon icon-angellist notranslate" aria-hidden="true"></i></a></li> <li><a href="https://soundcloud.com/yegor256" rel="nofollow" title="My podcast"><i class="icon icon-podcast notranslate" aria-hidden="true"></i></a></li> <li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721" rel="nofollow" title="My iTunes podcast"><i class="icon icon-itunes notranslate" aria-hidden="true"></i></a></li> <li><a href="https://t.me/joinchat/AAAAAEJFMRzsRTRxM3ec6A" rel="nofollow" title="My Telegram public channel"><i class="icon icon-telegram notranslate" aria-hidden="true"></i></a></li> <li><a href="mailto:blog@yegor256.com" rel="nofollow" title="Email me any time"><i class="icon icon-mail notranslate" aria-hidden="true"></i></a></li></ul><ul class="menu"> <li><a href="/" title="Home page">Home</a></li> <li><a href="/best.html" title="Best articles to read">12&#160;Best</a></li> <li><a href="/contents.html" title="The contents of the entire blog">All&#160;265</a></li> <li><a href="/webinars.html" title="My webinars">Webinars</a></li> <li><a href="/talks.html" title="Future and past conference talks">Talks</a></li> <li><a href="/books.html" title="The books I wrote">Books</a></li> <li><a href="/papers.html" title="My academic papers and patents">Papers</a></li> <li><a href="/pets.html" title="My loved pet projects">Pets</a></li> <li><a href="/award.html" title="Software quality award">Award</a></li> <li><a href="/testimonials.html" title="What some people say about me">Testimonials</a></li> <li><a href="/shift-m.html" title="Audio podcast about project management">Shift-M</a></li> <li><a href="/paintings.html" title="My paintings for sale">Paintings</a></li> <li><a href="http://ru.yegor256.com/" title="Немного на русском языке">По-русски</a></li></ul></nav><div class="search"> <form method="get" action="https://www.google.com/search" itemprop="potentialAction" itemscope="" itemtype="http://schema.org/SearchAction"> <meta itemprop="target" content="https://www.google.com/search?q={q}"/> <input name="sitesearch" value="yegor256.com" type="hidden"/> <input itemprop="query-input" type="text" id="search-query" class="field field-text" required="required" onfocus="$('.google').css('visibility', 'visible');" name="q" placeholder="Search..." autocomplete="off"/> <input type="image" src="/images/google-search-icon.svg" class="google" title="Search via Google" alt="Search via Google"/> </form></div><div class="hot"><ul> <li> I'm working on <a href="/code-ahead.html">Code Ahead</a>, my new fiction book about programmers, software engineering, management, and philosophy. It will be published in February. If you want to be its early reviewer, please fill out <a href="https://docs.google.com/forms/d/1nW8lD1YsW4x78iy2LreZ-FVoyoD5s5_MydVH9LGJImA">this form</a>. <li> <li> You can get <a href="/elegant-objects.html#stickers">cactus stickers</a> for your laptop, just by writing an honest five-stars review on Amazon for Elegant Objects; I will mail them to you free of charge. </li></ul></div></header></div><section itemscope="" itemtype="http://schema.org/BlogPosting"><div itemprop="review" itemscope="" itemtype="http://schema.org/Review"> <meta itemprop="author" content="Yegor Bugayenko"> <meta itemprop="itemReviewed" content="http://www.yegor256.com/2017/11/14/static-factory-methods.html"><div itemprop="reviewRating" itemscope="" itemtype="http://schema.org/Rating"> <meta itemprop="ratingValue" content="9"/> <meta itemprop="bestRating" content="10"/></div></div><div itemprop="image" itemscope="" itemtype="http://schema.org/ImageObject"> <meta itemprop="url" content="http://www.yegor256.com/images/face-256x256.jpg"/> <meta itemprop="height" content="256"/> <meta itemprop="width" content="256"/></div><div itemscope="" itemprop="publisher" itemtype="http://schema.org/Organization"> <meta itemprop="name" content="yegor256.com"/><div itemprop="logo" itemscope="" itemtype="http://schema.org/ImageObject"> <meta itemprop="url" content="http://www.yegor256.com/images/face-256x256.jpg"/> <meta itemprop="height" content="256"/> <meta itemprop="width" content="256"/></div></div><div class="wrapper"> <header><p class="printable"> <img src="https://api.qrserver.com/v1/create-qr-code/?data=http://www.yegor256.com/2017/11/14/static-factory-methods.html&amp;format=svg" style="width:125px;height:125px;" alt="QR code"/></p><p class="printable"> <code itemprop="url">http://www.yegor256.com/2017/11/14/static-factory-methods.html</code></p><h1 itemprop="name headline mainEntityOfPage">Constructors or Static Factory Methods?</h1><ul class="subline"> <li> <time itemprop="datePublished" datetime="2017-11-14T00:00:00+00:00"> 14 November 2017 </time> </li> <li class="desktop-only" itemprop="locationCreated">Odessa, Ukraine</li> <li class="printable" itemscope="" itemprop="author" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </li> <li class="unprintable"> <i class="icon icon-comments"></i> <a href="http://www.yegor256.com/2017/11/14/static-factory-methods.html#disqus_thread" itemprop="discussionUrl">comments</a> </li></ul><ul class="subline"> <li>Discussed at:</li> <li><a href="https://dzone.com/articles/constructors-or-static-factory-methods">dzone</a></li></ul><p class="unprintable"><a href='/tag/java.html' class='tag notranslate'><img src='/images/java-icon.svg' alt='Java'/>java</a> <a href='/tag/oop.html' class='tag notranslate'><img src='/images/books/elegant-objects/cactus.svg' alt='OOP'/>oop</a></p><nav class="buttons notranslate desktop-only"> <a href="http://www.facebook.com/sharer/sharer.php?u=http://www.yegor256.com/2017/11/14/static-factory-methods.html" title="Share on Facebook" class="button" rel="nofollow"> <span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate" aria-hidden="true"></i> </a> <a href="https://twitter.com/share?url=http://www.yegor256.com/2017/11/14/static-factory-methods.html&amp;text=Constructors+or+Static+Factory+Methods%3F" title="Share on Twitter" class="button" rel="nofollow"> <span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate" aria-hidden="true"></i> </a> <a href="https://plus.google.com/share?url=http://www.yegor256.com/2017/11/14/static-factory-methods.html" title="Share on Google+" class="button" rel="nofollow"> <span class="count count-googleplus">0</span> <i class="icon icon-googleplus notranslate" aria-hidden="true"></i> </a> <a href="https://www.linkedin.com/cws/share?url=http://www.yegor256.com/2017/11/14/static-factory-methods.html" title="Share on LinkedIn" class="button" rel="nofollow"> <span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate" aria-hidden="true"></i> </a> <a href="http://www.stumbleupon.com/submit?url=http://www.yegor256.com/2017/11/14/static-factory-methods.html&amp;title=Constructors+or+Static+Factory+Methods%3F" title="Share on StumbleUpon" class="button" rel="nofollow"> <span class="count count-stumbleupon">0</span> <i class="icon icon-stumbleupon notranslate" aria-hidden="true"></i> </a> <a href="http://reddit.com/submit?url=http://www.yegor256.com/2017/11/14/static-factory-methods.html%3F2017-46&amp;title=Constructors+or+Static+Factory+Methods%3F" title="Share on Reddit" class="button" rel="nofollow"> <span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate" aria-hidden="true"></i> </a> <a href="http://news.ycombinator.com/submitlink?u=http://www.yegor256.com/2017/11/14/static-factory-methods.html%3F2017-46&amp;t=Constructors+or+Static+Factory+Methods%3F" title="Share on Hacker News" class="button" rel="nofollow"> <span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate" aria-hidden="true"></i> </a> </nav> </header> <main> <article class="main" itemprop="articleBody"><div ><p>I believe Joshua Bloch said it first in his very good book &quot;<a href="http://amzn.to/2zgpiRI">Effective Java</a>&quot;: static factory methods are the preferred way to instantiate objects compared with constructors. I disagree. Not only because I believe that static methods are pure evil, but mostly because in this particular case they pretend to be good and make us think that we have to love them.</p><figure class='jb_picture'><img itemprop='image' alt='Extract (2009) by Mike Judge' src='/images/2017/11/extract.jpg' longdesc='#81adfef8'/><figcaption id='81adfef8'>Extract (2009) by Mike Judge</figcaption></figure><p>Let&#39;s analyze the reasoning and see why it&#39;s wrong, from an object-oriented point of view.</p><p>This is a class with one primary and two secondary constructors:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kd">class</span> <span class="nc">Color</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">hex</span><span class="o">;</span>
  <span class="n">Color</span><span class="o">(</span><span class="n">String</span> <span class="n">rgb</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">rgb</span><span class="o">,</span> <span class="mi">16</span><span class="o">));</span>
  <span class="o">}</span>
  <span class="n">Color</span><span class="o">(</span><span class="kt">int</span> <span class="n">red</span><span class="o">,</span> <span class="kt">int</span> <span class="n">green</span><span class="o">,</span> <span class="kt">int</span> <span class="n">blue</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">(</span><span class="n">red</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span> <span class="o">+</span> <span class="n">green</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">+</span> <span class="n">blue</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="n">Color</span><span class="o">(</span><span class="kt">int</span> <span class="n">h</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">hex</span> <span class="o">=</span> <span class="n">h</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>This is a similar class with three static factory methods:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kd">class</span> <span class="nc">Color</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">hex</span><span class="o">;</span>
  <span class="kd">static</span> <span class="n">Color</span> <span class="nf">makeFromRGB</span><span class="o">(</span><span class="n">String</span> <span class="n">rgb</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">rgb</span><span class="o">,</span> <span class="mi">16</span><span class="o">));</span>
  <span class="o">}</span>
  <span class="kd">static</span> <span class="n">Color</span> <span class="nf">makeFromPalette</span><span class="o">(</span><span class="kt">int</span> <span class="n">red</span><span class="o">,</span> <span class="kt">int</span> <span class="n">green</span><span class="o">,</span> <span class="kt">int</span> <span class="n">blue</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="n">red</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span> <span class="o">+</span> <span class="n">green</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">+</span> <span class="n">blue</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">static</span> <span class="n">Color</span> <span class="nf">makeFromHex</span><span class="o">(</span><span class="kt">int</span> <span class="n">h</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="n">h</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">private</span> <span class="nf">Color</span><span class="o">(</span><span class="kt">int</span> <span class="n">h</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">hex</span> <span class="o">=</span> <span class="n">h</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>Which one do you like better?</p><p>According to Joshua Bloch, there are three basic advantages to using static factory methods instead of constructors (there are actually four, but the fourth one is not applicable to Java <a href="https://docs.oracle.com/javase/7/docs/technotes/guides/language/type-inference-generic-instance-creation.html">anymore</a>):</p><ul> <li>They have names.</li> <li>They can cache.</li> <li>They can subtype.</li></ul><p>I believe that all three make perfect sense ... if the design is wrong. They are good excuses for workarounds. Let&#39;s take them one by one.</p><h2 id="they-have-names">They Have Names</h2><p>This is how you make a <a href="http://www.rapidtables.com/web/color/red-color.htm">red tomato</a> color object with a constructor:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="n">Color</span> <span class="n">tomato</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">255</span><span class="o">,</span> <span class="mi">99</span><span class="o">,</span> <span class="mi">71</span><span class="o">);</span></code></pre></figure><p>This is how you do it with a static factory method:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="n">Color</span> <span class="n">tomato</span> <span class="o">=</span> <span class="n">Color</span><span class="o">.</span><span class="na">makeFromPalette</span><span class="o">(</span><span class="mi">255</span><span class="o">,</span> <span class="mi">99</span><span class="o">,</span> <span class="mi">71</span><span class="o">);</span></code></pre></figure><p>It seems that <code>makeFromPalette()</code> is semantically richer than just <code>new Color()</code>, right? Well, yes. Who knows what those three numbers mean if we just pass them to the constructor. But the word &quot;palette&quot; helps us figure everything out immediately.</p><p>True.</p><p>However, the right solution would be to use polymorphism and encapsulation, to decompose the problem into a few semantically rich classes:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kd">interface</span> <span class="nc">Color</span> <span class="o">{</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">HexColor</span> <span class="kd">implements</span> <span class="n">Color</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">hex</span><span class="o">;</span>
  <span class="n">HexColor</span><span class="o">(</span><span class="kt">int</span> <span class="n">h</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">hex</span> <span class="o">=</span> <span class="n">h</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
<span class="kd">class</span> <span class="nc">RGBColor</span> <span class="kd">implements</span> <span class="n">Color</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">Color</span> <span class="n">origin</span><span class="o">;</span>
  <span class="n">RGBColor</span><span class="o">(</span><span class="kt">int</span> <span class="n">red</span><span class="o">,</span> <span class="kt">int</span> <span class="n">green</span><span class="o">,</span> <span class="kt">int</span> <span class="n">blue</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">origin</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HexColor</span><span class="o">(</span>
      <span class="n">red</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span> <span class="o">+</span> <span class="n">green</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">+</span> <span class="n">blue</span>
    <span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>Now, we use the right constructor of the right class:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="n">Color</span> <span class="n">tomato</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RGBColor</span><span class="o">(</span><span class="mi">255</span><span class="o">,</span> <span class="mi">99</span><span class="o">,</span> <span class="mi">71</span><span class="o">);</span></code></pre></figure><p>See, Joshua?</p><h2 id="they-can-cache">They Can Cache</h2><p>Let&#39;s say I need a red tomato color in multiple places in the application:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="n">Color</span> <span class="n">tomato</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">255</span><span class="o">,</span> <span class="mi">99</span><span class="o">,</span> <span class="mi">71</span><span class="o">);</span>
<span class="c1">// ... sometime later</span>
<span class="n">Color</span> <span class="n">red</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="mi">255</span><span class="o">,</span> <span class="mi">99</span><span class="o">,</span> <span class="mi">71</span><span class="o">);</span></code></pre></figure><p>Two objects will be created, which is obviously inefficient, since they are identical. It would be better to keep the first instance somewhere in memory and return it when the second call arrives. Static factory methods make it possible to solve this very problem:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="n">Color</span> <span class="n">tomato</span> <span class="o">=</span> <span class="n">Color</span><span class="o">.</span><span class="na">makeFromPalette</span><span class="o">(</span><span class="mi">255</span><span class="o">,</span> <span class="mi">99</span><span class="o">,</span> <span class="mi">71</span><span class="o">);</span>
<span class="c1">// ... sometime later</span>
<span class="n">Color</span> <span class="n">red</span> <span class="o">=</span> <span class="n">Color</span><span class="o">.</span><span class="na">makeFromPalette</span><span class="o">(</span><span class="mi">255</span><span class="o">,</span> <span class="mi">99</span><span class="o">,</span> <span class="mi">71</span><span class="o">);</span></code></pre></figure><p>Then somewhere inside the <code>Color</code> we keep a private static <code>Map</code> with all the objects already instantiated:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kd">class</span> <span class="nc">Color</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Color</span><span class="o">&gt;</span> <span class="n">CACHE</span> <span class="o">=</span>
    <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">hex</span><span class="o">;</span>
  <span class="kd">static</span> <span class="n">Color</span> <span class="nf">makeFromPalette</span><span class="o">(</span><span class="kt">int</span> <span class="n">red</span><span class="o">,</span> <span class="kt">int</span> <span class="n">green</span><span class="o">,</span> <span class="kt">int</span> <span class="n">blue</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">final</span> <span class="kt">int</span> <span class="n">hex</span> <span class="o">=</span> <span class="n">red</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span> <span class="o">+</span> <span class="n">green</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">+</span> <span class="n">blue</span><span class="o">;</span>
    <span class="k">return</span> <span class="n">Color</span><span class="o">.</span><span class="na">CACHE</span><span class="o">.</span><span class="na">computeIfAbsent</span><span class="o">(</span>
      <span class="n">hex</span><span class="o">,</span> <span class="n">h</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="n">h</span><span class="o">)</span>
    <span class="o">);</span>
  <span class="o">}</span>
  <span class="kd">private</span> <span class="nf">Color</span><span class="o">(</span><span class="kt">int</span> <span class="n">h</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="n">h</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>It is very effective performance-wise. With a small object like our <code>Color</code> the problem may not be so obvious, but when objects are bigger, their instantiation and garbage collection may waste a lot of time.</p><p>True.</p><p>However, there is an object-oriented way to solve this problem. We just introduce a new class <code>Palette</code>, which becomes a store of colors:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kd">class</span> <span class="nc">Palette</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">Color</span><span class="o">&gt;</span> <span class="n">colors</span> <span class="o">=</span>
    <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
  <span class="n">Color</span> <span class="nf">take</span><span class="o">(</span><span class="kt">int</span> <span class="n">red</span><span class="o">,</span> <span class="kt">int</span> <span class="n">green</span><span class="o">,</span> <span class="kt">int</span> <span class="n">blue</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">final</span> <span class="kt">int</span> <span class="n">hex</span> <span class="o">=</span> <span class="n">red</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span> <span class="o">+</span> <span class="n">green</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">+</span> <span class="n">blue</span><span class="o">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">computerIfAbsent</span><span class="o">(</span>
      <span class="n">hex</span><span class="o">,</span> <span class="n">h</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="n">h</span><span class="o">)</span>
    <span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>Now, we make an instance of <code>Palette</code> once and ask it to return a color to us every time we need it:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="n">Color</span> <span class="n">tomato</span> <span class="o">=</span> <span class="n">palette</span><span class="o">.</span><span class="na">take</span><span class="o">(</span><span class="mi">255</span><span class="o">,</span> <span class="mi">99</span><span class="o">,</span> <span class="mi">71</span><span class="o">);</span>
<span class="c1">// Later we will get the same instance:</span>
<span class="n">Color</span> <span class="n">red</span> <span class="o">=</span> <span class="n">palette</span><span class="o">.</span><span class="na">take</span><span class="o">(</span><span class="mi">255</span><span class="o">,</span> <span class="mi">99</span><span class="o">,</span> <span class="mi">71</span><span class="o">);</span></code></pre></figure><p>See, Joshua, no static methods, no static attributes.</p><h2 id="they-can-subtype">They Can Subtype</h2><p>Let&#39;s say our class <code>Color</code> has a method <code>lighter()</code>, which is supposed to shift the color to the next available lighter one:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kd">class</span> <span class="nc">Color</span> <span class="o">{</span>
  <span class="kd">protected</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">hex</span><span class="o">;</span>
  <span class="n">Color</span><span class="o">(</span><span class="kt">int</span> <span class="n">h</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">hex</span> <span class="o">=</span> <span class="n">h</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="kd">public</span> <span class="n">Color</span> <span class="nf">lighter</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">Color</span><span class="o">(</span><span class="n">hex</span> <span class="o">+</span> <span class="mh">0x111</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>However, sometimes it&#39;s more desirable to pick the next lighter color through a set of available <a href="https://en.wikipedia.org/wiki/Pantone">Pantone</a> colors:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kd">class</span> <span class="nc">PantoneColor</span> <span class="kd">extends</span> <span class="n">Color</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">PantoneName</span> <span class="n">pantone</span><span class="o">;</span>
  <span class="n">PantoneColor</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">(</span><span class="k">new</span> <span class="n">PantoneName</span><span class="o">(</span><span class="n">name</span><span class="o">));</span>
  <span class="o">}</span>
  <span class="n">PantoneColor</span><span class="o">(</span><span class="n">PantoneName</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">pantone</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">Color</span> <span class="nf">lighter</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">PantoneColor</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">pantone</span><span class="o">.</span><span class="na">up</span><span class="o">());</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>Then, we create a static factory method, which will decide which <code>Color</code> implementation is the most suitable for us:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kd">class</span> <span class="nc">Color</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">code</span><span class="o">;</span>
  <span class="kd">static</span> <span class="n">Color</span> <span class="nf">make</span><span class="o">(</span><span class="kt">int</span> <span class="n">h</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">h</span> <span class="o">==</span> <span class="mh">0xBF1932</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="k">new</span> <span class="n">PantoneColor</span><span class="o">(</span><span class="s">&quot;19-1664 TPX&quot;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">RGBColor</span><span class="o">(</span><span class="n">h</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>If the <a href="https://www.pantone.com/color-finder/19-1664-TPX">true red</a> color is requested, we return an instance of <code>PantoneColor</code>. In all other cases it&#39;s just a standard <code>RGBColor</code>. The decision is made by the static factory method. This is how we will call it:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="n">Color</span> <span class="n">color</span> <span class="o">=</span> <span class="n">Color</span><span class="o">.</span><span class="na">make</span><span class="o">(</span><span class="mh">0xBF1932</span><span class="o">);</span></code></pre></figure><p>It would not be possible to do the same &quot;forking&quot; with a constructor, since it can only return the class it is declared in. A static method has all the necessary freedom to return any subtype of <code>Color</code>.</p><p>True.</p><p>However, in an object-oriented world we can and must do it all differently. First, we would make <code>Color</code> an interface:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kd">interface</span> <span class="nc">Color</span> <span class="o">{</span>
  <span class="n">Color</span> <span class="nf">lighter</span><span class="o">();</span>
<span class="o">}</span></code></pre></figure><p>Next, we would move this decision making process to its own class <code>Colors</code>, just like we did in the previous example:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kd">class</span> <span class="nc">Colors</span> <span class="o">{</span>
  <span class="n">Color</span> <span class="nf">make</span><span class="o">(</span><span class="kt">int</span> <span class="n">h</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">h</span> <span class="o">==</span> <span class="mh">0xBF1932</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="k">new</span> <span class="n">PantoneColor</span><span class="o">(</span><span class="s">&quot;19-1664-TPX&quot;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">RGBColor</span><span class="o">(</span><span class="n">h</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>And we would use an instance of class <code>Colors</code> instead of a static faсtory method inside <code>Color</code>:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="n">colors</span><span class="o">.</span><span class="na">make</span><span class="o">(</span><span class="mh">0xBF1932</span><span class="o">);</span></code></pre></figure><p>However, this is still not really an object-oriented way of thinking, because we&#39;re taking the decision-making away from the object it belongs to. Either through a static factory method <code>make()</code> or a new class <code>Colors</code>&mdash;it doesn&#39;t really matter how&mdash;we tear our objects into two pieces. The first piece is the object itself and the second one is the decision making algorithm that stays somewhere else.</p><p>A much more object-oriented design would be to put the logic into an object of class <code>PantoneColor</code> which would decorate the original <code>RGBColor</code>:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="kd">class</span> <span class="nc">PantoneColor</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">final</span> <span class="n">Color</span> <span class="n">origin</span><span class="o">;</span>
  <span class="n">PantoneColor</span><span class="o">(</span><span class="n">Color</span> <span class="n">color</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">origin</span> <span class="o">=</span> <span class="n">color</span><span class="o">;</span>
  <span class="o">}</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">Color</span> <span class="nf">lighter</span><span class="o">()</span> <span class="o">{</span>
    <span class="kd">final</span> <span class="n">Color</span> <span class="n">next</span><span class="o">;</span>
    <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">origin</span><span class="o">.</span><span class="na">hex</span><span class="o">()</span> <span class="o">==</span> <span class="mh">0xBF1932</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">next</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RGBColor</span><span class="o">(</span><span class="mh">0xD12631</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      <span class="n">next</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">origin</span><span class="o">.</span><span class="na">lighter</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">PantoneColor</span><span class="o">(</span><span class="n">next</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">)</span></code></pre></figure><p>Then, we make an instance of <code>RGBColor</code> and decorate it with <code>PantoneColor</code>:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="n">Color</span> <span class="n">red</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PantoneColor</span><span class="o">(</span>
  <span class="k">new</span> <span class="n">RGBColor</span><span class="o">(</span><span class="mh">0xBF1932</span><span class="o">)</span>
<span class="o">);</span></code></pre></figure><p>We ask <code>red</code> to return a lighter color and it returns the one from the Pantone palette, not the one that is merely lighter in RGB coordinates:</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span></span><span class="n">Color</span> <span class="n">lighter</span> <span class="o">=</span> <span class="n">red</span><span class="o">.</span><span class="na">lighter</span><span class="o">();</span> <span class="c1">// 0xD12631</span></code></pre></figure><p>Of course, this example is rather primitive and needs <a href="/2016/12/20/can-objects-be-friends.html">further improvement</a> if we really want it to be applicable to all Pantone colors, but I hope you get the idea. The logic must stay <em>inside</em> the class, not somewhere outside, not in static factory methods or even in some other supplementary class. I&#39;m talking about the logic that belongs to this particular class, of course. If it&#39;s something related to the management of class instances, then there can be containers and stores, just like in the previous example above.</p><p>To summarize, I would strongly recommend you <em>never</em> use static methods, especially when they are going to replace object constructors. Giving birth to an object through its constructor is <a href="/2014/10/03/di-containers-are-evil.html">the most</a> &quot;sacred&quot; moment in any object-oriented software, don&#39;t miss the beauty of it.</p></div></article> </main></div><div class="wrapper"> 
  <div class="unprintable">
    <hr/>
    <p>
      You may also find these <strong>related</strong> posts interesting:
      
        <a href="/2018/01/02/operator-new-is-toxic.html" data-score="0.322338219827959">Operator new() is Toxic</a>;
      
        <a href="/2017/12/19/srp-is-hoax.html" data-score="0.2991081493401595">SRP is a Hoax</a>;
      
        <a href="/2018/01/16/educational-aspect-of-static-analysis.html" data-score="0.21862487059051974">The Educational Aspect of Static Analysis</a>;
      
        <a href="/2017/02/07/private-method-is-new-class.html" data-score="0.2065343678209209">Each Private Static Method Is a Candidate for a New Class</a>;
      
        <a href="/2017/12/05/data-access-object.html" data-score="0.20541219553752713">DAO is Yet Another OOP Shame</a>;
      
    </p>
  </div>

</div><div class="disqus" role="complementary"><p class="disqus_hint"> Please, use <a href="https://help.disqus.com/customer/portal/articles/665057-syntax-highlighting">syntax highlighting</a> in your comments, to make them more readable.</p><div id="disqus_thread" class="disqus-thread"> <a/></div><script> var disqus_config = function () { this.page.url = document.location.href.split('?')[0].split('#')[0]; this.page.identifier = this.page.url; }; (function() { var d = document, s = d.createElement('script'); s.src = '//yegor256.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript><div><p class="red"> JavaScript is disabled in your browser, that's why you can't see comments under this post.</p></div></noscript></div><div class="wrapper"> <footer class="footer"><p> &copy; <span itemscope="" itemprop="copyrightHolder" itemtype="http://schema.org/Person"> <span itemprop="name">Yegor Bugayenko</span> </span> 2014&ndash;<span itemprop="copyrightYear">2018</span></p></footer></div></section><div class="wrapper unprintable" style="text-align:center;margin-top:2em;"> <a href="http://www.sixnines.io/h/3ba1652f"> <img src="http://www.sixnines.io/b/3ba1652f?style=flat" alt="sixnines availability badge"/> </a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script> <script src="/js/all.js?5cdc8885e85"></script> <script>var disqus_shortname = 'yegor256';</script> <script id="dsq-count-scr" src="//yegor256.disqus.com/count.js" async="async"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-1963507-32', 'auto'); ga('send', 'pageview'); </script> <script language="javascript" type="text/javascript"> Cd=document;Cr="&"+Math.random();Cp="&s=1"; Cd.cookie="b=b";if(Cd.cookie)Cp+="&c=1"; Cp+="&t="+(new Date()).getTimezoneOffset(); if(self!=top)Cp+="&f=1"; </script> <script language="javascript1.1" type="text/javascript"> if(navigator.javaEnabled())Cp+="&j=1"; </script> <script language="javascript1.2" type="text/javascript"> if(typeof(screen)!='undefined')Cp+="&w="+screen.width+"&h="+ screen.height+"&d="+(screen.colorDepth?screen.colorDepth:screen.pixelDepth); </script> <script language="javascript" type="text/javascript"> Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+ "&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+ "' border='0' wi"+"dth='1' he"+"ight='1'/>"); </script> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "http://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] } </script> </body> </html>
