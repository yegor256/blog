<!doctypehtml><html xmlns="https://www.w3.org/1999/xhtml"lang="en-US"xml:lang="en-US"itemscope=""itemtype="http://schema.org/WebSite"><meta charset="utf-8"><meta name="description"content="In object-oriented programming, the more visible and accessible object attributes are, the lower the maintainability of the code around it."><meta name="keywords"content=""><meta name="viewport"content="width=device-width,minimum-scale=1,initial-scale=1"><meta name="google-site-verification"content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8"><meta name="author"content="Yegor Bugayenko"><meta name="og:site_name"content="Yegor Bugayenko"><meta name="og:type"content="article"><meta name="og:locale"content="en_US"><meta name="twitter:account_id"content="4503599630178231"><meta name="twitter:creator"content="@yegor256"><meta name="twitter:site"content="@yegor256"><meta name="twitter:title"property="og:title"content="How Data Visibility Hurts Maintainability"><meta name="twitter:description"property="og:description"content="In object-oriented programming, the more visible and accessible object attributes are, the lower the maintainability of the code around it."><meta name="twitter:url"property="og:url"content="https://www.yegor256.com/zh/2019/03/12/data-and-maintainability.html"><meta name="telegram:channel"content="AAAAAEJFMRzsRTRxM3ec6A"><link rel="search"type="application/opensearchdescription+xml"href="/opensearch.xml"title="yegor256"><link rel="shortcut icon"href="/favicon.ico?0ab463c57dc"><link rel="apple-touch-icon"href="/favicon.ico?0ab463c57dc"><link rel="alternate"type="application/rss+xml"title="RSS for yegor256.com"href="https://www.yegor256.com/rss.xml"><link rel="stylesheet"href="/css/layout.css?0ab463c57dc"><link rel="stylesheet"href="/css/icons.css?0ab463c57dc"><link rel="canonical"href="https://www.yegor256.com/zh/2019/03/12/data-and-maintainability.html"><title>How Data Visibility Hurts Maintainability</title><div class="wrapper"><aside class="header-toggle unprintable"id="header-toggle"title="Show the menu"onclick='$("#header").show(),$("#header-toggle").hide()'>&#9776;</aside><header class="header"id="header"><div class="face"><a href="/about-me.html#form"class="sub"title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html"style="position:relative"><img src="/images/face-256x256.jpg"class="photo"alt="Yegor Bugayenko"></a></div><nav><ul class="menu social notranslate"><li><a href="https://twitter.com/intent/follow?screen_name=yegor256"rel="nofollow"title="Follow me on Twitter"><i class="icon icon-twitter notranslate"aria-hidden="true"></i></a><li><a href="/rss.xml"rel="nofollow"title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://github.com/yegor256"rel="nofollow"title="My GitHub profile"><i class="icon icon-github notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="http://stackoverflow.com/users/187141/yegor256"rel="nofollow"title="My Stack Overflow profile"><i class="icon icon-stackoverflow notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://www.facebook.com/yegor256"rel="nofollow"title="Follow me on Facebook"><i class="icon icon-facebook notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://instagram.com/yegor256"rel="nofollow"title="Follow me on Instagram"><i class="icon icon-instagram notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://www.linkedin.com/in/yegor256"rel="nofollow"title="My LinkedIn profile"><i class="icon icon-linkedin notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://www.youtube.com/c/yegor256?sub_confirmation=1"rel="nofollow"title="My Youtube video channel"><i class="icon icon-youtube notranslate"aria-hidden="true"></i></a><li><a href="https://soundcloud.com/yegor256"rel="nofollow"title="My podcast"><i class="icon icon-podcast notranslate"aria-hidden="true"></i></a><li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721"rel="nofollow"title="My iTunes podcast"><i class="icon icon-itunes notranslate"aria-hidden="true"></i></a><li><a href="https://t.me/yegor256news"rel="nofollow"title="My Telegram public channel"><i class="icon icon-telegram notranslate"aria-hidden="true"></i></a><li><a href="mailto:blog@yegor256.com"rel="nofollow"title="Email me any time"><i class="icon icon-mail notranslate"aria-hidden="true"></i></a></ul><ul class="menu"><li><a href="/"title="Home page">Home</a><li><a href="/best.html"title="Best articles to read">12&#160;Best</a><li><a href="/contents.html"title="The contents of the entire blog">All&#160;394</a><li><a href="/teaching.html"title="My courses and lectures">Teaching</a><li><a href="/talks.html"title="Future and past conference talks">Talks</a><li><a href="/books.html"title="The books I wrote">Books</a><li><a href="/research.html"title="My research directions and progress">Research</a><li><a href="/pets.html"title="My loved pet projects">Pets</a><li><a href="/testimonials.html"title="What some people say about me">Testimonials</a><li><a href="/shift-m.html"title="Audio podcast about project management">Shift-M</a><li><a href="/paintings.html"title="My paintings for sale">Art</a><li><a href="https://ru.yegor256.com/"title="Немного на русском языке о политике в России, Украине и мире">Политика</a></ul></nav><div class="search"><form action="https://www.google.com/search"itemprop="potentialAction"itemscope=""itemtype="http://schema.org/SearchAction"><meta itemprop="target"content="https://www.google.com/search?q={q}"><input name="sitesearch"value="yegor256.com"type="hidden"> <input itemprop="query-input"id="search-query"class="field field-text"required="required"onfocus='$(".google").css("visibility","visible")'name="q"placeholder="Search..."autocomplete="off"> <input type="image"src="/images/google-search-icon.svg"class="google"title="Search via Google"alt="Search via Google"></form></div><div class="hot"><ul></ul></div></header></div><section itemscope=""itemtype="http://schema.org/BlogPosting"><div class="wrapper"><header><h1 itemprop="name headline mainEntityOfPage">How Data Visibility Hurts Maintainability</h1></header><article class="main"itemprop="articleBody"style="font-family:sans-serif;font-size:.9em;line-height:1.2em"><p style="color:#c42c00">The following text is a <em>partial</em> translation of the <a href="https://www.yegor256.com/2019/03/12/data-and-maintainability.html">original English article</a>, performed by <a href="https://chat.openai.com/">ChatGPT</a> (gpt-3.5-turbo) and <a href="https://github.com/yegor256/jekyll-chatgpt-translate">this Jekyll plugin</a>:<p>我一直在写关于面向对象编程及其陷阱的<a href="/tags/oop.html">很多</a>东西，声称我们所习惯的大多数设计模式和“良好实践”实际上是错误和有害的，以至于我完全忘记了解释更大的问题。有人在关于“裸露”数据的博文中<a href="https://www.yegor256.com/2016/11/21/naked-data.html#comment-3879044054">问过</a>我一些时间了：我们解决的问题是什么，如果我们不足够<em>封装</em>我们的数据，为什么可维护性会受到影响？这就是答案。<p>我重新阅读了我专门讨论现代面向对象编程缺陷问题的书籍<a href="/elegant-objects.html"><em>Elegant Objects, Volume 1</em></a>的前几页，发现可维护性在书中直接提到：“我希望通过这本书增加您代码的<em>可维护性</em>”，然后它还解释了可维护性是“我理解您代码所需的时间”。您可以与此<a href="https://softwareengineering.stackexchange.com/questions/141005">争论</a>，但问题仍然存在：缺乏“真正”的面向对象和适当的封装如何影响可读性？<p>我不知道确切的答案，但这是我的版本，是从我多年编码和苦苦挣扎中得出的结论：更好的可维护性的关键成功因素是<em>较小的范围</em>，而缺乏封装会导致较大的范围。您知道<a href="https://en.wikipedia.org/wiki/Scope_%28computer_science%29">可见性范围</a>是什么吧？让我们以这段C代码为例：<p>有两个变量<code class="language-plaintext highlighter-rouge">i</code>，在两个不同的<code class="language-plaintext highlighter-rouge">for</code>循环中可见，有两个不同的可见范围。每个范围的<em>大小</em>为三行代码。那么这段代码呢，完全一样：<p>现在，<code class="language-plaintext highlighter-rouge">i</code>的可见范围是十行代码。代码的功能与第一个片段一样好，但可维护性较低，因为为了理解其运作方式并进行修改，我需要更多时间。我需要阅读10行代码块，而不是两个3行的代码块。我需要在开始进行任何修改之前理解整个<code class="language-plaintext highlighter-rouge">print()</code>方法。我需要理解<code class="language-plaintext highlighter-rouge">i</code>的生命周期算法以及为什么它会被减少10而不是重新赋值为零-这是前任程序员给我的惊喜。也许他们不知道<code class="language-plaintext highlighter-rouge">for</code>循环的存在吧？<p>显然，第一个片段比第二个片段更好。问题是，我们如何让程序员编写像第一个片段那样的代码，使每个变量和函数的作用域更小？我们可以教他们，为他们写书，说服他们，培训他们，甚至可能因为作用域较大和代码不易读而惩罚他们，但如果编程语言本身无法阻止这些大范围的发生，那么任何努力都不会真正有所帮助。最好是发明一种编程语言或整个编程范式，使其更难或不可能增加作用域。<p>例如，在C/C++、Python、Ruby和许多其他现代语言中，你可以想象的最大作用域是全局作用域，例如这里：<p>现在变量<code class="language-plaintext highlighter-rouge">i</code>不仅在<code class="language-plaintext highlighter-rouge">print()</code>函数内部可见，而且在我们开发的应用程序的所有其他地方都可见。<code class="language-plaintext highlighter-rouge">i</code>的可见范围是整个代码库的大小。不用说，这使得<code class="language-plaintext highlighter-rouge">print()</code>函数的代码非常难读。当执行<code class="language-plaintext highlighter-rouge">print()</code>时，我根本不知道<code class="language-plaintext highlighter-rouge">i</code>会有什么值—我必须浏览整个代码库才能找到它。如果是一个小应用程序，也许我能应付，但如果是一个大型软件，我将会遇到很大的麻烦。那么，我们创建一种不允许全局变量的编程语言如何？这将解决这个问题。程序员将无法定义全局变量，它们的作用域必然会更小。<p>我相信对象的发明正是为了达到这个目的：<em>强制</em>程序员将可见范围保持较小。实际上，函数和子程序也是为此而发明的，但对于”强制”这个部分的强调较弱，因为它们可以与尚未分解的代码部分共存。相反，对象应该是对象世界的一等公民，只与对象进行通信。<p>但是接着C++出现了，把一切都搞砸了。<p>让我们尝试在我们的C代码片段中引入一个对象，用一种<del>大多数</del>一些C++程序员的方式来做：<p>And then:<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>void print() {
  Idx i();
  while (i.get() &lt; 10) {
    printf("%d * 2 = %d", i.get(), i.get() * 2);
    i.add(1);
  }
  i.add(-10);
  while (i.get() &lt; 10) {
    printf("%d * 3 = %d", i.get(), i.get() * 3);
    i.add(1);
  }
}
</code></pre></div></div><p>发生了什么变化？并不多。我们不再有一个简单的“标量”变量<code class="language-plaintext highlighter-rouge">i</code>，而是有一个“对象”，它内部存储一个整数值并提供一些方法来访问和修改它。这有助于我们缩小范围吗？一点也没有。而且，<code class="language-plaintext highlighter-rouge">print()</code>的长度现在甚至变长了几行。但是现在我们有一个对象，并且可以用面向对象的方式调用我们的代码！<p>这就是大多数“对象”如今的用法，主要得益于C++：它们只是数据持有者，而实际使用数据的人仍然在它们之外。对象<code class="language-plaintext highlighter-rouge">Idx</code>对其持有的数据的真实目的一无所知。它不知道它的<code class="language-plaintext highlighter-rouge">v</code>被用作步长计数器，并且在打印一些文本之前会被乘以某个值。<code class="language-plaintext highlighter-rouge">Idx</code>只是一个数据持有者，而真正的逻辑在它之外。<p>可维护性问题没有得到解决，范围没有缩小，代码的复杂性也没有减少。而且，它还增加了，因为现在，为了理解<code class="language-plaintext highlighter-rouge">print()</code>的工作原理，我必须知道<code class="language-plaintext highlighter-rouge">Idx</code>内部的内容是什么。在这个特定的例子中，对象范式承诺要解决部分问题，并让我永远不用担心它，但实际上它只是让问题变得更大，通过给我带来了两个问题：<code class="language-plaintext highlighter-rouge">print()</code>和<code class="language-plaintext highlighter-rouge">Idx</code>。<p>为什么要感谢C++？因为C++在C过程性编程思想的基础上添加了面向对象，甚至没有考虑禁止其中的一些思想，来<em>强迫</em>程序员按照它们应该被编写的方式编写对象：作为封装了它们所需的一切且从不允许外部任何人甚至<em>知道</em>里面有什么的黑盒子！C++甚至没有试图将范式从过程和变量转换为对象和方法。C++的创建者Bjarne Stroustrup只是给程序员提供了方法和类，并说：“使用它们，它们比变量更方便，…或者有时候也许不方便，…我不知道”（我不确定这是他的引用，但我相信它非常接近他的想法）。阅读<a href="https://amzn.to/2uMlANB">他的书</a>，你会看到有多少页专门讲述了面向对象的哲学，以及有多少页专门讲述了运算符和语句的技术细节。<p>一个正确的面向对象的解决方案会有所不同，并且会涉及真正的封装，其中数据从不“逃离”其所有者的边界。首先，这是我设计<code class="language-plaintext highlighter-rouge">Idx</code>的方式…嗯，首先我会给它改个名字，称之为<code class="language-plaintext highlighter-rouge">Line</code>：<p>现在这里是<code class="language-plaintext highlighter-rouge">print()</code>的代码。<p>正如你所看到的，<code class="language-plaintext highlighter-rouge">print()</code>无法访问<code class="language-plaintext highlighter-rouge">Line</code>的内部数据。<code class="language-plaintext highlighter-rouge">print()</code>所能做的只是要求<code class="language-plaintext highlighter-rouge">Line</code>前进并打印自己。关于这个逻辑在<code class="language-plaintext highlighter-rouge">Line</code>内部是如何实现的，没有人知道也没有人想知道。因为<code class="language-plaintext highlighter-rouge">Line</code>中没有任何getter方法，所以我们无法从中获取数据。<p>由于无法获取数据，我们无法在<code class="language-plaintext highlighter-rouge">print()</code>中构建任何逻辑。我们根本没有任何可用的数据，没有整数，没有数字。我们只能处理对象，这些对象不信任我们的内部。我们只能“礼貌地”请求它们为我们做些什么。<code class="language-plaintext highlighter-rouge">print()</code>的作用范围现在非常小，与<code class="language-plaintext highlighter-rouge">Line</code>的内部完全隔离。适当的封装帮助我们实现了这一点：通过不暴露<code class="language-plaintext highlighter-rouge">Line</code>的内部，我们使任何人都无法进入其作用域。<code class="language-plaintext highlighter-rouge">print()</code>无法对<code class="language-plaintext highlighter-rouge">Line</code>封装的数据做任何操作。<p>因此，数据越可见和可访问，可维护性就越低。<p>面向对象编程的核心思想就是封装，这不仅意味着限制外部修改对象属性的能力，还禁止任何人读取这些属性。</p><script async=""src="https://platform.twitter.com/widgets.js"charset="utf-8"></script><p class="jekyll-chatgpt-translate">Translated by ChatGPT gpt-3.5-turbo/42 on 2023-12-17 at 15:24</article></div><div class="wrapper"><footer class="footer"><p>&copy; <span itemscope=""itemprop="copyrightHolder"itemtype="http://schema.org/Person"><span itemprop="name">Yegor Bugayenko</span> </span>2014&ndash;<span itemprop="copyrightYear">2023</span></footer></div></section><div class="wrapper unprintable"style="text-align:center;margin-top:2em"><a href="https://www.sixnines.io/h/3ba1652f"><img src="//www.sixnines.io/b/3ba1652f?style=flat"alt="sixnines availability badge"></a>&nbsp; <a href="https://github.com/yegor256/blog/stargazers"><img src="//img.shields.io/github/stars/yegor256/blog.svg?style=flat-square"alt="GitHub stars"></a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script><script src="/js/all.js?0ab463c57dc"></script><script>var disqus_shortname="yegor256"</script><script id="dsq-count-scr"src="//yegor256.disqus.com/count.js"async="async"></script><script>((e,a,t,g,n,c)=>{e.GoogleAnalyticsObject=g,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,n=a.createElement(t),c=a.getElementsByTagName(t)[0],n.async=1,n.src="//www.google-analytics.com/analytics.js",c.parentNode.insertBefore(n,c)})(window,document,"script","ga"),ga("create","UA-1963507-32","auto"),ga("send","pageview")</script><script>Cd=document,Cr="&"+Math.random(),Cp="&s=1",Cd.cookie="b=b",Cd.cookie&&(Cp+="&c=1"),Cp+="&t="+(new Date).getTimezoneOffset(),self!=top&&(Cp+="&f=1")</script><script>navigator.javaEnabled()&&(Cp+="&j=1")</script><script>"undefined"!=typeof screen&&(Cp+="&w="+screen.width+"&h="+screen.height+"&d="+(screen.colorDepth||screen.pixelDepth))</script><script>Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+"&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+"' border='0' width='1' height='1'/>")</script><script type="application/ld+json">{ "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] }</script>