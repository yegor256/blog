<!DOCTYPE html>
<html amp lang="en">
  <head>

    <meta charset="utf-8">
    <title>JAXB Is Doing It Wrong; Try Xembly</title>
    <link rel="canonical" href="http://www.yegor256.com/2015/03/26/jaxb-vs-xembly.html">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "mainEntityOfPage":{
          "@type": "WebPage",
          "@id": "http://www.yegor256.com/2015/03/26/jaxb-vs-xembly.html"
        },
        "headline": "JAXB Is Doing It Wrong; Try Xembly",
        "image": {
          "@type": "ImageObject",
          "url": "http://www.yegor256.com/images/face-1400x1400.jpg",
          "height": 1400,
          "width": 1400
        },
        "datePublished": "2015-03-26",
        "dateModified": "2015-03-26",
        "author": {
          "@type": "Person",
          "name": "Yegor Bugayenko"
        },
        "publisher": {
          "@type": "Organization",
          "name": "yegor256.com",
          "logo": {
            "@type": "ImageObject",
            "url": "http://www.yegor256.com/images/face-512x512.jpg",
            "width": 512,
            "height": 512
          }
        },
        "description": "JAXB is a 10-year-old anti-pattern that encourages Java
developers to turn their objects into dumb, passive
data structures.
",
        "keywords": ["jaxb anti-pattern", "jaxb is bad", "jaxb marshalling", "jaxb marshalling example", "jaxb alternatives"]
      }
    </script>
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style>
<noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Source+Code+Pro:400,500">
    <style amp-custom="amp-custom">
      @font-face {
        font-family: 'Cambria';
        src: url('http://www.yegor256.com/fonts/cambria/2EAA54_2_0.ttf');
      }
      body { font-family: 'Cambria', 'Times New Roman', serif; padding: .5em; font-size: 1.2em; }
      article { width: 600px; max-width: 100%; margin-left: auto; margin-right: auto; }
      pre, code { font-family: 'Source Code Pro', 'Courier New', monospace; font-size: .8em; }
      code { padding: 0 .3em; background-color: lightgray; }
      a, a:hover, a:visited { color: inherit; }
      .intro { color: red; font-size: .75em; }
      .photo { border-radius: 50%; }
      pre { overflow-x:scroll; }
    </style>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
  </head>
  <body>
    <article>
      <p class="intro">
        This is a mobile version, full one is
        <a href="http://www.yegor256.com/2015/03/26/jaxb-vs-xembly.html">here</a>.
      </p>
      <p>
        <amp-img src="/images/yegor-bugayenko-192x192.png" width="80" height="80" alt="Yegor Bugayenko" class="photo"></amp-img>
      </p>
      <p>Yegor Bugayenko<br>26 March 2015</p>
      <h1>JAXB Is Doing It Wrong; Try Xembly</h1>
      

<p><a href="http://en.wikipedia.org/wiki/Java_Architecture_for_XML_Binding">JAXB</a>
is a 10-year-old Java technology that allows us to
convert a Java object into an XML document (marshalling) and
back (unmarshalling). This technology is based on
<a href="/2014/09/16/getters-and-setters-are-evil.html">setters and getters</a>
and, in my opinion, violates key principles of object-oriented
programming by turning objects into <strong>passive data structures</strong>. I would
recommend you use <a href="http://www.xembly.org">Xembly</a>
instead for marshalling Java objects into XML documents.</p>



<p>This is how JAXB marshalling works. Say you have a <code>Book</code> class that needs to be
marshalled into an XML document. You have to create getters and annotate them:</p>

<pre>import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlRootElement;
@XmlRootElement
public class Book {
  private final String isbn;
  private final String title;
  public Book(final String isbn, final String title) {
    this.isbn = isbn;
    this.title = title;
  }
  @XmlElement
  public String getIsbn() {
    return this.isbn;
  }
  @XmlElement
  public String getTitle() {
    return this.title;
  }
}</pre>

<p>Then you create a marshaller and ask it to convert an instance of class
<code>Book</code> into XML:</p>

<pre>final Book book = new Book("0132350882", "Clean Code");
final JAXBContext context = JAXBContext.newInstance(Book.class);
final Marshaller marshaller = jaxbContext.createMarshaller();
marshaller.marshal(book, System.out);</pre>

<p>You should be expecting something like this in the output:</p>

<pre>&lt;?xml version="1.0"?&gt;
&lt;book&gt;
  &lt;isbn&gt;0132350882&lt;/isbn&gt;
  &lt;title&gt;Clean Code&lt;/title&gt;
&lt;/book&gt;</pre>

<p>So what's wrong with it? Pretty much the same thing that's wrong with
object-relational mapping, which is explained in
<a href="/2014/12/01/orm-offensive-anti-pattern.html">ORM Is an Offensive Anti-Pattern</a>.
JAXB is treating an object as a bag of data, extracting the data
and converting it into XML the way JAXB wants. The object has no control
over this process. Therefore an object is not
<a href="/2014/11/20/seven-virtues-of-good-object.html">an object</a>
anymore but rather a passive bag of data.</p>

<p>An ideal approach would be to redesign our class <code>Book</code> this way:</p>

<pre>public class Book {
  private final String isbn;
  private final String title;
  public Book(final String isbn, final String title) {
    this.isbn = isbn;
    this.title = title;
  }
  public String toXML() {
    // create XML document and return
  }
}</pre>

<p>However, there are a few problems with this approach. First of all, there's
massive code duplication. Building an XML document is a rather verbose
process in Java. If every class had to re-implement it in its
<code>toXML()</code> method, we would have a big problem with duplicate code.</p>

<p>The second problem is that we don't know exactly what type of wrapping
our XML document should be delivered in. It may be a <code>String</code> or an <code>InputStream</code>
or maybe an instance of <code>org.w3c.dom.Document</code>. Making many <code>toXML()</code> methods
in each object would definitely be a disaster.</p>

<p><a href="http://www.xembly.org">Xembly</a> provides a solution. As I've
<a href="/2014/04/09/xembly-intro.html">mentioned before</a>, it is
an imperative language for XML constructions and manipulations. Here is
how we can implement our <code>Book</code> object with the help of Xembly:</p>

<pre>import org.xembly.Directive;
public class Book {
  private final String isbn;
  private final String title;
  public Book(final String isbn, final String title) {
    this.isbn = isbn;
    this.title = title;
  }
  public Iterable&lt;Directive&gt; toXembly() {
    return new Directives()
      .add("book")
      .add("isbn").set(this.isbn).up()
      .add("title").set(this.title).up()
      .up();
  }
}</pre>

<p>Now, in order to build an XML document, we should use this code
outside the object:</p>

<pre>final Book book = new Book("0132350882", "Clean Code");
final String xml = new Xembler(book.toXembly()).xml();</pre>

<p>This <a href="http://www.xembly.org/apidocs-0.21/org/xembly/Xembler.html"><code>Xembler</code></a>
class will convert Xembly directives into an XML document.</p>

<p>The beauty of this solution is that the internals of the object are
not exposed via getters and the object is fully in charge of the XML
marshalling process. In addition, the complexity of these directives
may be very highâ€”much higher than the rather cumbersome
<a href="/2016/04/12/java-annotations-are-evil.html">annotations</a> of JAXB.</p>

<p>Xembly is an open-source project, so feel free to submit your questions
or corrections to <a href="https://github.com/yegor256/xembly">GitHub</a>.</p>

    </article>
  </body>
</html>
