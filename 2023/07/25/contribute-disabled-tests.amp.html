<!DOCTYPE html>
<html amp lang="en">
  <head>

    <meta charset="utf-8">
    <title>A Disabled Test In Lieu of a Bug Report</title>
    <link rel="canonical" href="https://www.yegor256.com/2023/07/25/contribute-disabled-tests.html">
    <link rel="icon" type="image/png" href="/favicon.ico">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "mainEntityOfPage":{
          "@type": "WebPage",
          "@id": "https://www.yegor256.com/2023/07/25/contribute-disabled-tests.html"
        },
        "headline": "A Disabled Test In Lieu of a Bug Report",
        "image": {
          "@type": "ImageObject",
          "url": "/images/2023/07/dead-or-alive.jpg",
          "height": 770,
          "width": 1438
        },
        "datePublished": "2023-07-25",
        "dateModified": "2023-07-25",
        "author": {
          "@type": "Person",
          "name": "Yegor Bugayenko"
        },
        "publisher": {
          "@type": "Organization",
          "name": "yegor256.com",
          "logo": {
            "@type": "ImageObject",
            "url": "https://www.yegor256.com/images/face-512x512.jpg",
            "width": 512,
            "height": 512
          }
        },
        "description": "Instead of merely submitting bug reports, it can often be more efficient 
to contribute a pull request, complete with a disabled unit test 
and a detailed description of the problem.
",
        "keywords": ["pull request", "unit test", "bug report", "bug tracking", "puzzle driven development"]
      }
    </script>
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style>
<noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500">
    <style amp-custom="amp-custom">
      @font-face {
        font-family: 'Cambria';
        src: url('https://www.yegor256.com/fonts/cambria/2EAA54_2_0.ttf');
      }
      body { font-family: 'Cambria', 'Times New Roman', serif; padding: .5em; font-size: 1.2em; }
      article { width: 600px; max-width: 100%; margin-left: auto; margin-right: auto; }
      pre, code { font-family: 'Source Code Pro', 'Courier New', monospace; font-size: .8em; }
      code { padding: 0 .3em; background-color: lightgray; }
      a, a:hover, a:visited { color: inherit; }
      .intro { color: red; font-size: .75em; }
      .photo { border-radius: 50%; }
      pre { overflow-x:scroll; }
    </style>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
  </head>
  <body>
    <article>
      <p class="intro">
        This is a mobile version, full one is
        <a href="https://www.yegor256.com/2023/07/25/contribute-disabled-tests.html">here</a>.
      </p>
      <p>
        <amp-img src="/images/face-256x256.jpg" width="80" height="80" alt="Yegor Bugayenko" class="photo"></amp-img>
      </p>
      <p>Yegor Bugayenko<br>25 July 2023</p>
      <h1>A Disabled Test In Lieu of a Bug Report</h1>
      <p>When you find a bug in an open-source library that you use, 
<a href="/2018/07/24/bugs-or-pull-requests.html">what do you do</a>?
You submit a GitHub issue (or whatever ticket tracking system they use).
In the issue, you describe the problem in the best possible way, preferably
providing a working code example that the author of the library can run locally
to reproduce the bug. If you don’t provide them with an executable snippet of code,
they will most likely ask you to do so, unless the bug is trivial.
I suggest simplifying the workflow and giving them what they want right
in a pull request: send them the bug in the form of a disabled unit test.</p>



<amp-img src="/images/2023/07/dead-or-alive.jpg" alt="Dead or Alive (1999) by Takashi Miike" height="770" width="1438" layout="responsive"></amp-img>

<p>Say, there is a Rust library that provides a <code class="language-plaintext highlighter-rouge">fibo()</code> function that 
calculates a <a href="https://en.wikipedia.org/wiki/Fibonacci_sequence">Fibonacci number</a>, 
which you can use this way:</p>

<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">23</span><span class="p">;</span>
<span class="k">let</span> <span class="n">x</span> <span class="o">=</span> <span class="nf">fibo</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
<span class="nd">println!</span><span class="p">(</span><span class="s">"The {n}th Fibonacci is {x}"</span><span class="p">);</span>
</code></pre></div></div>

<p>You run it and it prints <code class="language-plaintext highlighter-rouge">17711</code>, which is mistakenly the 22nd Fibonacci number,
not the 23rd. It is definitely a bug. You submit a ticket, saying something like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>I'm trying to use your library to calculate 
a Fibonacci  number, but for some reason, I'm 
getting a wrong result:  the 23rd number your 
library returns is 17711, while I'm expecting 
the number 28657. Please check and fix.
</code></pre></div></div>

<p>They will reply “Can you prove it, please? Show us the code!” and
you will probably add this code to the ticket:</p>

<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="n">x</span> <span class="o">=</span> <span class="nf">fibo</span><span class="p">(</span><span class="mi">23</span><span class="p">);</span>
<span class="nd">assert_eq!</span><span class="p">(</span><span class="mi">28657</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</code></pre></div></div>

<p>Then, if they are <a href="/2017/03/24/tdd-that-works.html">disciplined</a> 
programmers, a new unit test will be created and the
<code class="language-plaintext highlighter-rouge">fibo()</code> function will be fixed. Moreover, if they are 
<a href="/2022/08/04/code-and-tests-different-pull-requests.html">very disciplined</a> programmers, 
they will submit the test in a separate pull request, disabling it. Then, in
the second pull request, they will make a fix.</p>

<p>Why can’t you help them and skip the issue submission step? Just make the
first pull request yourself, with the disabled test inside and a 
<a href="/2010/03/04/pdd.html">“puzzle”</a> added to it:</p>

<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// @todo #42 This test is disabled because the</span>
<span class="c1">//  fibo() function doesn't work correctly</span>
<span class="c1">//  with this particular number, it returns</span>
<span class="c1">//  17711 instead of 28657. Let's fix it.</span>
<span class="nd">#[test]</span>
<span class="nd">#[ignore]</span>
<span class="k">fn</span> <span class="nf">calculates_23rd_fibonacci_number</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">let</span> <span class="n">x</span> <span class="o">=</span> <span class="nf">fibo</span><span class="p">(</span><span class="mi">23</span><span class="p">);</span>
  <span class="nd">assert_eq!</span><span class="p">(</span><span class="mi">28657</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Such a PR serves as both a bug report
(this is what the text of the puzzle will be turned into, once the PR is merged)
and a test that reproduces the problem. It will be more than welcome
by the repository maintenance team. This kind of PR saves the time
they would spend creating a unit test. Also, it saves your time for
creating a bug report, as it will be created automatically by
<a href="/2014/04/12/puzzle-driven-development-by-roles.html">the puzzles discovery tool</a>.</p>



<p>BTW, this blog post was motivated by <a href="https://github.com/jcabi/jcabi-xml/pull/212">this pull request</a> 
in the <a href="https://github.com/jcabi/jcabi-xml">jcabi/jcabi-xml</a> library, where a disabled
unit test was added to the code base specifically to reproduce the bug. In addition to
the test, a puzzle was added, which led to a <a href="https://github.com/jcabi/jcabi-xml/issues/213">new ticket</a>, 
a <a href="https://github.com/jcabi/jcabi-xml/pull/214">new pull request</a>, 
and finally a <a href="https://github.com/jcabi/jcabi-xml/releases/tag/0.28.0">new release</a> of the library.</p>

    </article>
  </body>
</html>
