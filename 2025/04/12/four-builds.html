<!doctypehtml><html xmlns="https://www.w3.org/1999/xhtml"lang="en-US"xml:lang="en-US"itemscope=""itemtype="http://schema.org/WebSite"><meta charset="utf-8"><meta name="description"content="Instead of trying to shorten the time that our builds take, we order and chain them by complexity, thus gradually reducing the risk."><meta name="keywords"content="CI slow, build duration, fast build, how to make build fast, slow build"><meta name="viewport"content="width=device-width,minimum-scale=1,initial-scale=1"><meta name="google-site-verification"content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8"><meta name="author"content="Yegor Bugayenko"><meta name="article:published_time"content="2025-04-12 00:00:00 +0000"><meta name="yandex-verification"content="7d2a0afee14d72bc"><meta name="og:site_name"content="Yegor Bugayenko"><meta name="og:type"content="article"><meta name="og:locale"content="en_US"><meta name="twitter:account_id"content="4503599630178231"><meta name="twitter:creator"content="@yegor256"><meta name="twitter:site"content="@yegor256"><meta name="twitter:title"property="og:title"content="Four Builds: A Balance Between Quality and Joy"><meta name="twitter:description"property="og:description"content="Instead of trying to shorten the time that our builds take, we order and chain them by complexity, thus gradually reducing the risk."><meta name="twitter:url"property="og:url"content="https://www.yegor256.com/2025/04/12/four-builds.html"><meta name="telegram:channel"content="AAAAAEJFMRzsRTRxM3ec6A"><link rel="search"type="application/opensearchdescription+xml"href="/opensearch.xml"title="yegor256"><link rel="icon"href="/favicon.ico?cffa275"type="image/x-icon"><link rel="shortcut icon"href="/favicon.ico?cffa275"><link rel="apple-touch-icon"href="/favicon.ico?cffa275"><link rel="alternate"type="application/rss+xml"title="RSS for yegor256.com"href="https://www.yegor256.com/rss.xml"><link rel="stylesheet"href="/css/layout.css?cffa275"><link rel="stylesheet"href="/css/icons.css?cffa275"><link rel="canonical"href="https://www.yegor256.com/2025/04/12/four-builds.html"><title>Four Builds: A Balance Between Quality and Joy</title><meta name="og:image"content="https://www.yegor256.com/images/2025/04/trainspotting.jpg"><meta name="twitter:image"content="https://www.yegor256.com/images/2025/04/trainspotting.jpg"><meta name="og:image:width"content="1104"><meta name="twitter:image:width"content="1104"><meta name="og:image:height"content="621"><meta name="twitter:image:height"content="621"><meta name="twitter:card"content="summary_large_image"><meta name="twitter:image:alt"content="Trainspotting (1996) by Danny Boyle"><div class="wrapper"><aside class="header-toggle unprintable"id="header-toggle"title="Show the menu"onclick='$("#header").show(),$("#header-toggle").hide()'>&#9776;</aside><header class="header"id="header"><div class="face"><a href="/about-me.html#form"class="sub"title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html"style="position:relative"><img src="/images/face-256x256.jpg"class="photo"alt="Yegor Bugayenko"></a></div><nav><ul class="menu social notranslate"><li><a href="https://twitter.com/intent/follow?screen_name=yegor256"rel="nofollow"title="Follow me on Twitter"><i class="icon icon-twitter notranslate"aria-hidden="true"></i></a><li><a href="/rss.xml"rel="nofollow"title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://github.com/yegor256"rel="nofollow"title="My GitHub profile"><i class="icon icon-github notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="http://stackoverflow.com/users/187141/yegor256"rel="nofollow"title="My Stack Overflow profile"><i class="icon icon-stackoverflow notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://www.facebook.com/yegor256"rel="nofollow"title="Follow me on Facebook"><i class="icon icon-facebook notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://instagram.com/yegor256"rel="nofollow"title="Follow me on Instagram"><i class="icon icon-instagram notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://www.linkedin.com/in/yegor256"rel="nofollow"title="My LinkedIn profile"><i class="icon icon-linkedin notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://www.youtube.com/c/yegor256?sub_confirmation=1"rel="nofollow"title="My Youtube video channel"><i class="icon icon-youtube notranslate"aria-hidden="true"></i></a><li><a href="https://soundcloud.com/yegor256"rel="nofollow"title="My podcast"><i class="icon icon-podcast notranslate"aria-hidden="true"></i></a><li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721"rel="nofollow"title="My iTunes podcast"><i class="icon icon-itunes notranslate"aria-hidden="true"></i></a><li><a href="https://t.me/yegor256news"rel="nofollow"title="My Telegram public channel"><i class="icon icon-telegram notranslate"aria-hidden="true"></i></a><li><a href="mailto:blog@yegor256.com"rel="nofollow"title="Email me any time"><i class="icon icon-mail notranslate"aria-hidden="true"></i></a></ul><ul class="menu"><li><a href="/"title="Home page">Home</a><li><a href="/best.html"title="Best articles to read">12&#160;Best</a><li><a href="/contents.html"title="The contents of the entire blog">All&#160;481</a><li><a href="/teaching.html"title="My courses and lectures">Teaching</a><li><a href="/talks.html"title="Future and past conference talks">Talks</a><li><a href="/books.html"title="The books I wrote">Books</a><li><a href="/research.html"title="My research directions and progress">Research</a><li><a href="/pets.html"title="My loved pet projects">Pets</a><li><a href="/trainings.html"title="On-site trainings">Trainings</a><li><a href="https://www.iccq.ru"title="International Conference on Code Quality">ICCQ</a><li><a href="https://www.kaicode.org"title="Open Source Festival">KaiCode</a><li><a href="/testimonials.html"title="What some people say about me">Testimonials</a><li><a href="/shift-m.html"title="Audio podcast about project management">Shift-M</a><li><a href="/paintings.html"title="My paintings for sale">Art</a></ul></nav><div class="search"><form action="https://www.google.com/search"itemprop="potentialAction"itemscope=""itemtype="http://schema.org/SearchAction"><meta itemprop="target"content="https://www.google.com/search?q={q}"><input name="sitesearch"value="yegor256.com"type="hidden"> <input itemprop="query-input"id="search-query"class="field field-text"required="required"onfocus='$(".google").css("visibility","visible")'name="q"placeholder="Search..."autocomplete="off"> <input type="image"src="/images/google-search-icon.svg"class="google"title="Search via Google"alt="Search via Google"></form></div><div class="hot"><ul><li>Are you familiar with open source and have a decent GitHub portfolio of contributions? <strong>We need freelancers</strong>, working remotely and paid by result, for <a href="https://www.eolang.org">EO</a>, a new programming language. Join our Telegram group, we'll discuss: <a href="https://t.me/eolang_org">@eolang_org</a>.</ul></div></header></div><section itemscope=""itemtype="http://schema.org/BlogPosting"><div class="wrapper"><header><p class="printable"><img src="https://api.qrserver.com/v1/create-qr-code/?data=https://www.yegor256.com/2025/04/12/four-builds.html&amp;format=svg"style="width:125px;height:125px"alt="QR code"><p class="printable"><code itemprop="url">https://www.yegor256.com/250412.html</code><h1 itemprop="name headline mainEntityOfPage">Four Builds: A Balance Between Quality and Joy</h1><ul class="subline"><li><time itemprop="datePublished"datetime="2025-04-12T00:00:00+00:00">12 April 2025</time><li class="desktop-only"itemprop="locationCreated">Novosibirsk, Russia<li class="printable"itemscope=""itemprop="author"itemtype="http://schema.org/Person"><span itemprop="name">Yegor Bugayenko</span><li class="unprintable"><i class="icon icon-comments"></i> <a href="https://www.yegor256.com/2025/04/12/four-builds.html#disqus_thread"itemprop="discussionUrl">comments</a></ul><ul class="unprintable subline"><li title="The page is translated by ChatGPT from English to a few languages">Translated by <i class="icon icon-chatgpt notranslate"aria-hidden="true"></i> to<li title="Click to see this page translated to Chinese"><a href="https://www.yegor256.com/zh/2025/04/12/four-builds.html">中文</a><li title="Click to see this page translated to Russian"><a href="https://www.yegor256.com/ru/2025/04/12/four-builds.html">русский</a></ul><p class="unprintable"><a href="/tag/devops.html"class="tag notranslate">devops</a><nav class="buttons notranslate desktop-only"><a href="https://www.facebook.com/sharer/sharer.php?u=https://www.yegor256.com/2025/04/12/four-builds.html"title="Share on Facebook"class="button"rel="nofollow"><span class="count count-facebook">0</span> <i class="icon icon-facebook notranslate"aria-hidden="true"></i> </a><a href="https://twitter.com/share?url=https://www.yegor256.com/2025/04/12/four-builds.html&amp;text=Four+Builds%3A+A+Balance+Between+Quality+and+Joy"title="Share on Twitter"class="button"rel="nofollow"><span class="count count-twitter">0</span> <i class="icon icon-twitter notranslate"aria-hidden="true"></i> </a><a href="https://www.linkedin.com/cws/share?url=https://www.yegor256.com/2025/04/12/four-builds.html"title="Share on LinkedIn"class="button"rel="nofollow"><span class="count count-linkedin">0</span> <i class="icon icon-linkedin notranslate"aria-hidden="true"></i> </a><a href="https://reddit.com/submit?url=https://www.yegor256.com/2025/04/12/four-builds.html%3F2025-14&amp;title=Four+Builds%3A+A+Balance+Between+Quality+and+Joy"title="Share on Reddit"class="button"rel="nofollow"><span class="count count-reddit">0</span> <i class="icon icon-reddit notranslate"aria-hidden="true"></i> </a><a href="https://news.ycombinator.com/submitlink?u=https://www.yegor256.com/2025/04/12/four-builds.html%3F2025-14&amp;t=Four+Builds%3A+A+Balance+Between+Quality+and+Joy"title="Share on Hacker News"class="button"rel="nofollow"><span class="count count-hackernews">0</span> <i class="icon icon-hackernews notranslate"aria-hidden="true"></i> </a><a href="#"title="Cite it via BibTeX"class="button"onclick='return $("#bibtex").toggle(),!1'><i class="icon icon-tex notranslate"aria-hidden="true"></i></a></nav></header><article class="main"itemprop="articleBody"><div><div id="bibtex"style="display:none"><p>Please, cite this blog post via <a href="https://www.bibtex.org/">BibTeX</a> as such:<pre style="color:#053c5e">@misc&#123;bugayenko2025blog0412,
  author = &#123;Bugayenko, Yegor&#125;,
  title = &#123;&#123;Four Builds: A Balance Between Quality and Joy&#125;&#125;,
  howpublished = &#123;\url&#123;https://www.yegor256.com/250412.html&#125;&#125;,
  year = &#123;2025&#125;,
  month = &#123;apr&#125;,
  note = &#123;[Online; accessed 08-10-2025]&#125;
&#125;</pre></div><p>How long should it take to know if your code is safe? Martin Fowler once <a href="http://martinfowler.com/articles/continuousIntegration.html">said</a>: 10 minutes. Ten years later, five hundred developers <a href="https://doi.org/10.1145/3106237.3106270">agreed</a>. I disagree—with all of them. First, ten minutes is not enough for a proper build, even for a small software system. Second, ten minutes is too much for a build that we run from the IDE after every one-line edit. We need a finer-grained classification of builds: from bullet-fast to thorough and dead slow.<figure class="jb_picture"><img itemprop="image"alt="Trainspotting (1996) by Danny Boyle"src="/images/2025/04/trainspotting.jpg"longdesc="#b6b862c3"><figcaption id="b6b862c3">Trainspotting (1996) by Danny Boyle</figcaption></figure><p>How long should a build be?<p>As long as it needs to be, in order to run all necessary tests. Wrong. Imagine a build that takes an hour. The speed of development will be close to zero. Programmers will complain. A lot.<p>How about a build that takes a few seconds? The speed of coding will be high—but not for long. The quality of code will be jeopardized, because a quick build means weak testing, full of mocks.<p>So, how long should a build be? The right answer is: between a few seconds and a few hours. But the builds must be different.<h2 id="fast-build">Fast Build</h2><p>The first build is the one we run on our laptops. It is <strong>fast</strong>. It only includes unit tests. Every one of them takes a few milliseconds. Even if we have many, all together they can take less than a few seconds. We also check test coverage thresholds.<p>If a local build takes longer than a few seconds, it starts being an obligation instead of a help. We don’t run such a build because we enjoy the confidence it provides. Instead, we run it because it’s “the right thing to do.” Such a build is no fun, and is only an annoying routine. A long build breaks the rhythm of energetic coding.<p>What about compilation? The ten seconds include the time to compile the sources. What if the project has hundreds of large C++ files that need a few minutes to compile? We break such a project into smaller components—each with its own build and its own repository. We don’t tolerate large codebases and <a href="/2018/09/05/monolithic-repositories.html">monolith</a> repositories.<h2 id="cheap-build">Cheap Build</h2><p>Finally, after running the fast build a few dozen times, we have enough confidence to submit a pull request. Once submitted, GitHub picks it up and starts our workflows.<p>We have many of them, in different YAML files. On top of unit tests, they run integration tests and all sorts of style checks. We understand that the likelihood of failure is high, because unit tests—those we ran in the fast build—are only a fraction of all tests.<p>We wait for a few minutes and see some workflows fail. We investigate the failure, asking unit tests a question: “Why didn’t you catch this?” When the answer is found, we patch the tests or create additional ones. Then, we push and, again, wait a few minutes. We see a new failure and repeat the cycle, which normally occurs a few times per branch. Eventually, we see all GitHub workflows green.<p>We pay for this exercise. First, GitHub charges per minute. Second, the project pays us while we sit idle waiting for the answer from GitHub Actions. That’s why we want the build to take less than ten minutes—it must be <strong>cheap</strong>.<h2 id="preflight-build">Preflight Build</h2><p>When all GitHub workflows are green, we hit the button, asking <a href="/2014/07/24/rultor-automated-merging.html">Rultor</a>—or GitHub <a href="https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/configuring-pull-request-merges/managing-a-merge-queue">Merge Queue</a>—to merge it. A <strong>preflight</strong> build starts and takes up to an hour, at an on-demand AWS EC2 instance. It takes so long because, on top of unit and integration tests, it runs, for example, mutation testing. Even in a small codebase, ten minutes may not be enough.<p>Preflight builds may also run load, stress, performance, in-browser, and security penetration tests. We don’t expect them to break after a green cheap build. They do, however—but not often. If they break, we get back to the fast build, blaming the safety net for negligence. We reproduce the failure with a new unit test and make another merge attempt, expecting preflight to pass this time. Eventually, it does, and the code goes to the <code class="language-plaintext highlighter-rouge">master</code> branch.<h2 id="proper-build">Proper Build</h2><p>Once in a while, we release a new version of the product—be it a library or a microservice. This is when quality is the priority, while the duration of the build is irrelevant. We hit the button and wait, for as long as necessary. Sometimes a few hours.<p>Unlike all previous builds, this build is <strong>proper</strong>. On top of all the tests mentioned above, it runs, for example, in-cloud multi-browser tests, automated A/B tests, and all sorts of regression tests. In the future, most definitely, we’ll run LLM-based tests to detect design inconsistencies and security flaws.<p>Why didn’t we run these tests during the preflight build? In order to avoid merge queue overflow. A productive programmer may submit up to five pull requests per day. With ten active contributors on a team, we may get a few dozen merges per day. Since a merge queue can’t be parallelized, even one hour for a preflight may be too long. A proper build definitely won’t fit.<p>Also, the integration with the production environment is time-consuming. We enroll database changes, apply data migrations, update AWS configs, and switch between “green” and “blue” environments.<hr><p>In smaller projects, cheap and preflight builds may be similar. In tiny projects, all three builds—cheap, preflight, and proper—may be identical. However, we always keep the fast build different from the others. The “four builds” framework may be reduced to a “two builds” one, but never to “one build fits all.”</div></article></div><div class="disqus"role="complementary"aria-hidden="true"><p class="disqus_hint">Please, use <a href="https://help.disqus.com/commenting/what-html-tags-are-allowed-within-comments">syntax highlighting</a> in your comments, to make them more readable.<div id="disqus_thread"class="disqus-thread"><a>&nbsp;</a></div><script>var disqus_config=function(){this.page.url=document.location.href.split("?")[0].split("#")[0],this.page.identifier=this.page.url};(()=>{var e=document,t=e.createElement("script");t.src="//yegor256.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript><div><p class="red">JavaScript is disabled in your browser, that's why you can't see comments under this post.</div></noscript></div><div class="wrapper"><footer class="footer"><p>&copy; <span itemscope=""itemprop="copyrightHolder"itemtype="http://schema.org/Person"><span itemprop="name">Yegor Bugayenko</span> </span>, 2014&ndash;<span itemprop="copyrightYear">2025</span></footer></div></section><div class="wrapper unprintable"style="text-align:center;margin-top:2em"><a href="https://www.sixnines.io/h/3ba1652f"><img src="https://www.sixnines.io/b/3ba1652f?style=flat"alt="sixnines availability badge"></a>&nbsp; <a href="https://github.com/yegor256/blog/stargazers"><img src="https://img.shields.io/github/stars/yegor256/blog.svg?style=flat-square"alt="GitHub stars"></a></div><script src="https://code.jquery.com/jquery-1.9.0.min.js"></script><script src="/js/all.js?cffa275"></script><script type="application/ld+json">{ "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] }</script>