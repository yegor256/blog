<!doctypehtml><html xmlns="https://www.w3.org/1999/xhtml"lang="en-US"xml:lang="en-US"itemscope=""itemtype="http://schema.org/WebSite"><meta charset="utf-8"><meta name="description"content="While most programmers think checked exceptions in Java are a mistake, I&apos;m of the opposite opinion---unchecked ones are a mistake."><meta name="keywords"content=""><meta name="viewport"content="width=device-width,minimum-scale=1,initial-scale=1"><meta name="google-site-verification"content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8"><meta name="author"content="Yegor Bugayenko"><meta name="og:site_name"content="Yegor Bugayenko"><meta name="og:type"content="article"><meta name="og:locale"content="en_US"><meta name="twitter:account_id"content="4503599630178231"><meta name="twitter:creator"content="@yegor256"><meta name="twitter:site"content="@yegor256"><meta name="twitter:title"property="og:title"content="Checked vs. Unchecked Exceptions: The Debate Is Not Over"><meta name="twitter:description"property="og:description"content="While most programmers think checked exceptions in Java are a mistake, I&apos;m of the opposite opinion---unchecked ones are a mistake."><meta name="twitter:url"property="og:url"content="https://www.yegor256.com/ru/2015/07/28/checked-vs-unchecked-exceptions.html"><meta name="telegram:channel"content="AAAAAEJFMRzsRTRxM3ec6A"><link rel="search"type="application/opensearchdescription+xml"href="/opensearch.xml"title="yegor256"><link rel="shortcut icon"href="/favicon.ico?1fa46d1a364"><link rel="apple-touch-icon"href="/favicon.ico?1fa46d1a364"><link rel="alternate"type="application/rss+xml"title="RSS for yegor256.com"href="https://www.yegor256.com/rss.xml"><link rel="stylesheet"href="/css/layout.css?1fa46d1a364"><link rel="stylesheet"href="/css/icons.css?1fa46d1a364"><link rel="canonical"href="https://www.yegor256.com/ru/2015/07/28/checked-vs-unchecked-exceptions.html"><title>Checked vs. Unchecked Exceptions: The Debate Is Not Over</title><div class="wrapper"><aside class="header-toggle unprintable"id="header-toggle"title="Show the menu"onclick='$("#header").show(),$("#header-toggle").hide()'>&#9776;</aside><header class="header"id="header"><div class="face"><a href="/about-me.html#form"class="sub"title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html"style="position:relative"><img src="/images/santa-hat.svg"alt="Santa hat"style="position:absolute;width:115px;left:-20px;top:-100px"> <img src="/images/face-256x256.jpg"class="photo"alt="Yegor Bugayenko"></a></div><nav><ul class="menu social notranslate"><li><a href="https://twitter.com/intent/follow?screen_name=yegor256"rel="nofollow"title="Follow me on Twitter"><i class="icon icon-twitter notranslate"aria-hidden="true"></i></a><li><a href="/rss.xml"rel="nofollow"title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://github.com/yegor256"rel="nofollow"title="My GitHub profile"><i class="icon icon-github notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="http://stackoverflow.com/users/187141/yegor256"rel="nofollow"title="My Stack Overflow profile"><i class="icon icon-stackoverflow notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://www.facebook.com/yegor256"rel="nofollow"title="Follow me on Facebook"><i class="icon icon-facebook notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://instagram.com/yegor256"rel="nofollow"title="Follow me on Instagram"><i class="icon icon-instagram notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://www.linkedin.com/in/yegor256"rel="nofollow"title="My LinkedIn profile"><i class="icon icon-linkedin notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://www.youtube.com/c/yegor256?sub_confirmation=1"rel="nofollow"title="My Youtube video channel"><i class="icon icon-youtube notranslate"aria-hidden="true"></i></a><li><a href="https://soundcloud.com/yegor256"rel="nofollow"title="My podcast"><i class="icon icon-podcast notranslate"aria-hidden="true"></i></a><li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721"rel="nofollow"title="My iTunes podcast"><i class="icon icon-itunes notranslate"aria-hidden="true"></i></a><li><a href="https://t.me/yegor256news"rel="nofollow"title="My Telegram public channel"><i class="icon icon-telegram notranslate"aria-hidden="true"></i></a><li><a href="mailto:blog@yegor256.com"rel="nofollow"title="Email me any time"><i class="icon icon-mail notranslate"aria-hidden="true"></i></a></ul><ul class="menu"><li><a href="/"title="Home page">Home</a><li><a href="/best.html"title="Best articles to read">12&#160;Best</a><li><a href="/contents.html"title="The contents of the entire blog">All&#160;395</a><li><a href="/teaching.html"title="My courses and lectures">Teaching</a><li><a href="/talks.html"title="Future and past conference talks">Talks</a><li><a href="/books.html"title="The books I wrote">Books</a><li><a href="/research.html"title="My research directions and progress">Research</a><li><a href="/pets.html"title="My loved pet projects">Pets</a><li><a href="/testimonials.html"title="What some people say about me">Testimonials</a><li><a href="/shift-m.html"title="Audio podcast about project management">Shift-M</a><li><a href="/paintings.html"title="My paintings for sale">Art</a><li><a href="https://ru.yegor256.com/"title="Немного на русском языке о политике в России, Украине и мире">Политика</a></ul></nav><div class="search"><form action="https://www.google.com/search"itemprop="potentialAction"itemscope=""itemtype="http://schema.org/SearchAction"><meta itemprop="target"content="https://www.google.com/search?q={q}"><input name="sitesearch"value="yegor256.com"type="hidden"> <input itemprop="query-input"id="search-query"class="field field-text"required="required"onfocus='$(".google").css("visibility","visible")'name="q"placeholder="Search..."autocomplete="off"> <input type="image"src="/images/google-search-icon.svg"class="google"title="Search via Google"alt="Search via Google"></form></div><div class="hot"><ul></ul></div></header></div><section itemscope=""itemtype="http://schema.org/BlogPosting"><div class="wrapper"><header><h1 itemprop="name headline mainEntityOfPage">Checked vs. Unchecked Exceptions: The Debate Is Not Over</h1></header><article class="main"itemprop="articleBody"style="font-family:sans-serif;font-size:.9em;line-height:1.2em"><p style="color:#c42c00">The following text is a <em>partial</em> translation of the <a href="https://www.yegor256.com/2015/07/28/checked-vs-unchecked-exceptions.html">original English article</a>, performed by <a href="https://chat.openai.com/">ChatGPT</a> (gpt-3.5-turbo) and <a href="https://github.com/yegor256/jekyll-chatgpt-translate">this Jekyll plugin</a>:<p>Нам вообще нужны проверяемые исключения? Дискуссия закончена, не так ли? Не для меня. В то время как большинство объектно-ориентированных языков и большинство программистов считают проверяемые исключения ошибкой в Java, я верю в обратное - непроверяемые исключения являются ошибкой. Более того, я считаю, что множественные типы исключений тоже плохая идея.<p>Давайте сначала объясню, как я понимаю исключения в объектно-ориентированном программировании. Затем я сравню свое понимание с “традиционным” подходом, и мы обсудим различия. Итак, сначала мое понимание.<p>Предположим, есть метод, который сохраняет некоторые двоичные данные в файл:<p>Когда все идет по плану, метод просто сохраняет данные и возвращает управление. Когда что-то идет не так, он выбрасывает исключение <code class="language-plaintext highlighter-rouge">Exception</code>, и нам нужно что-то с этим сделать:<p>Когда метод указывает, что он <code class="language-plaintext highlighter-rouge">throws</code> исключение, я понимаю, что этот метод не <strong>безопасен</strong>. Иногда он может завершиться неудачей, и на мне лежит ответственность либо 1) обработать эту ситуацию, либо 2) также объявить себя <strong>небезопасным</strong>.<p>Я знаю, что каждый метод разработан с принципом <a href="https://ru.wikipedia.org/wiki/Принцип_единственной_ответственности">единственной ответственности</a> в виду. Это гарантирует, что если метод <code class="language-plaintext highlighter-rouge">save()</code> завершается с ошибкой, это означает, что вся операция сохранения не может быть выполнена. Если мне нужно знать причину этой ошибки, я могу <a href="https://ru.wikipedia.org/wiki/Цепочка_исключений">разрешить</a> исключение - просмотреть стек цепочки исключений и стеки вызовов, инкапсулированные в <code class="language-plaintext highlighter-rouge">ex</code>.<p>Я никогда не использую исключения для управления потоком выполнения, что означает, что я <strong>никогда не восстанавливаю</strong> ситуации, когда возникают исключения. Когда возникает исключение, я позволяю ему “подняться” до самого высокого уровня приложения. Иногда я повторно вызываю исключение, чтобы добавить больше семантической информации в цепочку. Вот почему для меня не имеет значения, какая причина исключения, вызванного <code class="language-plaintext highlighter-rouge">save()</code>, была. Я просто знаю, что метод завершился с ошибкой. Этого достаточно для меня. Всегда.<p>По той же причине мне не нужно различать различные типы исключений. Мне просто не нужна такая иерархия. <code class="language-plaintext highlighter-rouge">Exception</code> для меня достаточно. Опять же, потому что я не использую исключения для управления потоком выполнения.<p>Вот так я понимаю исключения.<p>Согласно этой парадигме, я бы сказал, что мы должны:<ul><li><p>Никогда не выбрасывайте / используйте непроверяемые исключения.<li><p>Используйте только <code class="language-plaintext highlighter-rouge">Exception</code>, без каких-либо подтипов.<li><p>Всегда объявляйте только один тип исключения в блоке <code class="language-plaintext highlighter-rouge">throws</code>.<li><p>Никогда не ловите без повторного выбрасывания; подробнее об этом можно прочитать здесь.</ul><p>Эта парадигма расходится с многими другими статьями, которые я нашел на эту тему. Давайте сравним и обсудим.<p><a href="http://docs.oracle.com/javase/tutorial/essential/exceptions/runtime.html">Oracle говорит</a>, что некоторые исключения должны быть частью API (проверяемые), в то время как некоторые являются исключениями времени выполнения и не должны быть его частью (непроверяемые). Они будут задокументированы в JavaDoc, но не в сигнатуре метода.<p>Я не понимаю логику здесь, и уверен, что разработчики Java тоже ее не понимают. Как и почему некоторые исключения важны, а другие нет? Почему некоторые из них заслуживают подходящего места в API в блоке <code class="language-plaintext highlighter-rouge">throws</code> сигнатуры метода, а другие нет? Какие критерии?<p>У меня есть ответ на это. Введя проверяемые и непроверяемые исключения, разработчики Java пытались решить проблему методов, которые слишком сложны и запутаны. Когда метод слишком большой и делает слишком много вещей одновременно (нарушает принцип единственной ответственности), определенно лучше позволить нам “скрыть” некоторые исключения (т.е. непроверяемые). Но это не настоящее решение. Это всего лишь временный патч, который наносит нам больше вреда, чем пользы: методы продолжают расти по размеру и сложности.<p>Непроверяемые исключения - это ошибка в проектировании Java, а не проверяемые.<p>Скрытие того факта, что метод может завершиться с ошибкой в какой-то момент, - это ошибка. Именно это делают непроверяемые исключения.<p>Вместо этого, мы должны сделать этот факт видимым. Когда метод делает слишком много вещей, возникает слишком много точек отказа, и автор метода поймет, что что-то не так - метод не должен выбрасывать исключения в таких ситуациях. Это приведет к рефакторингу. Наличие непроверяемых исключений ведет к беспорядку. Кстати, проверяемые исключения совсем не существуют в Ruby, C#, Python, PHP и т.д. Это означает, что создатели этих языков понимают ООП еще меньше, чем авторы Java.<p>Еще одним распространенным аргументом против проверяемых исключений является то, что они делают наш код более громоздким. Нам приходится использовать <code class="language-plaintext highlighter-rouge">try/catch</code> везде, вместо того, чтобы оставаться сосредоточенными на основной логике. Божидар Божанов даже <a href="http://techblog.bozho.net/checked-and-unchecked-exceptions-in-java/">предлагает</a> техническое решение для этой проблемы громоздкости.<p>Снова не понимаю эту логику. Если я хочу сделать что-то, когда метод <code class="language-plaintext highlighter-rouge">save()</code> завершается неудачей, я ловлю исключение и обрабатываю ситуацию как-то. Если я не хочу этого делать, я просто указываю, что мой метод также <code class="language-plaintext highlighter-rouge">throws</code> и не обращаю внимания на обработку исключений. В чем проблема? Откуда берется громоздкость?<p>У меня тоже есть ответ. Она возникает из-за существования непроверяемых исключений. Мы просто не всегда можем игнорировать ошибки, потому что используемые нами интерфейсы не позволяют нам это делать. Вот и все. Например, класс <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Runnable.html"><code class="language-plaintext highlighter-rouge">Runnable</code></a>, который широко используется для многопоточного программирования, имеет метод <code class="language-plaintext highlighter-rouge">run()</code>, который не должен выбрасывать ничего. Поэтому мы всегда должны перехватывать все исключения внутри метода и выбрасывать проверяемые исключения как непроверяемые.<p>Если бы все методы во всех интерфейсах Java были объявлены либо “безопасными” (<code class="language-plaintext highlighter-rouge">throws</code> ничего), либо “небезопасными” (<code class="language-plaintext highlighter-rouge">throws Exception</code>), все стало бы логичным и понятным. Если вы хотите оставаться “безопасными”, возьмите на себя ответственность за обработку ошибок. В противном случае, будьте “небезопасными” и позвольте вашим пользователям заботиться о безопасности.<p>Никакого шума, очень чистый код и очевидная логика.<p><a href="https://www.ibm.com/developerworks/library/j-jtp05254/">Некоторые говорят</a>, что возможность помещать проверяемое исключение в <code class="language-plaintext highlighter-rouge">throws</code> в сигнатуре метода, вместо того чтобы перехватывать его здесь и снова выбрасывать новый тип, побуждает нас иметь слишком много несущественных типов исключений в сигнатурах методов. Например, наш метод <code class="language-plaintext highlighter-rouge">save()</code> может объявить, что может выбросить <code class="language-plaintext highlighter-rouge">OutOfMemoryException</code>, хотя кажется, что это никак не связано с выделением памяти. Но ведь он выделяет некоторую память, верно? Таким образом, переполнение памяти может произойти во время операции сохранения файла.<p>Опять же, я не понимаю логики этого аргумента. Если все исключения проверяемые и у нас нет нескольких типов исключений, мы просто выбрасываем <code class="language-plaintext highlighter-rouge">Exception</code> везде, и все. Зачем нам в первую очередь беспокоиться о типе исключения? Если мы не используем исключения для управления потоком выполнения, мы не будем этого делать.<p>Если мы действительно хотим сделать наше приложение устойчивым к переполнению памяти, мы введем некоторый менеджер памяти, который будет иметь что-то вроде метода <code class="language-plaintext highlighter-rouge">bigEnough()</code>, который скажет нам, достаточно ли нашей кучи для следующей операции. Использование исключений в таких ситуациях является абсолютно неуместным подходом к управлению исключениями в ООП.<p>Джошуа Блох в <a href="https://amzn.to/2crH5tW"><em>Effective Java</em></a> говорит, что “используйте проверяемые исключения для восстанавливаемых ситуаций и исключения времени выполнения для ошибок программирования”. Он имеет в виду нечто вроде этого:<p>В чем здесь отличие от известного анти-паттерна под названием <a href="http://c2.com/cgi/wiki?DontUseExceptionsForFlowControl">Don’t Use Exceptions for Flow Control</a>? Джошуа, с уважением к вам, вы ошибаетесь. В объектно-ориентированном программировании не существует такого понятия, как восстанавливаемое состояние. Исключение указывает на то, что выполнение цепочки вызовов методов прервано и пришло время подняться по цепочке и остановиться где-то. Но после исключения мы никогда не возвращаемся обратно.<p>Мы можем снова начать эту цепочку, но мы не возвращаемся после <code class="language-plaintext highlighter-rouge">throw</code>. Другими словами, мы ничего не <strong>делаем</strong> в блоке <code class="language-plaintext highlighter-rouge">catch</code>. Мы только сообщаем о проблеме и завершаем выполнение. Мы никогда не “восстанавливаемся!”<p>Все аргументы против использования проверяемых исключений ничего не демонстрируют, кроме серьезного непонимания объектно-ориентированного программирования со стороны их авторов. Ошибка в Java и во многих других языках заключается в наличии непроверяемых исключений, а не проверяемых.<p class="jekyll-chatgpt-translate">Translated by ChatGPT gpt-3.5-turbo/42 on 2023-12-27 at 10:22</article></div><div class="wrapper"><footer class="footer"><p>&copy; <span itemscope=""itemprop="copyrightHolder"itemtype="http://schema.org/Person"><span itemprop="name">Yegor Bugayenko</span> </span>2014&ndash;<span itemprop="copyrightYear">2023</span></footer></div></section><div class="wrapper unprintable"style="text-align:center;margin-top:2em"><a href="https://www.sixnines.io/h/3ba1652f"><img src="//www.sixnines.io/b/3ba1652f?style=flat"alt="sixnines availability badge"></a>&nbsp; <a href="https://github.com/yegor256/blog/stargazers"><img src="//img.shields.io/github/stars/yegor256/blog.svg?style=flat-square"alt="GitHub stars"></a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script><script src="/js/all.js?1fa46d1a364"></script><script>var disqus_shortname="yegor256"</script><script id="dsq-count-scr"src="//yegor256.disqus.com/count.js"async="async"></script><script>((e,a,t,g,n)=>{e.GoogleAnalyticsObject="ga",e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,g=a.createElement(t),n=a.getElementsByTagName(t)[0],g.async=1,g.src="//www.google-analytics.com/analytics.js",n.parentNode.insertBefore(g,n)})(window,document,"script"),ga("create","UA-1963507-32","auto"),ga("send","pageview")</script><script>Cd=document,Cr="&"+Math.random(),Cp="&s=1",Cd.cookie="b=b",Cd.cookie&&(Cp+="&c=1"),Cp+="&t="+(new Date).getTimezoneOffset(),self!=top&&(Cp+="&f=1")</script><script>navigator.javaEnabled()&&(Cp+="&j=1")</script><script>"undefined"!=typeof screen&&(Cp+="&w="+screen.width+"&h="+screen.height+"&d="+(screen.colorDepth||screen.pixelDepth))</script><script>Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+"&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+"' border='0' width='1' height='1'/>")</script><script type="application/ld+json">{ "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] }</script>