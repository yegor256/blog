<!doctypehtml><html xmlns="https://www.w3.org/1999/xhtml"lang="en-US"xml:lang="en-US"itemscope=""itemtype="http://schema.org/WebSite"><meta charset="utf-8"><meta name="description"content="Logging inside unit tests is a common practice, but a dangerous one, since it takes important knowledge away from the repository."><meta name="keywords"content=""><meta name="viewport"content="width=device-width,minimum-scale=1,initial-scale=1"><meta name="google-site-verification"content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8"><meta name="author"content="Yegor Bugayenko"><meta name="og:site_name"content="Yegor Bugayenko"><meta name="og:type"content="article"><meta name="og:locale"content="en_US"><meta name="twitter:account_id"content="4503599630178231"><meta name="twitter:creator"content="@yegor256"><meta name="twitter:site"content="@yegor256"><meta name="twitter:title"property="og:title"content="Logging in Unit Tests, a Bad Practice"><meta name="twitter:description"property="og:description"content="Logging inside unit tests is a common practice, but a dangerous one, since it takes important knowledge away from the repository."><meta name="twitter:url"property="og:url"content="https://www.yegor256.com/ru/2021/08/11/logging-in-unit-tests.html"><meta name="telegram:channel"content="AAAAAEJFMRzsRTRxM3ec6A"><link rel="search"type="application/opensearchdescription+xml"href="/opensearch.xml"title="yegor256"><link rel="shortcut icon"href="/favicon.ico?a92399eaa71"><link rel="apple-touch-icon"href="/favicon.ico?a92399eaa71"><link rel="alternate"type="application/rss+xml"title="RSS for yegor256.com"href="https://www.yegor256.com/rss.xml"><link rel="stylesheet"href="/css/layout.css?a92399eaa71"><link rel="stylesheet"href="/css/icons.css?a92399eaa71"><link rel="canonical"href="https://www.yegor256.com/ru/2021/08/11/logging-in-unit-tests.html"><title>Logging in Unit Tests, a Bad Practice</title><div class="wrapper"><aside class="header-toggle unprintable"id="header-toggle"title="Show the menu"onclick='$("#header").show(),$("#header-toggle").hide()'>&#9776;</aside><header class="header"id="header"><div class="face"><a href="/about-me.html#form"class="sub"title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html"style="position:relative"><img src="/images/face-256x256.jpg"class="photo"alt="Yegor Bugayenko"></a></div><nav><ul class="menu social notranslate"><li><a href="https://twitter.com/intent/follow?screen_name=yegor256"rel="nofollow"title="Follow me on Twitter"><i class="icon icon-twitter notranslate"aria-hidden="true"></i></a><li><a href="/rss.xml"rel="nofollow"title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://github.com/yegor256"rel="nofollow"title="My GitHub profile"><i class="icon icon-github notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="http://stackoverflow.com/users/187141/yegor256"rel="nofollow"title="My Stack Overflow profile"><i class="icon icon-stackoverflow notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://www.facebook.com/yegor256"rel="nofollow"title="Follow me on Facebook"><i class="icon icon-facebook notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://instagram.com/yegor256"rel="nofollow"title="Follow me on Instagram"><i class="icon icon-instagram notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://www.linkedin.com/in/yegor256"rel="nofollow"title="My LinkedIn profile"><i class="icon icon-linkedin notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://www.youtube.com/c/yegor256?sub_confirmation=1"rel="nofollow"title="My Youtube video channel"><i class="icon icon-youtube notranslate"aria-hidden="true"></i></a><li><a href="https://soundcloud.com/yegor256"rel="nofollow"title="My podcast"><i class="icon icon-podcast notranslate"aria-hidden="true"></i></a><li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721"rel="nofollow"title="My iTunes podcast"><i class="icon icon-itunes notranslate"aria-hidden="true"></i></a><li><a href="https://t.me/yegor256news"rel="nofollow"title="My Telegram public channel"><i class="icon icon-telegram notranslate"aria-hidden="true"></i></a><li><a href="mailto:blog@yegor256.com"rel="nofollow"title="Email me any time"><i class="icon icon-mail notranslate"aria-hidden="true"></i></a></ul><ul class="menu"><li><a href="/"title="Home page">Home</a><li><a href="/best.html"title="Best articles to read">12&#160;Best</a><li><a href="/contents.html"title="The contents of the entire blog">All&#160;393</a><li><a href="/teaching.html"title="My courses and lectures">Teaching</a><li><a href="/talks.html"title="Future and past conference talks">Talks</a><li><a href="/books.html"title="The books I wrote">Books</a><li><a href="/research.html"title="My research directions and progress">Research</a><li><a href="/pets.html"title="My loved pet projects">Pets</a><li><a href="/testimonials.html"title="What some people say about me">Testimonials</a><li><a href="/shift-m.html"title="Audio podcast about project management">Shift-M</a><li><a href="/paintings.html"title="My paintings for sale">Art</a><li><a href="https://ru.yegor256.com/"title="Немного на русском языке о политике в России, Украине и мире">Политика</a></ul></nav><div class="search"><form action="https://www.google.com/search"itemprop="potentialAction"itemscope=""itemtype="http://schema.org/SearchAction"><meta itemprop="target"content="https://www.google.com/search?q={q}"><input name="sitesearch"value="yegor256.com"type="hidden"> <input itemprop="query-input"id="search-query"class="field field-text"required="required"onfocus='$(".google").css("visibility","visible")'name="q"placeholder="Search..."autocomplete="off"> <input type="image"src="/images/google-search-icon.svg"class="google"title="Search via Google"alt="Search via Google"></form></div><div class="hot"><ul></ul></div></header></div><section itemscope=""itemtype="http://schema.org/BlogPosting"><div class="wrapper"><header><h1 itemprop="name headline mainEntityOfPage">Logging in Unit Tests, a Bad Practice</h1></header><article class="main"itemprop="articleBody"style="font-family:sans-serif;font-size:.9em;line-height:1.2em"><p style="color:#c42c00">The following text is a <em>partial</em> translation of the <a href="https://www.yegor256.com/2021/08/11/logging-in-unit-tests.html">original English article</a>, performed by <a href="https://chat.openai.com/">ChatGPT</a> (gpt-3.5-turbo) and <a href="https://github.com/yegor256/jekyll-chatgpt-translate">this Jekyll plugin</a>:<p>Логирование является неотъемлемой частью отладки. Ну, по крайней мере, в современных высокоуровневых языках программирования и архитектурах. Тридцать лет назад, в языке ассемблера, это не было так, но сейчас это так. Иногда мы отслеживаем переменные, но редко. Чаще всего мы просто выводим их на консоль. Более того, мы не просто выводим их с помощью <code class="language-plaintext highlighter-rouge">println</code> или чего-то подобного для вывода на консоль; вместо этого мы отправляем сообщения в <a href="https://ru.wikipedia.org/wiki/Java_logging_framework">фреймворк логирования</a>, который работает с консолью или любыми другими целями логирования, такими как файлы. Преимущество таких фреймворков заключается в том, что нам не нужно удалять логирование после завершения отладки — мы просто настраиваем фреймворк на подавление всех сообщений уровня отладки в рабочей среде. Некоторое логирование может происходить внутри модульных тестов. Может быть, мы также оставляем его там или, может быть, нет?<p>Вот пример (это упрощение реального модульного теста в файле <a href="https://github.com/polystat/polystat/blob/0.0.1/src/test/java/org/polystat/far/CalcTest.java">CalcTest.java</a> из <a href="https://www.polystat.org">Polystat</a>, статического анализатора, над которым мы сейчас работаем):<p>Это Java, и я использую <a href="https://junit.org/junit5/">JUnit5</a>+<a href="http://hamcrest.org/">Hamcrest</a> вместе с моей собственной системой логирования <a href="https://log.jcabi.com">jcabi-log</a>, которая является декоратором <a href="https://www.slf4j.org/">Slf4j</a>, который использует <a href="https://logging.apache.org/log4j/2.x/">Log4j</a> для вывода на консоль.<p>Что здесь происходит? Есть класс <code class="language-plaintext highlighter-rouge">Foo</code> с методом <code class="language-plaintext highlighter-rouge">build()</code>, который создает XML-документ (я использую библиотеку <a href="https://xml.jcabi.com">jcabi-xml</a>, которая является декоратором <a href="https://docs.oracle.com/javase/8/docs/api/org/w3c/dom/package-summary.html">JDK DOM</a>). Затем, в модульном тесте содержимое XML-документа выводится на консоль, и делается довольно глупое утверждение: документ не является NULL. Это глупо, потому что если бы он был NULL, уже при вызове <code class="language-plaintext highlighter-rouge">.toString()</code> отказывалась бы логирующая инструкция.<p>Я являюсь разработчиком этого кода, поэтому знаю, что происходило: мне было лень написать правильное утверждение, которое бы проверяло наличие правильных элементов внутри XML-документа. Я просто вывел его на консоль, <em>визуально</em> убедился в его корректности и считал это достаточным. Если бы у меня было больше времени, я бы написал гораздо лучший модульный тест (я только что внес <a href="https://github.com/polystat/polystat/issues/10">улучшения</a> в тесты Polystat).<p>Теперь XML-документ создан и затем проверяется на наличие <code class="language-plaintext highlighter-rouge">//foo</code> <a href="https://en.wikipedia.org/wiki/XPath">XPath</a> внутри него. Содержимое документа будет выведено на консоль только в случае, если утверждение не выполняется. Если XML содержит требуемый XPath, консольный вывод отсутствует, что означает отсутствие шума для будущих разработчиков.<p>Более того, это теперь <em>тест с одним оператором</em>, что само по себе является хорошей практикой.<p>Основываясь на своем опыте тестирования и ведения журнала, я считаю, что журналирование в модульных тестах — это плохая идея. Иногда неизбежная, потому что мы ленивы или просто не имеем достаточно времени, но все же это плохо. Журналирование помогает нам визуально подтвердить правильность вывода, но оно отнимает эту информацию у проекта. Те, кто будет работать с тестом позже, не будут знать, что мы видели там. Они увидят вывод на консоли, но не поймут, соответствует ли он по-прежнему моим ожиданиям на момент написания.<p>Я бы сказал, что каждая строка журналирования в модульном тесте — это сообщение от его автора: “Я что-то знаю о данных, которые я вижу сейчас, но мне лень рассказывать вам об этом, вы должны просто поверить, что это выглядит хорошо”.<p>Предлагаю не оставлять подобные сообщения в нашем коде.<p class="jekyll-chatgpt-translate">Translated by ChatGPT gpt-3.5-turbo/42 on 2023-12-15 at 06:47</article></div><div class="wrapper"><footer class="footer"><p>&copy; <span itemscope=""itemprop="copyrightHolder"itemtype="http://schema.org/Person"><span itemprop="name">Yegor Bugayenko</span> </span>2014&ndash;<span itemprop="copyrightYear">2023</span></footer></div></section><div class="wrapper unprintable"style="text-align:center;margin-top:2em"><a href="https://www.sixnines.io/h/3ba1652f"><img src="//www.sixnines.io/b/3ba1652f?style=flat"alt="sixnines availability badge"></a>&nbsp; <a href="https://github.com/yegor256/blog/stargazers"><img src="//img.shields.io/github/stars/yegor256/blog.svg?style=flat-square"alt="GitHub stars"></a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script><script src="/js/all.js?a92399eaa71"></script><script>var disqus_shortname="yegor256"</script><script id="dsq-count-scr"src="//yegor256.disqus.com/count.js"async="async"></script><script>((e,a,t,g,n)=>{e.GoogleAnalyticsObject="ga",e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,g=a.createElement(t),n=a.getElementsByTagName(t)[0],g.async=1,g.src="//www.google-analytics.com/analytics.js",n.parentNode.insertBefore(g,n)})(window,document,"script"),ga("create","UA-1963507-32","auto"),ga("send","pageview")</script><script>Cd=document,Cr="&"+Math.random(),Cp="&s=1",Cd.cookie="b=b",Cd.cookie&&(Cp+="&c=1"),Cp+="&t="+(new Date).getTimezoneOffset(),self!=top&&(Cp+="&f=1")</script><script>navigator.javaEnabled()&&(Cp+="&j=1")</script><script>"undefined"!=typeof screen&&(Cp+="&w="+screen.width+"&h="+screen.height+"&d="+(screen.colorDepth||screen.pixelDepth))</script><script>Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+"&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+"' border='0' width='1' height='1'/>")</script><script type="application/ld+json">{ "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] }</script>