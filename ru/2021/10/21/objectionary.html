<!doctypehtml><html xmlns="https://www.w3.org/1999/xhtml"lang="en-US"xml:lang="en-US"itemscope=""itemtype="http://schema.org/WebSite"><meta charset="utf-8"><meta name="description"content="It is a platform-independent object repository, which hosts source code and validates its consistency on each modification."><meta name="keywords"content=""><meta name="viewport"content="width=device-width,minimum-scale=1,initial-scale=1"><meta name="google-site-verification"content="JEj_gQr2CPe2QKGw8XdMz0R7VboQIUbX3FlM-lwTq-8"><meta name="author"content="Yegor Bugayenko"><meta name="og:site_name"content="Yegor Bugayenko"><meta name="og:type"content="article"><meta name="og:locale"content="en_US"><meta name="twitter:account_id"content="4503599630178231"><meta name="twitter:creator"content="@yegor256"><meta name="twitter:site"content="@yegor256"><meta name="twitter:title"property="og:title"content="Objectionary: Dictionary and Factory for EO Objects"><meta name="twitter:description"property="og:description"content="It is a platform-independent object repository, which hosts source code and validates its consistency on each modification."><meta name="twitter:url"property="og:url"content="https://www.yegor256.com/ru/2021/10/21/objectionary.html"><meta name="telegram:channel"content="AAAAAEJFMRzsRTRxM3ec6A"><link rel="search"type="application/opensearchdescription+xml"href="/opensearch.xml"title="yegor256"><link rel="shortcut icon"href="/favicon.ico?ffdde63ad39"><link rel="apple-touch-icon"href="/favicon.ico?ffdde63ad39"><link rel="alternate"type="application/rss+xml"title="RSS for yegor256.com"href="https://www.yegor256.com/rss.xml"><link rel="stylesheet"href="/css/layout.css?ffdde63ad39"><link rel="stylesheet"href="/css/icons.css?ffdde63ad39"><link rel="canonical"href="https://www.yegor256.com/ru/2021/10/21/objectionary.html"><title>Objectionary: Dictionary and Factory for EO Objects</title><div class="wrapper"><aside class="header-toggle unprintable"id="header-toggle"title="Show the menu"onclick='$("#header").show(),$("#header-toggle").hide()'>&#9776;</aside><header class="header"id="header"><div class="face"><a href="/about-me.html#form"class="sub"title="Click to subscribe to my monthly newsletter"><span>Subscribe</span></a> <a href="/about-me.html"style="position:relative"><img src="/images/face-256x256.jpg"class="photo"alt="Yegor Bugayenko"></a></div><nav><ul class="menu social notranslate"><li><a href="https://twitter.com/intent/follow?screen_name=yegor256"rel="nofollow"title="Follow me on Twitter"><i class="icon icon-twitter notranslate"aria-hidden="true"></i></a><li><a href="/rss.xml"rel="nofollow"title="Subscribe to my RSS feed"><i class="icon icon-rss notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://github.com/yegor256"rel="nofollow"title="My GitHub profile"><i class="icon icon-github notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="http://stackoverflow.com/users/187141/yegor256"rel="nofollow"title="My Stack Overflow profile"><i class="icon icon-stackoverflow notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://www.facebook.com/yegor256"rel="nofollow"title="Follow me on Facebook"><i class="icon icon-facebook notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://instagram.com/yegor256"rel="nofollow"title="Follow me on Instagram"><i class="icon icon-instagram notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://www.linkedin.com/in/yegor256"rel="nofollow"title="My LinkedIn profile"><i class="icon icon-linkedin notranslate"aria-hidden="true"></i></a><li><a itemprop="sameAs"href="https://www.youtube.com/c/yegor256?sub_confirmation=1"rel="nofollow"title="My Youtube video channel"><i class="icon icon-youtube notranslate"aria-hidden="true"></i></a><li><a href="https://soundcloud.com/yegor256"rel="nofollow"title="My podcast"><i class="icon icon-podcast notranslate"aria-hidden="true"></i></a><li><a href="https://itunes.apple.com/us/podcast/yegor256-podcast/id1150826721"rel="nofollow"title="My iTunes podcast"><i class="icon icon-itunes notranslate"aria-hidden="true"></i></a><li><a href="https://t.me/yegor256news"rel="nofollow"title="My Telegram public channel"><i class="icon icon-telegram notranslate"aria-hidden="true"></i></a><li><a href="mailto:blog@yegor256.com"rel="nofollow"title="Email me any time"><i class="icon icon-mail notranslate"aria-hidden="true"></i></a></ul><ul class="menu"><li><a href="/"title="Home page">Home</a><li><a href="/best.html"title="Best articles to read">12&#160;Best</a><li><a href="/contents.html"title="The contents of the entire blog">All&#160;393</a><li><a href="/teaching.html"title="My courses and lectures">Teaching</a><li><a href="/talks.html"title="Future and past conference talks">Talks</a><li><a href="/books.html"title="The books I wrote">Books</a><li><a href="/research.html"title="My research directions and progress">Research</a><li><a href="/pets.html"title="My loved pet projects">Pets</a><li><a href="/testimonials.html"title="What some people say about me">Testimonials</a><li><a href="/shift-m.html"title="Audio podcast about project management">Shift-M</a><li><a href="/paintings.html"title="My paintings for sale">Art</a><li><a href="https://ru.yegor256.com/"title="Немного на русском языке о политике в России, Украине и мире">Политика</a></ul></nav><div class="search"><form action="https://www.google.com/search"itemprop="potentialAction"itemscope=""itemtype="http://schema.org/SearchAction"><meta itemprop="target"content="https://www.google.com/search?q={q}"><input name="sitesearch"value="yegor256.com"type="hidden"> <input itemprop="query-input"id="search-query"class="field field-text"required="required"onfocus='$(".google").css("visibility","visible")'name="q"placeholder="Search..."autocomplete="off"> <input type="image"src="/images/google-search-icon.svg"class="google"title="Search via Google"alt="Search via Google"></form></div><div class="hot"><ul></ul></div></header></div><section itemscope=""itemtype="http://schema.org/BlogPosting"><div class="wrapper"><header><h1 itemprop="name headline mainEntityOfPage">Objectionary: Dictionary and Factory for EO Objects</h1></header><article class="main"itemprop="articleBody"style="font-family:sans-serif;font-size:.9em;line-height:1.2em"><p style="color:#c42c00">The following text is a <em>partial</em> translation of the <a href="https://www.yegor256.com/2021/10/21/objectionary.html">original English article</a>, performed by <a href="https://chat.openai.com/">ChatGPT</a> (gpt-3.5-turbo) and <a href="https://github.com/yegor256/jekyll-chatgpt-translate">this Jekyll plugin</a>:<p>Со времен Кернигана и Ритчи мы делимся двоичным кодом в библиотеках. Вам нужно вывести некоторый текст с помощью <a href="https://en.wikipedia.org/wiki/Printf_format_string"><code class="language-plaintext highlighter-rouge">printf()</code></a> в C++? Вы получаете библиотеку <a href="https://en.wikipedia.org/wiki/Glibc">libc</a> с более чем <a href="https://stackoverflow.com/a/33188344/187141">700</a> другими функциями внутри. Вам нужно скопировать поток в Java? Вы получаете <a href="https://commons.apache.org/proper/commons-io/">Apache Commons IO</a> с методом <a href="https://commons.apache.org/proper/commons-io/apidocs/org/apache/commons/io/IOUtils.html#copy-java.io.InputStream-java.io.OutputStream-"><code class="language-plaintext highlighter-rouge">copy()</code></a> и еще более чем <a href="https://commons.apache.org/proper/commons-io/apidocs/index.html">140</a> другими методами и классами. То же самое происходит во всех языках, о которых я знаю, таких как Ruby, Python, JavaScript, PHP: вам нужен объект, или класс, или функция, или метод - вам придется добавить всю библиотеку в свою сборку. Разве не было бы более элегантным иметь дело с отдельными объектами?<p>Идея не нова и не моя. Я позаимствовал ее из книги <a href="https://amzn.to/266oJr4">Object Thinking</a> Дэвида Уэста, где он предложил создать <em>Объектарий</em> (страница 306), “сочетание словаря и фабрики объектов”, с следующими свойствами:<ul><li><p>Каждый объект является автономной исполняемой сущностью;<li><p>Каждый объект имеет уникальный идентификатор и уникальный “адрес”.<li><p>Объекты - это просто совокупности объектов;<li><p>Объекты требуют аппаратно-специфических виртуальных машин для выполнения.</ul><p>Семнадцать лет спустя (книга была опубликована в 2004 году), мы реализовали идею поверх <a href="https://www.eolang.org">EO</a>, нашего нового языка программирования. Язык намеренно гораздо проще, чем Java или C++. Вы можете прочитать его более или менее формальное описание <a href="https://arxiv.org/abs/2111.13384">здесь</a>.<p>Чтобы превратить программу на EO в исполняемый объект и разместить его в <a href="https://www.objectionary.com">Objectionary</a>, необходимо пройти через следующие обязательные этапы, предполагая использование JVM в качестве целевой платформы (этапы, отмеченные символом 🌵, реализованы нашим <a href="https://github.com/cqfn/eo">eo-maven-plugin</a>):<ul><li><strong>Parse</strong>🌵: <code class="language-plaintext highlighter-rouge">.eo</code> ➜ <code class="language-plaintext highlighter-rouge">.xmir</code></ul><p><strong>Разбор</strong>🌵: <code class="language-plaintext highlighter-rouge">.eo</code> ➜ <code class="language-plaintext highlighter-rouge">.xmir</code><ul><li><p><strong>Оптимизировать</strong>🌵: <code class="language-plaintext highlighter-rouge">.xmir</code> ➜ лучше <code class="language-plaintext highlighter-rouge">.xmir</code><li><p><strong>Discover</strong>🌵: найти все иностранные псевдонимы<li><p><strong>Pull</strong>🌵: <a href="https://github.com/yegor256/objectionary">download</a> foreign <code class="language-plaintext highlighter-rouge">.eo</code> objects</ul><p><strong>Тянуть</strong>🌵: <a href="https://github.com/yegor256/objectionary">скачать</a> иностранные объекты <code class="language-plaintext highlighter-rouge">.eo</code><ul><li><p><strong>Разрешить</strong>🌵: <a href="https://search.maven.org/">скачать</a> и распаковать артефакты <code class="language-plaintext highlighter-rouge">.jar</code><li><p><strong>Место</strong>🌵: переместить файлы артефакта <code class="language-plaintext highlighter-rouge">.class</code> в <code class="language-plaintext highlighter-rouge">target/classes/</code>.<li><p><strong>Mark</strong>🌵: пометить исходные файлы <code class="language-plaintext highlighter-rouge">.eo</code>, найденные в <code class="language-plaintext highlighter-rouge">.jar</code>, как иностранные<li><p>↑ Вернитесь в <strong>Parse</strong>, если некоторые файлы <code class="language-plaintext highlighter-rouge">.eo</code> все еще не распознаны<li><p><strong>Транспиляция</strong>🌵: <code class="language-plaintext highlighter-rouge">.xmir</code> ➜ <code class="language-plaintext highlighter-rouge">.java</code><li><p>“<strong>Assemble</strong>🌵: то же самое, что и выше, но для тестов”<li><p><strong>Компиляция</strong>: <code class="language-plaintext highlighter-rouge">.java</code> ➜ <code class="language-plaintext highlighter-rouge">.class</code><li><p><strong>Тест</strong>: запустить все модульные тесты<li><p><strong>Unplace</strong>🌵: удаление файлов артефакта <code class="language-plaintext highlighter-rouge">.class</code><li><p><strong>Unspile</strong>🌵: удалить автоматически созданные файлы <code class="language-plaintext highlighter-rouge">.java</code><li><p><strong>Копирование</strong>: скопируйте файлы <code class="language-plaintext highlighter-rouge">.eo</code> внутрь <code class="language-plaintext highlighter-rouge">.jar</code> в папку <code class="language-plaintext highlighter-rouge">EO-SOURCES/</code>.<li><p><strong>Развернуть</strong>: упакуйте артефакт <code class="language-plaintext highlighter-rouge">.jar</code> и поместите его в центр Maven.<li><p><strong>Push</strong>: отправьте запрос на влитие (pull request) в <a href="https://github.com/yegor256/objectionary">yegor256/objectionary</a><li><p><strong>Слияние</strong>: мы тестируем и объединяем pull request</ul><p>Это итерационный процесс, который повторяется снова и снова, пока все необходимые объекты <code class="language-plaintext highlighter-rouge">.eo</code> парсятся, и их атомы присутствуют в виде файлов <code class="language-plaintext highlighter-rouge">.class</code>. Затем все файлы <code class="language-plaintext highlighter-rouge">.xmir</code> транспилируются в <code class="language-plaintext highlighter-rouge">.java</code>, а затем компилируются в двоичные файлы <code class="language-plaintext highlighter-rouge">.class</code>. Затем они тестируются, упаковываются и развертываются в Maven Central. Затем они объединяются с основной веткой <code class="language-plaintext highlighter-rouge">master</code> в <a href="https://www.objectionary.com">Objectionary</a> с помощью запроса на объединение.<p>Первая часть алгоритма может быть автоматизирована с помощью <a href="https://github.com/cqfn/eo">нашего плагина для Maven</a>, просто поместив исходные файлы <code class="language-plaintext highlighter-rouge">.eo</code> в <code class="language-plaintext highlighter-rouge">src/main/eo/</code> и добавив это в <code class="language-plaintext highlighter-rouge">pom.xml</code>:<p>Цель <code class="language-plaintext highlighter-rouge">register</code> будет сканировать каталог <code class="language-plaintext highlighter-rouge">src/main/eo/</code>, находить все исходные файлы с расширением <code class="language-plaintext highlighter-rouge">.eo</code>, и “регистрировать” их в специальном CSV-каталоге <code class="language-plaintext highlighter-rouge">target/eo-foreigns.csv</code>. Затем цель <code class="language-plaintext highlighter-rouge">assemble</code> будет вызывать следующие цели: <code class="language-plaintext highlighter-rouge">parse</code>, <code class="language-plaintext highlighter-rouge">optimize</code>, <code class="language-plaintext highlighter-rouge">discover</code>, <code class="language-plaintext highlighter-rouge">pull</code> и <code class="language-plaintext highlighter-rouge">resolve</code>. Все эти цели используют CSV-каталог при выполнении парсинга, оптимизации, извлечения и т. д.<p>Когда все они завершены, <code class="language-plaintext highlighter-rouge">assemble</code> проверяет каталог: нужно ли еще производить парсинг файлов с расширением <code class="language-plaintext highlighter-rouge">.eo</code>? Если да, то начинается еще один цикл с парсинга. Когда все файлы <code class="language-plaintext highlighter-rouge">.eo</code> распарсены, выполняется цель <code class="language-plaintext highlighter-rouge">transpile</code>, которая преобразует файлы <code class="language-plaintext highlighter-rouge">.xmir</code> в файлы <code class="language-plaintext highlighter-rouge">.java</code> и помещает их в <code class="language-plaintext highlighter-rouge">target/generated-sources</code>. Остальное делает стандартный плагин <a href="https://maven.apache.org/plugins/maven-compiler-plugin/"><code class="language-plaintext highlighter-rouge">maven-compiler-plugin</code></a>.<p>Давайте обсудим каждый шаг подробнее.<p>Скажем, это исходный код на <code class="language-plaintext highlighter-rouge">.eo</code> в файле <code class="language-plaintext highlighter-rouge">src/main/eo/hello.eo</code>:<p>Он будет разобран в XMIR (XML Intermediate Representation):<p>Если вы хотите узнать, что означает этот XML, прочитайте <a href="https://arxiv.org/abs/2111.13384">этот документ</a>: там есть раздел о XMIR.<p>На этом шаге XMIR, созданный парсером, проходит через множество преобразований XSL, иногда получая дополнительные элементы и атрибуты. Наш пример XMIR может получить новый атрибут <code class="language-plaintext highlighter-rouge">@ref</code>, указывающий ссылку на объект <code class="language-plaintext highlighter-rouge">user</code> на строке, где объект был определен.<p>Некоторые XSL-преобразования могут проверять грамматические или семантические ошибки и добавлять новый элемент <code class="language-plaintext highlighter-rouge">&lt;errors/&gt;</code>, если что-то неправильно обнаружено. Таким образом, если разбор не обнаружил синтаксических ошибок, все остальные ошибки будут видны внутри документа XMIR, например, таким образом:<p>Кстати, это не настоящая ошибка, я просто выдумал ее.<p>На этом шаге мы определяем, какие объекты являются “иностранными”. В нашем примере объект <code class="language-plaintext highlighter-rouge">user</code> не является иностранным, поскольку он определен в коде, который у нас перед глазами, тогда как объект <code class="language-plaintext highlighter-rouge">stdout</code> не определен здесь и поэтому является иностранным.<p>Проходя через все файлы <code class="language-plaintext highlighter-rouge">.xmir</code>, мы легко можем определить, является ли объект иностранным, просто взглянув на их имена. Как только мы видим ссылку на <code class="language-plaintext highlighter-rouge">org.eolang.io.stdout</code>, мы проверяем наличие файла <code class="language-plaintext highlighter-rouge">org/eolang/io/stdout.eo</code> в каталоге со всеми исходными файлами <code class="language-plaintext highlighter-rouge">.eo</code>. Если файл отсутствует, мы добавляем имя объекта в каталог CSV и объявляем его иностранным.<p>Здесь мы просто пытаемся найти исходные коды файлов <code class="language-plaintext highlighter-rouge">.eo</code> для всех внешних объектов в Objectionary, просматривая его <a href="https://github.com/yegor256/objectionary">репозиторий GitHub</a>. Например, здесь мы можем найти <a href="https://github.com/yegor256/objectionary/blob/master/objects/org/eolang/io/stdout.eo"><code class="language-plaintext highlighter-rouge">stdout.eo</code></a>. Мы находим их там и загружаем на локальный диск.<p>Обратите внимание, мы загружаем исходники. Не бинарные или скомпилированные документы XMIR, а исходники в формате <code class="language-plaintext highlighter-rouge">.eo</code>.<p>Вот как может выглядеть <a href="https://github.com/yegor256/objectionary/blob/master/objects/org/eolang/io/stdout.eo"><code class="language-plaintext highlighter-rouge">stdout.eo</code></a> после извлечения.<p>Объект представляет собой <em>атом</em>. Это означает, что хотя у нас есть его исходный код, он не является полным без куска платформо-специфического двоичного кода. Атом представляет собой объект, реализованный платформой выполнения, где выполняется программа EO (также известная как <a href="https://en.wikipedia.org/wiki/Foreign_function_interface">механизм FFI</a>). Строка, начинающаяся с <code class="language-plaintext highlighter-rouge">+rt</code> (время выполнения), объясняет, где получить код времени выполнения. Часть <code class="language-plaintext highlighter-rouge">jvm</code> - это имя времени выполнения.<p>Мы переходим на <a href="https://search.maven.org/">Maven Central</a>, находим там артефакт <a href="https://search.maven.org/artifact/org.eolang/eo-runtime"><code class="language-plaintext highlighter-rouge">org.eolang:eo-runtime:0.10.2</code></a> и распаковываем его (в конце концов, это zip-архив с файлами <code class="language-plaintext highlighter-rouge">.class</code>).<p>Кстати, программа может содержать несколько мета-инструкций <code class="language-plaintext highlighter-rouge">+rt</code>, например:<p>Здесь три платформы времени выполнения будут знать, где получить отсутствующий код для атома <code class="language-plaintext highlighter-rouge">stdout</code>: EO➝Java обратится к <a href="https://search.maven.org/">Maven Central</a> для JAR-артефакта, EO➝Ruby попытается найти гем с именем <code class="language-plaintext highlighter-rouge">eo-core</code> и версией <code class="language-plaintext highlighter-rouge">0.5.8</code> в <a href="https://rubygems.org/">RubyGems</a>, в то время как EO➝Python попытается найти пакет <code class="language-plaintext highlighter-rouge">eo-basics</code> версии <code class="language-plaintext highlighter-rouge">0.0.3</code> в <a href="https://pypi.org/">PyPi</a>.<p>Затем мы помещаем все файлы <code class="language-plaintext highlighter-rouge">.class</code>, найденные в распакованном JAR, в каталог <code class="language-plaintext highlighter-rouge">target/classes</code>. Мы делаем это, чтобы помочь плагину компилятора Maven найти их в пути классов.<p>В каждом поступающем JAR-файле мы можем найти исходные файлы <code class="language-plaintext highlighter-rouge">.eo</code>. Это программы, которые присутствовали в classpath при сборке данного JAR-файла. Мы также рассматриваем их как внешние объекты и добавляем их в CSV-каталог.<p>Когда все иностранные объекты, зарегистрированные в каталоге, скачаны, скомпилированы и оптимизированы, мы готовы начать <a href="https://en.wikipedia.org/wiki/Source-to-source_compiler"><em>транспиляцию</em></a>. Вместо прямой компиляции XMIR в байт-код, мы транспилируем его в <code class="language-plaintext highlighter-rouge">.java</code> и позволяем компилятору Java выполнить задачу по генерации байт-кода.<p>Мы считаем, что есть несколько преимуществ транспиляции в Java по сравнению с компиляцией в байт-код:<ul><li><p>“Используется мощность оптимизации существующих компиляторов.”<li><p>Сложность транспайлера ниже, чем у компилятора.<li><p>Переносимость кода вывода выше.</ul><p>У нас уже есть два транслятора с EO в Java: <a href="https://github.com/cqfn/eo">канонический</a> и <a href="https://github.com/polystat/hse-transpiler">тот</a>, который создал <a href="https://www.hse.ru/en/">Университет НИУ ВШЭ</a>. У нас также есть экспериментальный <a href="https://github.com/polystat/eo2py">транслятор</a> EO в Python, созданный студентами <a href="https://innopolis.university/en/">Университета Иннополис</a>. Вероятно, к моменту вашего прочтения этой статьи появятся еще больше трансляторов.<p>Несмотря на то, что мы верим в трансляцию, всегда есть возможность создать компиляторы EO➝Bytecode, EO➝LLVM или EO➝x86. Вы можете смело попробовать!<p>На этом этапе стандартный <a href="https://maven.apache.org/plugins/maven-compiler-plugin/">Maven Compiler Plugin</a> находит автоматически сгенерированные файлы <code class="language-plaintext highlighter-rouge">.java</code> в <code class="language-plaintext highlighter-rouge">target/generated-sources</code> и преобразует их в файлы <code class="language-plaintext highlighter-rouge">.class</code>.<p>Здесь мы удаляем все файлы <code class="language-plaintext highlighter-rouge">.class</code>, распакованные из зависимостей. Это необходимо, чтобы избежать их упаковки в итоговый JAR-файл.<p>Мы делаем размещение и затем снятие просто потому, что плагин Maven Compiler <a href="https://stackoverflow.com/questions/3410548">не позволяет</a> нам расширять classpath во время выполнения. Если бы это было возможно, мы бы просто загружали зависимости из Maven Central и добавляли их в classpath без распаковки, размещения и последующего снятия.<p>Здесь мы удаляем все файлы <code class="language-plaintext highlighter-rouge">.class</code> из каталога <code class="language-plaintext highlighter-rouge">target/classes/</code>, которые были автоматически созданы из файлов <code class="language-plaintext highlighter-rouge">.eo</code>. Мы не хотим отправлять двоичные файлы, которые могут быть созданы из исходных файлов <code class="language-plaintext highlighter-rouge">.eo</code>. Мы хотим отправлять только атомы, которые являются исходными файлами <code class="language-plaintext highlighter-rouge">.java</code>.<p>На этом шаге мы берем все исходные <code class="language-plaintext highlighter-rouge">.eo</code> файлы из <code class="language-plaintext highlighter-rouge">src/main/eo/</code> и копируем их в каталог <code class="language-plaintext highlighter-rouge">target/classes/EO-SOURCES/</code>. Позже они будут упакованы вместе с файлами <code class="language-plaintext highlighter-rouge">.class</code> в <code class="language-plaintext highlighter-rouge">.jar</code>, который будет размещен в Maven Central. При копировании мы заменяем <code class="language-plaintext highlighter-rouge">0.0.0</code> в версии времени выполнения на текущую развертываемую версию. Взгляните на файл <a href="https://github.com/cqfn/eo/blob/master/eo-runtime/src/main/eo/org/eolang/io/stdout.eo"><code class="language-plaintext highlighter-rouge">stdout.eo</code></a> в его репозитории исходного кода.<p>Версия на линии <code class="language-plaintext highlighter-rouge">+rt</code> - <code class="language-plaintext highlighter-rouge">0.0.0</code>. Когда исходные файлы копируются в JAR, этот текст заменяется.<p>Мотивация для отправки исходных файлов вместе с бинарными файлами следующая. Когда бинарные файлы атомов компилируются из Java в байт-код, они остаются рядом с транслированными исходными файлами. Они компилируются вместе. Более того, модульные тесты также зависят как от исходных файлов атомов, так и от автоматически сгенерированных/транслированных исходных файлов. Мы хотим, чтобы будущие пользователи JAR знали, какие исходные файлы у нас были на месте во время компиляции, чтобы, возможно, позволить им воспроизвести ее или хотя бы знать, каковы были условия окружающей среды для полученных ими бинарных файлов.<p>С практической точки зрения, нам нужны эти исходные файлы в JAR, чтобы позволить шагу <strong>Mark</strong> понять, какие объекты стоит привлечь рядом с разрешенными атомами.<p>Здесь мы упаковываем все из <code class="language-plaintext highlighter-rouge">target/classes/</code> в JAR-архив и размещаем его в Maven Central.<p>Я предлагаю также размещать исходные коды на GitHub Pages, чтобы пользователи могли просматривать их в Интернете. Кроме того, это будет полезно позже, когда мы сделаем pull request в Objectionary. Проверьте этот скрипт <a href="https://github.com/yegor256/eo-files/blob/master/.rultor.yml#L17-L31"><code class="language-plaintext highlighter-rouge">.rultor.yml</code></a> в одной из моих библиотек EO, он размещает исходные коды <code class="language-plaintext highlighter-rouge">.eo</code> на GitHub Pages, заменяя в них версионные маркеры <code class="language-plaintext highlighter-rouge">0.0.0</code> правильно.<p>Когда развертывание завершено и серверы CDN Maven Central обновляются, приходит время отправить pull request в <a href="https://github.com/yegor256/objectionary">yegor256/objectionary</a>. Исходные файлы <code class="language-plaintext highlighter-rouge">.eo</code> объектов помещаются в <code class="language-plaintext highlighter-rouge">objects/</code>, а модульные тесты - в <code class="language-plaintext highlighter-rouge">tests/</code>. В основном, мы просто копируем <code class="language-plaintext highlighter-rouge">src/main/eo/</code> и <code class="language-plaintext highlighter-rouge">src/test/eo</code> туда. Но, стоп… одна важная деталь. В исходных файлах, как уже было сказано ранее, у нас установлены версии <code class="language-plaintext highlighter-rouge">+rt</code> равные <code class="language-plaintext highlighter-rouge">0.0.0</code>. Здесь, когда мы копируем в Objectionary, версии должны быть установлены как реальные числа.<p>Когда поступает запрос на объединение, предварительно настроенное действие GitHub в репозитории <a href="https://github.com/yegor256/objectionary">yegor256/objectionary</a> транспилирует все исходные файлы <code class="language-plaintext highlighter-rouge">.eo</code> на все известные платформы и выполняет все модульные тесты. Если все чисто, мы рассматриваем запрос на объединение и решаем, соответствуют ли предлагаемые объекты другим уже присутствующим в Objectionary.<p>После объединения запроса на объединение объекты становятся частью централизованного словаря всех объектов EO. Взгляните на <a href="https://github.com/yegor256/objectionary/pull/2">этот запрос на объединение</a>, в котором был представлен новый объект в Objectionary после размещения его атома в Maven Central.<p class="jekyll-chatgpt-translate">Translated by ChatGPT gpt-3.5-turbo/42 on 2023-12-16 at 15:29</article></div><div class="wrapper"><footer class="footer"><p>&copy; <span itemscope=""itemprop="copyrightHolder"itemtype="http://schema.org/Person"><span itemprop="name">Yegor Bugayenko</span> </span>2014&ndash;<span itemprop="copyrightYear">2023</span></footer></div></section><div class="wrapper unprintable"style="text-align:center;margin-top:2em"><a href="https://www.sixnines.io/h/3ba1652f"><img src="//www.sixnines.io/b/3ba1652f?style=flat"alt="sixnines availability badge"></a>&nbsp; <a href="https://github.com/yegor256/blog/stargazers"><img src="//img.shields.io/github/stars/yegor256/blog.svg?style=flat-square"alt="GitHub stars"></a></div><script src="//code.jquery.com/jquery-1.9.0.min.js"></script><script src="/js/all.js?ffdde63ad39"></script><script>var disqus_shortname="yegor256"</script><script id="dsq-count-scr"src="//yegor256.disqus.com/count.js"async="async"></script><script>((e,a,t,g,n)=>{e.GoogleAnalyticsObject="ga",e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=+new Date,g=a.createElement(t),n=a.getElementsByTagName(t)[0],g.async=1,g.src="//www.google-analytics.com/analytics.js",n.parentNode.insertBefore(g,n)})(window,document,"script"),ga("create","UA-1963507-32","auto"),ga("send","pageview")</script><script>Cd=document,Cr="&"+Math.random(),Cp="&s=1",Cd.cookie="b=b",Cd.cookie&&(Cp+="&c=1"),Cp+="&t="+(new Date).getTimezoneOffset(),self!=top&&(Cp+="&f=1")</script><script>navigator.javaEnabled()&&(Cp+="&j=1")</script><script>"undefined"!=typeof screen&&(Cp+="&w="+screen.width+"&h="+screen.height+"&d="+(screen.colorDepth||screen.pixelDepth))</script><script>Cd.write("<img src='//c.hit.ua/hit?i=95870&g=0&x=2"+Cp+Cr+"&r="+escape(Cd.referrer)+"&u="+escape(window.location.href)+"' border='0' width='1' height='1'/>")</script><script type="application/ld+json">{ "@context": "http://schema.org", "@type": "Person", "name": "Yegor Bugayenko", "url": "https://www.yegor256.com", "sameAs": [ "https://www.facebook.com/yegor256", "https://instagram.com/yegor256", "https://www.linkedin.com/in/yegor256", "https://twitter.com/yegor256", "https://github.com/yegor256", "https://www.pinterest.com/yegor256/" ] }</script>